import{g as getAugmentedNamespace,a as getDefaultExportFromCjs,c as commonjsRequire}from"./_commonjs-dynamic-modules-3f1b5830.js";function _mergeNamespaces(z,e){for(var A=0;A<e.length;A++){const i=e[A];if(typeof i!="string"&&!Array.isArray(i)){for(const p in i)if(p!=="default"&&!(p in z)){const O=Object.getOwnPropertyDescriptor(i,p);O&&Object.defineProperty(z,p,O.get?O:{enumerable:!0,get:()=>i[p]})}}}return Object.freeze(Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}))}var pdfExports={},pdf$2={get exports(){return pdfExports},set exports(z){pdfExports=z}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,A){module.exports=A()})(globalThis,()=>(()=>{var __webpack_modules__=[,(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.UNSUPPORTED_FEATURES=e.TextRenderingMode=e.RenderingIntentFlag=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationStateModelType=e.AnnotationReviewState=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationMarkedState=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.arrayByteLength=Y,e.arraysToBytes=tt,e.assert=y,e.bytesToString=V,e.createPromiseCapability=Nt,e.createValidAbsoluteUrl=k,e.getModificationDate=Dt,e.getVerbosityLevel=q,e.info=S,e.isArrayBuffer=gt,e.isArrayEqual=pt,e.objectFromMap=at,e.objectSize=nt,e.setVerbosityLevel=N,e.shadow=t,e.string32=st,e.stringToBytes=Z,e.stringToPDFString=vt,e.stringToUTF8String=bt,e.unreachable=n,e.utf8StringToString=Ct,e.warn=l;const A=[1,0,0,1,0,0];e.IDENTITY_MATRIX=A;const i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;const p=1.35;e.LINE_FACTOR=p;const O=.35;e.LINE_DESCENT_FACTOR=O;const w=O/p;e.BASELINE_FACTOR=w;const M={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=M;const C={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=C;const h="pdfjs_internal_editor_";e.AnnotationEditorPrefix=h;const o={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};e.AnnotationEditorType=o;const c={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};e.AnnotationEditorParamsType=c;const d={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=d;const s={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=s;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=u;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=_;const m={MARKED:"Marked",REVIEW:"Review"};e.AnnotationStateModelType=m;const g={MARKED:"Marked",UNMARKED:"Unmarked"};e.AnnotationMarkedState=g;const x={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};e.AnnotationReviewState=x;const F={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=F;const v={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=v;const r={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=r;const f={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=f;const T={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=T;const j={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=j;const L={O:"PageOpen",C:"PageClose"};e.PageActionEventType=L;const B={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=B;const U={NONE:0,BINARY:1};e.CMapCompressionType=U;const J={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=J;const rt={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};e.UNSUPPORTED_FEATURES=rt;const Q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=Q;let $=B.WARNINGS;function N(K){Number.isInteger(K)&&($=K)}function q(){return $}function S(K){$>=B.INFOS&&console.log(`Info: ${K}`)}function l(K){$>=B.WARNINGS&&console.log(`Warning: ${K}`)}function n(K){throw new Error(K)}function y(K,H){K||n(H)}function R(K){if(!K)return!1;switch(K.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function k(K,H=null,W=null){if(!K)return null;try{if(W&&typeof K=="string"){if(W.addDefaultProtocol&&K.startsWith("www.")){const lt=K.match(/\./g);lt&&lt.length>=2&&(K=`http://${K}`)}if(W.tryConvertEncoding)try{K=bt(K)}catch{}}const it=H?new URL(K,H):new URL(K);if(R(it))return it}catch{}return null}function t(K,H,W,it=!1){return Object.defineProperty(K,H,{value:W,enumerable:!it,configurable:!0,writable:!1}),W}const a=function(){function H(W,it){this.constructor===H&&n("Cannot initialize BaseException."),this.message=W,this.name=it}return H.prototype=new Error,H.constructor=H,H}();e.BaseException=a;class b extends a{constructor(H,W){super(H,"PasswordException"),this.code=W}}e.PasswordException=b;class P extends a{constructor(H,W){super(H,"UnknownErrorException"),this.details=W}}e.UnknownErrorException=P;class E extends a{constructor(H){super(H,"InvalidPDFException")}}e.InvalidPDFException=E;class I extends a{constructor(H){super(H,"MissingPDFException")}}e.MissingPDFException=I;class D extends a{constructor(H,W){super(H,"UnexpectedResponseException"),this.status=W}}e.UnexpectedResponseException=D;class X extends a{constructor(H){super(H,"FormatError")}}e.FormatError=X;class G extends a{constructor(H){super(H,"AbortException")}}e.AbortException=G;function V(K){(typeof K!="object"||K===null||K.length===void 0)&&n("Invalid argument for bytesToString");const H=K.length,W=8192;if(H<W)return String.fromCharCode.apply(null,K);const it=[];for(let lt=0;lt<H;lt+=W){const ut=Math.min(lt+W,H),dt=K.subarray(lt,ut);it.push(String.fromCharCode.apply(null,dt))}return it.join("")}function Z(K){typeof K!="string"&&n("Invalid argument for stringToBytes");const H=K.length,W=new Uint8Array(H);for(let it=0;it<H;++it)W[it]=K.charCodeAt(it)&255;return W}function Y(K){if(K.length!==void 0)return K.length;if(K.byteLength!==void 0)return K.byteLength;n("Invalid argument for arrayByteLength")}function tt(K){const H=K.length;if(H===1&&K[0]instanceof Uint8Array)return K[0];let W=0;for(let ut=0;ut<H;ut++)W+=Y(K[ut]);let it=0;const lt=new Uint8Array(W);for(let ut=0;ut<H;ut++){let dt=K[ut];dt instanceof Uint8Array||(typeof dt=="string"?dt=Z(dt):dt=new Uint8Array(dt));const St=dt.byteLength;lt.set(dt,it),it+=St}return lt}function st(K){return String.fromCharCode(K>>24&255,K>>16&255,K>>8&255,K&255)}function nt(K){return Object.keys(K).length}function at(K){const H=Object.create(null);for(const[W,it]of K)H[W]=it;return H}function et(){const K=new Uint8Array(4);return K[0]=1,new Uint32Array(K.buffer,0,1)[0]===1}function ct(){try{return new Function(""),!0}catch{return!1}}class ft{static get isLittleEndian(){return t(this,"isLittleEndian",et())}static get isEvalSupported(){return t(this,"isEvalSupported",ct())}static get isOffscreenCanvasSupported(){return t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?t(this,"platform",{isWin:!1,isMac:!1}):t(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}e.FeatureTest=ft;const ot=[...Array(256).keys()].map(K=>K.toString(16).padStart(2,"0"));class ht{static makeHexColor(H,W,it){return`#${ot[H]}${ot[W]}${ot[it]}`}static scaleMinMax(H,W){let it;H[0]?(H[0]<0&&(it=W[0],W[0]=W[1],W[1]=it),W[0]*=H[0],W[1]*=H[0],H[3]<0&&(it=W[2],W[2]=W[3],W[3]=it),W[2]*=H[3],W[3]*=H[3]):(it=W[0],W[0]=W[2],W[2]=it,it=W[1],W[1]=W[3],W[3]=it,H[1]<0&&(it=W[2],W[2]=W[3],W[3]=it),W[2]*=H[1],W[3]*=H[1],H[2]<0&&(it=W[0],W[0]=W[1],W[1]=it),W[0]*=H[2],W[1]*=H[2]),W[0]+=H[4],W[1]+=H[4],W[2]+=H[5],W[3]+=H[5]}static transform(H,W){return[H[0]*W[0]+H[2]*W[1],H[1]*W[0]+H[3]*W[1],H[0]*W[2]+H[2]*W[3],H[1]*W[2]+H[3]*W[3],H[0]*W[4]+H[2]*W[5]+H[4],H[1]*W[4]+H[3]*W[5]+H[5]]}static applyTransform(H,W){const it=H[0]*W[0]+H[1]*W[2]+W[4],lt=H[0]*W[1]+H[1]*W[3]+W[5];return[it,lt]}static applyInverseTransform(H,W){const it=W[0]*W[3]-W[1]*W[2],lt=(H[0]*W[3]-H[1]*W[2]+W[2]*W[5]-W[4]*W[3])/it,ut=(-H[0]*W[1]+H[1]*W[0]+W[4]*W[1]-W[5]*W[0])/it;return[lt,ut]}static getAxialAlignedBoundingBox(H,W){const it=ht.applyTransform(H,W),lt=ht.applyTransform(H.slice(2,4),W),ut=ht.applyTransform([H[0],H[3]],W),dt=ht.applyTransform([H[2],H[1]],W);return[Math.min(it[0],lt[0],ut[0],dt[0]),Math.min(it[1],lt[1],ut[1],dt[1]),Math.max(it[0],lt[0],ut[0],dt[0]),Math.max(it[1],lt[1],ut[1],dt[1])]}static inverseTransform(H){const W=H[0]*H[3]-H[1]*H[2];return[H[3]/W,-H[1]/W,-H[2]/W,H[0]/W,(H[2]*H[5]-H[4]*H[3])/W,(H[4]*H[1]-H[5]*H[0])/W]}static singularValueDecompose2dScale(H){const W=[H[0],H[2],H[1],H[3]],it=H[0]*W[0]+H[1]*W[2],lt=H[0]*W[1]+H[1]*W[3],ut=H[2]*W[0]+H[3]*W[2],dt=H[2]*W[1]+H[3]*W[3],St=(it+dt)/2,Pt=Math.sqrt((it+dt)**2-4*(it*dt-ut*lt))/2,Tt=St+Pt||1,_t=St-Pt||1;return[Math.sqrt(Tt),Math.sqrt(_t)]}static normalizeRect(H){const W=H.slice(0);return H[0]>H[2]&&(W[0]=H[2],W[2]=H[0]),H[1]>H[3]&&(W[1]=H[3],W[3]=H[1]),W}static intersect(H,W){const it=Math.max(Math.min(H[0],H[2]),Math.min(W[0],W[2])),lt=Math.min(Math.max(H[0],H[2]),Math.max(W[0],W[2]));if(it>lt)return null;const ut=Math.max(Math.min(H[1],H[3]),Math.min(W[1],W[3])),dt=Math.min(Math.max(H[1],H[3]),Math.max(W[1],W[3]));return ut>dt?null:[it,ut,lt,dt]}static bezierBoundingBox(H,W,it,lt,ut,dt,St,Pt){const Tt=[],_t=[[],[]];let xt,Et,Rt,mt,Ft,Mt,Ot,It;for(let Lt=0;Lt<2;++Lt){if(Lt===0?(Et=6*H-12*it+6*ut,xt=-3*H+9*it-9*ut+3*St,Rt=3*it-3*H):(Et=6*W-12*lt+6*dt,xt=-3*W+9*lt-9*dt+3*Pt,Rt=3*lt-3*W),Math.abs(xt)<1e-12){if(Math.abs(Et)<1e-12)continue;mt=-Rt/Et,0<mt&&mt<1&&Tt.push(mt);continue}Ot=Et*Et-4*Rt*xt,It=Math.sqrt(Ot),!(Ot<0)&&(Ft=(-Et+It)/(2*xt),0<Ft&&Ft<1&&Tt.push(Ft),Mt=(-Et-It)/(2*xt),0<Mt&&Mt<1&&Tt.push(Mt))}let wt=Tt.length,At;const kt=wt;for(;wt--;)mt=Tt[wt],At=1-mt,_t[0][wt]=At*At*At*H+3*At*At*mt*it+3*At*mt*mt*ut+mt*mt*mt*St,_t[1][wt]=At*At*At*W+3*At*At*mt*lt+3*At*mt*mt*dt+mt*mt*mt*Pt;return _t[0][kt]=H,_t[1][kt]=W,_t[0][kt+1]=St,_t[1][kt+1]=Pt,_t[0].length=_t[1].length=kt+2,[Math.min(..._t[0]),Math.min(..._t[1]),Math.max(..._t[0]),Math.max(..._t[1])]}}e.Util=ht;const yt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function vt(K){if(K[0]>="ï"){let W;if(K[0]==="þ"&&K[1]==="ÿ"?W="utf-16be":K[0]==="ÿ"&&K[1]==="þ"?W="utf-16le":K[0]==="ï"&&K[1]==="»"&&K[2]==="¿"&&(W="utf-8"),W)try{const it=new TextDecoder(W,{fatal:!0}),lt=Z(K);return it.decode(lt)}catch(it){l(`stringToPDFString: "${it}".`)}}const H=[];for(let W=0,it=K.length;W<it;W++){const lt=yt[K.charCodeAt(W)];H.push(lt?String.fromCharCode(lt):K.charAt(W))}return H.join("")}function bt(K){return decodeURIComponent(escape(K))}function Ct(K){return unescape(encodeURIComponent(K))}function gt(K){return typeof K=="object"&&K!==null&&K.byteLength!==void 0}function pt(K,H){if(K.length!==H.length)return!1;for(let W=0,it=K.length;W<it;W++)if(K[W]!==H[W])return!1;return!0}function Dt(K=new Date){return[K.getUTCFullYear().toString(),(K.getUTCMonth()+1).toString().padStart(2,"0"),K.getUTCDate().toString().padStart(2,"0"),K.getUTCHours().toString().padStart(2,"0"),K.getUTCMinutes().toString().padStart(2,"0"),K.getUTCSeconds().toString().padStart(2,"0")].join("")}function Nt(){const K=Object.create(null);let H=!1;return Object.defineProperty(K,"settled",{get(){return H}}),K.promise=new Promise(function(W,it){K.resolve=function(lt){H=!0,W(lt)},K.reject=function(lt){H=!0,it(lt)}}),K}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:z,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:A}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=z,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=A}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:z}=__w_pdfjs_require__(21);createPDFNetworkStream=e=>new z(e)}else{const{PDFNetworkStream:z}=__w_pdfjs_require__(24),{PDFFetchStream:e}=__w_pdfjs_require__(25);createPDFNetworkStream=A=>(0,_display_utils.isValidFetchUrl)(A.url)?new e(A):new z(A)}function getDocument(z){if(typeof z=="string"||z instanceof URL)z={url:z};else if((0,_util.isArrayBuffer)(z))z={data:z};else if(z instanceof PDFDataRangeTransport)(0,_display_utils.deprecated)("`PDFDataRangeTransport`-instance, please use a parameter object with `range`-property instead."),z={range:z};else if(typeof z!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!z.url&&!z.data&&!z.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,A=Object.create(null);let i=null,p=null;for(const w in z){const M=z[w];switch(w){case"url":if(M instanceof URL){A[w]=M.href;continue}try{A[w]=new URL(M,window.location).href;continue}catch{if(_is_node.isNodeJS&&typeof M=="string")break}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":i=M;continue;case"worker":p=M;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&M instanceof Buffer)A[w]=new Uint8Array(M);else{if(M instanceof Uint8Array&&M.byteLength===M.buffer.byteLength)break;if(typeof M=="string")A[w]=(0,_util.stringToBytes)(M);else if(typeof M=="object"&&M!==null&&!isNaN(M.length)||(0,_util.isArrayBuffer)(M))A[w]=new Uint8Array(M);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}A[w]=M}if(A.CMapReaderFactory=A.CMapReaderFactory||DefaultCMapReaderFactory,A.StandardFontDataFactory=A.StandardFontDataFactory||DefaultStandardFontDataFactory,A.ignoreErrors=A.stopAtErrors!==!0,A.fontExtraProperties=A.fontExtraProperties===!0,A.pdfBug=A.pdfBug===!0,A.enableXfa=A.enableXfa===!0,(!Number.isInteger(A.rangeChunkSize)||A.rangeChunkSize<1)&&(A.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof A.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(A.docBaseUrl))&&(A.docBaseUrl=null),(!Number.isInteger(A.maxImageSize)||A.maxImageSize<-1)&&(A.maxImageSize=-1),typeof A.cMapUrl!="string"&&(A.cMapUrl=null),typeof A.standardFontDataUrl!="string"&&(A.standardFontDataUrl=null),typeof A.useWorkerFetch!="boolean"&&(A.useWorkerFetch=A.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&A.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(A.cMapUrl,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(A.standardFontDataUrl,document.baseURI)),typeof A.isEvalSupported!="boolean"&&(A.isEvalSupported=!0),typeof A.isOffscreenCanvasSupported!="boolean"&&(A.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof A.disableFontFace!="boolean"&&(A.disableFontFace=_is_node.isNodeJS),typeof A.useSystemFonts!="boolean"&&(A.useSystemFonts=!_is_node.isNodeJS&&!A.disableFontFace),(typeof A.ownerDocument!="object"||A.ownerDocument===null)&&(A.ownerDocument=globalThis.document),typeof A.disableRange!="boolean"&&(A.disableRange=!1),typeof A.disableStream!="boolean"&&(A.disableStream=!1),typeof A.disableAutoFetch!="boolean"&&(A.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(A.verbosity),!p){const w={verbosity:A.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};p=w.port?_PDFWorker.fromPort(w):new _PDFWorker(w),e._worker=p}const O=e.docId;return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const w=_fetchDocument(p,A,i,O),M=new Promise(function(C){let h;i?h=new _transport_stream.PDFDataTransportStream({length:A.length,initialData:A.initialData,progressiveDone:A.progressiveDone,contentDispositionFilename:A.contentDispositionFilename,disableRange:A.disableRange,disableStream:A.disableStream},i):A.data||(h=createPDFNetworkStream({url:A.url,length:A.length,httpHeaders:A.httpHeaders,withCredentials:A.withCredentials,rangeChunkSize:A.rangeChunkSize,disableRange:A.disableRange,disableStream:A.disableStream})),C(h)});return Promise.all([w,M]).then(function([C,h]){if(e.destroyed)throw new Error("Loading aborted");const o=new _message_handler.MessageHandler(O,C,p.port),c=new WorkerTransport(o,e,h,A);e._transport=c,o.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(z,e,A,i){if(z.destroyed)throw new Error("Worker was destroyed");A&&(e.length=A.length,e.initialData=A.initialData,e.progressiveDone=A.progressiveDone,e.contentDispositionFilename=A.contentDispositionFilename);const p=e.data?[e.data.buffer]:null,O=await z.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"3.3.122",data:e.data,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length,docBaseUrl:e.docBaseUrl,enableXfa:e.enableXfa,evaluatorOptions:{maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,isOffscreenCanvasSupported:e.isOffscreenCanvasSupported,fontExtraProperties:e.fontExtraProperties,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null}},p);if(z.destroyed)throw new Error("Worker was destroyed");return O}class PDFDocumentLoadingTask{static#t=0;#e=null;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get onUnsupportedFeature(){return this.#e}set onUnsupportedFeature(e){(0,_display_utils.deprecated)("The PDFDocumentLoadingTask onUnsupportedFeature property will be removed in the future."),this.#e=e}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,A,i=!1,p=null){this.length=e,this.initialData=A,this.progressiveDone=i,this.contentDispositionFilename=p,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,A){for(const i of this._rangeListeners)i(e,A)}onDataProgress(e,A){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,A)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const A of this._progressiveReadListeners)A(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,A){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,A){this._pdfInfo=e,this._transport=A}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,A,i,p,O=!1){this._pageIndex=e,this._pageInfo=A,this._ownerDocument=p,this._transport=i,this._stats=O?new _display_utils.StatTimer:null,this._pdfBug=O,this.commonObjs=i.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:A=this.rotate,offsetX:i=0,offsetY:p=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:A,offsetX:i,offsetY:p,dontFlip:O})}getAnnotations({intent:e="display"}={}){const A=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,A.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:A,intent:i="display",annotationMode:p=_util.AnnotationMode.ENABLE,transform:O=null,canvasFactory:w=null,background:M=null,optionalContentConfigPromise:C=null,annotationCanvasMap:h=null,pageColors:o=null,printAnnotationStorage:c=null}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(i,p,c);this.pendingCleanup=!1,C||(C=this._transport.getOptionalContentConfig());let s=this._intentStates.get(d.cacheKey);s||(s=Object.create(null),this._intentStates.set(d.cacheKey,s)),s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null);const u=w||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),_=!!(d.renderingIntent&_util.RenderingIntentFlag.PRINT);s.displayReadyCapability||(s.displayReadyCapability=(0,_util.createPromiseCapability)(),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const m=F=>{s.renderTasks.delete(g),(this.cleanupAfterRender||_)&&(this.pendingCleanup=!0),this._tryCleanup(),F?(g.capability.reject(F),this._abortOperatorList({intentState:s,reason:F instanceof Error?F:new Error(F)})):g.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},g=new InternalRenderTask({callback:m,params:{canvasContext:e,viewport:A,transform:O,background:M},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:s.operatorList,pageIndex:this._pageIndex,canvasFactory:u,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:o});(s.renderTasks||=new Set).add(g);const x=g.task;return Promise.all([s.displayReadyCapability.promise,C]).then(([F,v])=>{if(this.pendingCleanup){m();return}this._stats?.time("Rendering"),g.initializeGraphics({transparency:F,optionalContentConfig:v}),g.operatorListChanged()}).catch(m),x}getOperatorList({intent:e="display",annotationMode:A=_util.AnnotationMode.ENABLE,printAnnotationStorage:i=null}={}){function p(){w.operatorList.lastChunk&&(w.opListReadCapability.resolve(w.operatorList),w.renderTasks.delete(M))}const O=this._transport.getRenderingIntent(e,A,i,!0);let w=this._intentStates.get(O.cacheKey);w||(w=Object.create(null),this._intentStates.set(O.cacheKey,w));let M;return w.opListReadCapability||(M=Object.create(null),M.operatorListChanged=p,w.opListReadCapability=(0,_util.createPromiseCapability)(),(w.renderTasks||=new Set).add(M),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(O)),w.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:A=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:A===!0},{highWaterMark:100,size(p){return p.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>_xfa_text.XfaText.textContent(i));const A=this.streamTextContent(e);return new Promise(function(i,p){function O(){w.read().then(function({value:C,done:h}){if(h){i(M);return}Object.assign(M.styles,C.styles),M.items.push(...C.items),O()},p)}const w=A.getReader(),M={items:[],styles:Object.create(null)};O()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const A of this._intentStates.values())if(this._abortOperatorList({intentState:A,reason:new Error("Page was destroyed."),force:!0}),!A.opListReadCapability)for(const i of A.renderTasks)e.push(i.completed),i.cancel();this.objs.clear();for(const A of this._bitmaps)A.close();return this._bitmaps.clear(),this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:A,operatorList:i}of this._intentStates.values())if(A.size>0||!i.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const A of this._bitmaps)A.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,A){const i=this._intentStates.get(A);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,A){for(let i=0,p=e.length;i<p;i++)A.operatorList.fnArray.push(e.fnArray[i]),A.operatorList.argsArray.push(e.argsArray[i]);A.operatorList.lastChunk=e.lastChunk,A.operatorList.separateAnnots=e.separateAnnots;for(const i of A.renderTasks)i.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:A,annotationStorageMap:i}){const O=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:A,annotationStorage:i}).getReader(),w=this._intentStates.get(A);w.streamReader=O;const M=()=>{O.read().then(({value:C,done:h})=>{if(h){w.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(C,w),M())},C=>{if(w.streamReader=null,!this._transport.destroyed){if(w.operatorList){w.operatorList.lastChunk=!0;for(const h of w.renderTasks)h.operatorListChanged();this._tryCleanup()}if(w.displayReadyCapability)w.displayReadyCapability.reject(C);else if(w.opListReadCapability)w.opListReadCapability.reject(C);else throw C}})};M()}_abortOperatorList({intentState:e,reason:A,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(A instanceof _display_utils.RenderingCancelledException){let p=RENDERING_CANCELLED_TIMEOUT;A.extraDelay>0&&A.extraDelay<1e3&&(p+=A.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:A,force:!0})},p);return}}if(e.streamReader.cancel(new _util.AbortException(A.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[p,O]of this._intentStates)if(O===e){this._intentStates.delete(p);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=[];#e=Promise.resolve();postMessage(e,A){const i={data:structuredClone(e,A)};this.#e.then(()=>{for(const p of this.#t)p.call(this,i)})}addEventListener(e,A){this.#t.push(A)}removeEventListener(e,A){const i=this.#t.indexOf(A);this.#t.splice(i,1)}terminate(){this.#t.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const z=document?.currentScript?.src;z&&(PDFWorkerUtil.fallbackWorkerSrc=z.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(z,e){let A;try{if(A=new URL(z),!A.origin||A.origin==="null")return!1}catch{return!1}const i=new URL(e,A);return A.origin===i.origin},PDFWorkerUtil.createCDNWrapper=function(z){const e=`importScripts("${z}");`;return URL.createObjectURL(new Blob([e]))}}class _PDFWorker{static#workerPorts=new WeakMap;constructor({name:z=null,port:e=null,verbosity:A=(0,_util.getVerbosityLevel)()}={}){if(e&&_PDFWorker.#workerPorts.has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=z,this.destroyed=!1,this.verbosity=A,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){_PDFWorker.#workerPorts.set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(z){this._port=z,this._messageHandler=new _message_handler.MessageHandler("main","worker",z),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:z}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,z)||(z=PDFWorkerUtil.createCDNWrapper(new URL(z,window.location).href));const e=new Worker(z),A=new _message_handler.MessageHandler("main","worker",e),i=()=>{e.removeEventListener("error",p),A.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},p=()=>{this._webWorker||i()};e.addEventListener("error",p),A.on("test",w=>{if(e.removeEventListener("error",p),this.destroyed){i();return}w?(this._messageHandler=A,this._port=e,this._webWorker=e,this._readyCapability.resolve(),A.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),A.destroy(),e.terminate())}),A.on("ready",w=>{if(e.removeEventListener("error",p),this.destroyed){i();return}try{O()}catch{this._setupFakeWorker()}});const O=()=>{const w=new Uint8Array;A.send("test",w,[w.buffer])};O();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(z=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const A=`fake${PDFWorkerUtil.fakeWorkerId++}`,i=new _message_handler.MessageHandler(A+"_worker",A,e);z.setup(i,e);const p=new _message_handler.MessageHandler(A,A+"_worker",e);this._messageHandler=p,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})}).catch(z=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${z.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(z){if(!z?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(z.port)?this.#workerPorts.get(z.port):new _PDFWorker(z)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=_PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#n=null;constructor(e,A,i,p){this.messageHandler=e,this.loadingTask=A,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:p.ownerDocument,styleElement:p.styleElement}),this._params=p,p.useWorkerFetch||(this.CMapReaderFactory=new p.CMapReaderFactory({baseUrl:p.cMapUrl,isCompressed:p.cMapPacked}),this.StandardFontDataFactory=new p.StandardFontDataFactory({baseUrl:p.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,A=_util.AnnotationMode.ENABLE,i=null,p=!1){let O=_util.RenderingIntentFlag.DISPLAY,w=null;switch(e){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(A){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,w=(O&_util.RenderingIntentFlag.PRINT&&i instanceof _annotation_storage.PrintAnnotationStorage?i:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${A}`)}return p&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${_annotation_storage.AnnotationStorage.getHash(w)}`,annotationStorageMap:w}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#e.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const A=this.messageHandler.sendWithPromise("Terminate",null);return e.push(A),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#n=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:A}=this;e.on("GetReader",(i,p)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},p.onPull=()=>{this._fullReader.read().then(function({value:O,done:w}){if(w){p.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{p.error(O)})},p.onCancel=O=>{this._fullReader.cancel(O),p.ready.catch(w=>{if(!this.destroyed)throw w})}}),e.on("ReaderHeadersReady",i=>{const p=(0,_util.createPromiseCapability)(),O=this._fullReader;return O.headersReady.then(()=>{(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&A.onProgress?.(this._lastProgress),O.onProgress=w=>{A.onProgress?.({loaded:w.loaded,total:w.total})}),p.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},p.reject),p.promise}),e.on("GetRangeReader",(i,p)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(i.begin,i.end);if(!O){p.close();return}p.onPull=()=>{O.read().then(function({value:w,done:M}){if(M){p.close();return}(0,_util.assert)(w instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(w),1,[w])}).catch(w=>{p.error(w)})},p.onCancel=w=>{O.cancel(w),p.ready.catch(M=>{if(!this.destroyed)throw M})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,A._capability.resolve(new PDFDocumentProxy(i,this))}),e.on("DocException",function(i){let p;switch(i.name){case"PasswordException":p=new _util.PasswordException(i.message,i.code);break;case"InvalidPDFException":p=new _util.InvalidPDFException(i.message);break;case"MissingPDFException":p=new _util.MissingPDFException(i.message);break;case"UnexpectedResponseException":p=new _util.UnexpectedResponseException(i.message,i.status);break;case"UnknownErrorException":p=new _util.UnknownErrorException(i.message,i.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}A._capability.reject(p)}),e.on("PasswordRequest",i=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),A.onPassword){const p=O=>{O instanceof Error?this._passwordCapability.reject(O):this._passwordCapability.resolve({password:O})};try{A.onPassword(p,i.code)}catch(O){this._passwordCapability.reject(O)}}else this._passwordCapability.reject(new _util.PasswordException(i.message,i.code));return this._passwordCapability.promise}),e.on("DataLoaded",i=>{A.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,p,O])=>{if(!this.destroyed&&!this.commonObjs.has(i))switch(p){case"Font":const w=this._params;if("error"in O){const h=O.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(i,h);break}let M=null;w.pdfBug&&globalThis.FontInspector?.enabled&&(M={registerFont(h,o){globalThis.FontInspector.fontAdded(h,o)}});const C=new _font_loader.FontFaceObject(O,{isEvalSupported:w.isEvalSupported,disableFontFace:w.disableFontFace,ignoreErrors:w.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:M});this.fontLoader.bind(C).catch(h=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!w.fontExtraProperties&&C.data&&(C.data=null),this.commonObjs.resolve(i,C)});break;case"FontPath":case"Image":this.commonObjs.resolve(i,O);break;default:throw new Error(`Got unknown common object type ${p}`)}}),e.on("obj",([i,p,O,w])=>{if(this.destroyed)return;const M=this.#t.get(p);if(!M.objs.has(i))switch(O){case"Image":M.objs.resolve(i,w);const C=8e6;if(w){let h;if(w.bitmap){const{bitmap:o,width:c,height:d}=w;h=c*d*4,M._bitmaps.add(o)}else h=w.data?.length||0;h>C&&(M.cleanupAfterRender=!0)}break;case"Pattern":M.objs.resolve(i,w);break;default:throw new Error(`Got unknown object type ${O}`)}}),e.on("DocProgress",i=>{this.destroyed||A.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const A=e-1,i=this.#e.get(A);if(i)return i;const p=this.messageHandler.sendWithPromise("GetPage",{pageIndex:A}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const w=new PDFPageProxy(A,O,this,this._params.ownerDocument,this._params.pdfBug);return this.#t.set(A,w),w});return this.#e.set(A,p),p}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,A){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:A})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#n||=this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const A of this.#t.values())if(!A.cleanup())throw new Error(`startCleanup: Page ${A.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#n=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}class PDFObjects{#t=Object.create(null);#e(e){const A=this.#t[e];return A||(this.#t[e]={capability:(0,_util.createPromiseCapability)(),data:null})}get(e,A=null){if(A){const p=this.#e(e);return p.capability.promise.then(()=>A(p.data)),null}const i=this.#t[e];if(!i?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){return this.#t[e]?.capability.settled||!1}resolve(e,A=null){const i=this.#e(e);i.data=A,i.capability.resolve()}clear(){this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(e){this.#t=e,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(e=0){this.#t.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#t.operatorList;if(!e)return!1;const{annotationCanvasMap:A}=this.#t;return e.form||e.canvas&&A?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:e,params:A,objs:i,commonObjs:p,annotationCanvasMap:O,operatorList:w,pageIndex:M,canvasFactory:C,useRequestAnimationFrame:h=!1,pdfBug:o=!1,pageColors:c=null}){this.callback=e,this.params=A,this.objs=i,this.commonObjs=p,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=w,this._pageIndex=M,this.canvasFactory=C,this._pdfBug=o,this.pageColors=c,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=A.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:A}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:p,transform:O,background:w}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:A},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:O,viewport:p,transparency:e,background:w}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,A=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",A))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.3.122";exports.version=version;const build="562045607";exports.build=build},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var i=A(1),p=A(4),O=A(8);class w{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(h,o){const c=this.#e.get(h);return c===void 0?o:Object.assign(o,c)}getRawValue(h){return this.#e.get(h)}remove(h){if(this.#e.delete(h),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const o of this.#e.values())if(o instanceof p.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(h,o){const c=this.#e.get(h);let d=!1;if(c!==void 0)for(const[s,u]of Object.entries(o))c[s]!==u&&(d=!0,c[s]=u);else d=!0,this.#e.set(h,o);d&&this.#n(),o instanceof p.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(o.constructor._type)}has(h){return this.#e.has(h)}getAll(){return this.#e.size>0?(0,i.objectFromMap)(this.#e):null}get size(){return this.#e.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new M(this)}get serializable(){if(this.#e.size===0)return null;const h=new Map;for(const[o,c]of this.#e){const d=c instanceof p.AnnotationEditor?c.serialize():c;d&&h.set(o,d)}return h}static getHash(h){if(!h)return"";const o=new O.MurmurHash3_64;for(const[c,d]of h)o.update(`${c}:${JSON.stringify(d)}`);return o.hexdigest()}}e.AnnotationStorage=w;class M extends w{#t=null;constructor(h){super(),this.#t=structuredClone(h.serializable)}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}e.PrintAnnotationStorage=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var i=A(5),p=A(1);class O{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#n=!1;#i=!1;#r=!1;_uiManager=null;#l=O._zIndex++;static _colorManager=new i.ColorManager;static _zIndex=1;constructor(M){this.constructor===O&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=M.parent,this.id=M.id,this.width=this.height=null,this.pageIndex=M.parent.pageIndex,this.name=M.name,this.div=null,this._uiManager=M.uiManager;const{rotation:C,rawDims:{pageWidth:h,pageHeight:o,pageX:c,pageY:d}}=this.parent.viewport;this.rotation=C,this.pageDimensions=[h,o],this.pageTranslation=[c,d];const[s,u]=this.parentDimensions;this.x=M.x/s,this.y=M.y/u,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(M){this._uiManager.addCommands(M)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#l}setParent(M){M!==null&&(this.pageIndex=M.pageIndex,this.pageDimensions=M.pageDimensions),this.parent=M}focusin(M){this.#n?this.#n=!1:this.parent.setSelected(this)}focusout(M){!this.isAttachedToDOM||M.relatedTarget?.closest(`#${this.id}`)||(M.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(M){const C=this.parent.div.getBoundingClientRect();this.startX=M.clientX-C.x,this.startY=M.clientY-C.y,M.dataTransfer.setData("text/plain",this.id),M.dataTransfer.effectAllowed="move"}setAt(M,C,h,o){const[c,d]=this.parentDimensions;[h,o]=this.screenToPageTranslation(h,o),this.x=(M+h)/c,this.y=(C+o)/d,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(M,C){const[h,o]=this.parentDimensions;[M,C]=this.screenToPageTranslation(M,C),this.x+=M/h,this.y+=C/o,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(M,C){switch(this.parentRotation){case 90:return[C,-M];case 180:return[-M,-C];case 270:return[-C,M];default:return[M,C]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:M}=this._uiManager.viewParameters,[C,h]=this.pageDimensions;return[C*M,h*M]}setDims(M,C){const[h,o]=this.parentDimensions;this.div.style.width=`${100*M/h}%`,this.div.style.height=`${100*C/o}%`}fixDims(){const{style:M}=this.div,{height:C,width:h}=M,o=h.endsWith("%"),c=C.endsWith("%");if(o&&c)return;const[d,s]=this.parentDimensions;o||(M.width=`${100*parseFloat(h)/d}%`),c||(M.height=`${100*parseFloat(C)/s}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);const[M,C]=this.getInitialTranslation();return this.translate(M,C),(0,i.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(M){const{isMac:C}=p.FeatureTest.platform;if(M.button!==0||M.ctrlKey&&C){M.preventDefault();return}M.ctrlKey&&!C||M.shiftKey||M.metaKey&&C?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#n=!0}getRect(M,C){const h=this.parentScale,[o,c]=this.pageDimensions,[d,s]=this.pageTranslation,u=M/h,_=C/h,m=this.x*o,g=this.y*c,x=this.width*o,F=this.height*c;switch(this.rotation){case 0:return[m+u+d,c-g-_-F+s,m+u+x+d,c-g-_+s];case 90:return[m+_+d,c-g+u+s,m+_+F+d,c-g+u+x+s];case 180:return[m-u-x+d,c-g+_+s,m-u+d,c-g+_+F+s];case 270:return[m-_-F+d,c-g-u-x+s,m-_+d,c-g-u+s];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(M,C){const[h,o,c,d]=M,s=c-h,u=d-o;switch(this.rotation){case 0:return[h,C-d,s,u];case 90:return[h,C-o,u,s];case 180:return[c,C-o,s,u];case 270:return[c,C-d,u,s];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,p.unreachable)("An editor must be serializable")}static deserialize(M,C,h){const o=new this.prototype.constructor({parent:C,id:C.getNextId(),uiManager:h});o.rotation=M.rotation;const[c,d]=o.pageDimensions,[s,u,_,m]=o.getRectInCurrentCoords(M.rect,d);return o.x=s/c,o.y=u/d,o.width=_/c,o.height=m/d,o}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(M,C){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#i}set isEditing(M){this.#i=M,M?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}e.AnnotationEditor=O},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=O,e.opacityToHex=w;var i=A(1),p=A(6);function O(d,s,u){for(const _ of u)s.addEventListener(_,d[_].bind(d))}function w(d){return Math.round(Math.min(255,Math.max(1,255*d))).toString(16).padStart(2,"0")}class M{#t=0;getId(){return`${i.AnnotationEditorPrefix}${this.#t++}`}}class C{#t=[];#e=!1;#n;#i=-1;constructor(s=128){this.#n=s}add({cmd:s,undo:u,mustExec:_,type:m=NaN,overwriteIfSameType:g=!1,keepUndo:x=!1}){if(_&&s(),this.#e)return;const F={cmd:s,undo:u,type:m};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(F);return}if(g&&this.#t[this.#i].type===m){x&&(F.undo=this.#t[this.#i].undo),this.#t[this.#i]=F;return}const v=this.#i+1;v===this.#n?this.#t.splice(0,1):(this.#i=v,v<this.#t.length&&this.#t.splice(v)),this.#t.push(F)}undo(){this.#i!==-1&&(this.#e=!0,this.#t[this.#i].undo(),this.#e=!1,this.#i-=1)}redo(){this.#i<this.#t.length-1&&(this.#i+=1,this.#e=!0,this.#t[this.#i].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}destroy(){this.#t=null}}e.CommandManager=C;class h{constructor(s){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:u}=i.FeatureTest.platform;for(const[_,m]of s)for(const g of _){const x=g.startsWith("mac+");u&&x?(this.callbacks.set(g.slice(4),m),this.allKeys.add(g.split("+").at(-1))):!u&&!x&&(this.callbacks.set(g,m),this.allKeys.add(g.split("+").at(-1)))}}#t(s){s.altKey&&this.buffer.push("alt"),s.ctrlKey&&this.buffer.push("ctrl"),s.metaKey&&this.buffer.push("meta"),s.shiftKey&&this.buffer.push("shift"),this.buffer.push(s.key);const u=this.buffer.join("+");return this.buffer.length=0,u}exec(s,u){if(!this.allKeys.has(u.key))return;const _=this.callbacks.get(this.#t(u));_&&(_.bind(s)(),u.stopPropagation(),u.preventDefault())}}e.KeyboardManager=h;class o{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const s=new Map([["CanvasText",null],["Canvas",null]]);return(0,p.getColorValues)(s),(0,i.shadow)(this,"_colors",s)}convert(s){const u=(0,p.getRGB)(s);if(!window.matchMedia("(forced-colors: active)").matches)return u;for(const[_,m]of this._colors)if(m.every((g,x)=>g===u[x]))return o._colorsMapping.get(_);return u}getHexCode(s){const u=this._colors.get(s);return u?i.Util.makeHexColor(...u):s}}e.ColorManager=o;class c{#t=null;#e=new Map;#n=new Map;#i=null;#r=new C;#l=0;#c=null;#s=new Set;#a=null;#p=new M;#h=!1;#f=i.AnnotationEditorType.NONE;#o=new Set;#g=this.copy.bind(this);#C=this.cut.bind(this);#T=this.paste.bind(this);#P=this.keydown.bind(this);#x=this.onEditingAction.bind(this);#y=this.onPageChanging.bind(this);#w=this.onScaleChanging.bind(this);#k=this.onRotationChanging.bind(this);#R={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#d=null;static _keyboardManager=new h([[["ctrl+a","mac+meta+a"],c.prototype.selectAll],[["ctrl+z","mac+meta+z"],c.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],c.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],c.prototype.delete],[["Escape","mac+Escape"],c.prototype.unselectAll]]);constructor(s,u,_){this.#d=s,this.#a=u,this.#a._on("editingaction",this.#x),this.#a._on("pagechanging",this.#y),this.#a._on("scalechanging",this.#w),this.#a._on("rotationchanging",this.#k),this.#i=_,this.viewParameters={realScale:p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#_(),this.#a._off("editingaction",this.#x),this.#a._off("pagechanging",this.#y),this.#a._off("scalechanging",this.#w),this.#a._off("rotationchanging",this.#k);for(const s of this.#n.values())s.destroy();this.#n.clear(),this.#e.clear(),this.#s.clear(),this.#t=null,this.#o.clear(),this.#r.destroy()}onPageChanging({pageNumber:s}){this.#l=s-1}focusMainContainer(){this.#d.focus()}addShouldRescale(s){this.#s.add(s)}removeShouldRescale(s){this.#s.delete(s)}onScaleChanging({scale:s}){this.commitOrRemove(),this.viewParameters.realScale=s*p.PixelsPerInch.PDF_TO_CSS_UNITS;for(const u of this.#s)u.onScaleChanging()}onRotationChanging({pagesRotation:s}){this.commitOrRemove(),this.viewParameters.rotation=s}addToAnnotationStorage(s){!s.isEmpty()&&this.#i&&!this.#i.has(s.id)&&this.#i.setValue(s.id,s)}#F(){this.#d.addEventListener("keydown",this.#P)}#_(){this.#d.removeEventListener("keydown",this.#P)}#v(){document.addEventListener("copy",this.#g),document.addEventListener("cut",this.#C),document.addEventListener("paste",this.#T)}#b(){document.removeEventListener("copy",this.#g),document.removeEventListener("cut",this.#C),document.removeEventListener("paste",this.#T)}copy(s){if(s.preventDefault(),this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const u=[];for(const _ of this.#o)_.isEmpty()||u.push(_.serialize());u.length!==0&&s.clipboardData.setData("application/pdfjs",JSON.stringify(u))}cut(s){this.copy(s),this.delete()}paste(s){s.preventDefault();let u=s.clipboardData.getData("application/pdfjs");if(!u)return;try{u=JSON.parse(u)}catch(m){(0,i.warn)(`paste: "${m.message}".`);return}if(!Array.isArray(u))return;this.unselectAll();const _=this.#n.get(this.#l);try{const m=[];for(const F of u){const v=_.deserialize(F);if(!v)return;m.push(v)}const g=()=>{for(const F of m)this.#D(F);this.#S(m)},x=()=>{for(const F of m)F.remove()};this.addCommands({cmd:g,undo:x,mustExec:!0})}catch(m){(0,i.warn)(`paste: "${m.message}".`)}}keydown(s){this.getActive()?.shouldGetKeyboardEvents()||c._keyboardManager.exec(this,s)}onEditingAction(s){["undo","redo","delete","selectAll"].includes(s.name)&&this[s.name]()}#u(s){Object.entries(s).some(([_,m])=>this.#R[_]!==m)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#R,s)})}#m(s){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:s})}setEditingState(s){s?(this.#F(),this.#v(),this.#u({isEditing:this.#f!==i.AnnotationEditorType.NONE,isEmpty:this.#A(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#_(),this.#b(),this.#u({isEditing:!1}))}registerEditorTypes(s){if(!this.#c){this.#c=s;for(const u of this.#c)this.#m(u.defaultPropertiesToUpdate)}}getId(){return this.#p.getId()}get currentLayer(){return this.#n.get(this.#l)}get currentPageIndex(){return this.#l}addLayer(s){this.#n.set(s.pageIndex,s),this.#h?s.enable():s.disable()}removeLayer(s){this.#n.delete(s.pageIndex)}updateMode(s){if(this.#f=s,s===i.AnnotationEditorType.NONE)this.setEditingState(!1),this.#O();else{this.setEditingState(!0),this.#M();for(const u of this.#n.values())u.updateMode(s)}}updateToolbar(s){s!==this.#f&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:s})}updateParams(s,u){if(this.#c){for(const _ of this.#o)_.updateParams(s,u);for(const _ of this.#c)_.updateDefaultParams(s,u)}}#M(){if(!this.#h){this.#h=!0;for(const s of this.#n.values())s.enable()}}#O(){if(this.unselectAll(),this.#h){this.#h=!1;for(const s of this.#n.values())s.disable()}}getEditors(s){const u=[];for(const _ of this.#e.values())_.pageIndex===s&&u.push(_);return u}getEditor(s){return this.#e.get(s)}addEditor(s){this.#e.set(s.id,s)}removeEditor(s){this.#e.delete(s.id),this.unselect(s),this.#i?.remove(s.id)}#D(s){const u=this.#n.get(s.pageIndex);u?u.addOrRebuild(s):this.addEditor(s)}setActiveEditor(s){this.#t!==s&&(this.#t=s,s&&this.#m(s.propertiesToUpdate))}toggleSelected(s){if(this.#o.has(s)){this.#o.delete(s),s.unselect(),this.#u({hasSelectedEditor:this.hasSelection});return}this.#o.add(s),s.select(),this.#m(s.propertiesToUpdate),this.#u({hasSelectedEditor:!0})}setSelected(s){for(const u of this.#o)u!==s&&u.unselect();this.#o.clear(),this.#o.add(s),s.select(),this.#m(s.propertiesToUpdate),this.#u({hasSelectedEditor:!0})}isSelected(s){return this.#o.has(s)}unselect(s){s.unselect(),this.#o.delete(s),this.#u({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#r.undo(),this.#u({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#A()})}redo(){this.#r.redo(),this.#u({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#A()})}addCommands(s){this.#r.add(s),this.#u({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#A()})}#A(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const s of this.#e.values())return s.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const s=[...this.#o],u=()=>{for(const m of s)m.remove()},_=()=>{for(const m of s)this.#D(m)};this.addCommands({cmd:u,undo:_,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}#S(s){this.#o.clear();for(const u of s)u.isEmpty()||(this.#o.add(u),u.select());this.#u({hasSelectedEditor:!0})}selectAll(){for(const s of this.#o)s.commit();this.#S(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.#o.size!==0){for(const s of this.#o)s.unselect();this.#o.clear(),this.#u({hasSelectedEditor:!1})}}isActive(s){return this.#t===s}getActive(){return this.#t}getMode(){return this.#f}}e.AnnotationEditorUIManager=c},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=f,e.getColorValues=U,e.getCurrentTransform=J,e.getCurrentTransformInverse=rt,e.getFilenameFromUrl=g,e.getPdfFilenameFromUrl=x,e.getRGB=B,e.getXfaPageViewport=L,e.isDataScheme=_,e.isPdfFile=m,e.isValidFetchUrl=v,e.loadScript=r,e.setLayerDimensions=Q;var i=A(7),p=A(1);const O="http://www.w3.org/2000/svg",w="pdfjs_internal_id_";e.AnnotationPrefix=w;class M{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=M;class C extends i.BaseCanvasFactory{constructor({ownerDocument:N=globalThis.document}={}){super(),this._document=N}_createCanvas(N,q){const S=this._document.createElement("canvas");return S.width=N,S.height=q,S}}e.DOMCanvasFactory=C;async function h($,N=!1){if(v($,document.baseURI)){const q=await fetch($);if(!q.ok)throw new Error(q.statusText);return N?new Uint8Array(await q.arrayBuffer()):(0,p.stringToBytes)(await q.text())}return new Promise((q,S)=>{const l=new XMLHttpRequest;l.open("GET",$,!0),N&&(l.responseType="arraybuffer"),l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let n;if(N&&l.response?n=new Uint8Array(l.response):!N&&l.responseText&&(n=(0,p.stringToBytes)(l.responseText)),n){q(n);return}}S(new Error(l.statusText))}},l.send(null)})}class o extends i.BaseCMapReaderFactory{_fetchData(N,q){return h(N,this.isCompressed).then(S=>({cMapData:S,compressionType:q}))}}e.DOMCMapReaderFactory=o;class c extends i.BaseStandardFontDataFactory{_fetchData(N){return h(N,!0)}}e.DOMStandardFontDataFactory=c;class d extends i.BaseSVGFactory{_createSVG(N){return document.createElementNS(O,N)}}e.DOMSVGFactory=d;class s{constructor({viewBox:N,scale:q,rotation:S,offsetX:l=0,offsetY:n=0,dontFlip:y=!1}){this.viewBox=N,this.scale=q,this.rotation=S,this.offsetX=l,this.offsetY=n;const R=(N[2]+N[0])/2,k=(N[3]+N[1])/2;let t,a,b,P;switch(S%=360,S<0&&(S+=360),S){case 180:t=-1,a=0,b=0,P=1;break;case 90:t=0,a=1,b=1,P=0;break;case 270:t=0,a=-1,b=-1,P=0;break;case 0:t=1,a=0,b=0,P=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}y&&(b=-b,P=-P);let E,I,D,X;t===0?(E=Math.abs(k-N[1])*q+l,I=Math.abs(R-N[0])*q+n,D=(N[3]-N[1])*q,X=(N[2]-N[0])*q):(E=Math.abs(R-N[0])*q+l,I=Math.abs(k-N[1])*q+n,D=(N[2]-N[0])*q,X=(N[3]-N[1])*q),this.transform=[t*q,a*q,b*q,P*q,E-t*q*R-b*q*k,I-a*q*R-P*q*k],this.width=D,this.height=X}get rawDims(){const{viewBox:N}=this;return(0,p.shadow)(this,"rawDims",{pageWidth:N[2]-N[0],pageHeight:N[3]-N[1],pageX:N[0],pageY:N[1]})}clone({scale:N=this.scale,rotation:q=this.rotation,offsetX:S=this.offsetX,offsetY:l=this.offsetY,dontFlip:n=!1}={}){return new s({viewBox:this.viewBox.slice(),scale:N,rotation:q,offsetX:S,offsetY:l,dontFlip:n})}convertToViewportPoint(N,q){return p.Util.applyTransform([N,q],this.transform)}convertToViewportRectangle(N){const q=p.Util.applyTransform([N[0],N[1]],this.transform),S=p.Util.applyTransform([N[2],N[3]],this.transform);return[q[0],q[1],S[0],S[1]]}convertToPdfPoint(N,q){return p.Util.applyInverseTransform([N,q],this.transform)}}e.PageViewport=s;class u extends p.BaseException{constructor(N,q,S=0){super(N,"RenderingCancelledException"),this.type=q,this.extraDelay=S}}e.RenderingCancelledException=u;function _($){const N=$.length;let q=0;for(;q<N&&$[q].trim()==="";)q++;return $.substring(q,q+5).toLowerCase()==="data:"}function m($){return typeof $=="string"&&/\.pdf$/i.test($)}function g($,N=!1){return N||([$]=$.split(/[#?]/,1)),$.substring($.lastIndexOf("/")+1)}function x($,N="document.pdf"){if(typeof $!="string")return N;if(_($))return(0,p.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),N;const q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,S=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=q.exec($);let n=S.exec(l[1])||S.exec(l[2])||S.exec(l[3]);if(n&&(n=n[0],n.includes("%")))try{n=S.exec(decodeURIComponent(n))[0]}catch{}return n||N}class F{started=Object.create(null);times=[];time(N){N in this.started&&(0,p.warn)(`Timer is already running for ${N}`),this.started[N]=Date.now()}timeEnd(N){N in this.started||(0,p.warn)(`Timer has not been started for ${N}`),this.times.push({name:N,start:this.started[N],end:Date.now()}),delete this.started[N]}toString(){const N=[];let q=0;for(const{name:S}of this.times)q=Math.max(S.length,q);for(const{name:S,start:l,end:n}of this.times)N.push(`${S.padEnd(q)} ${n-l}ms
`);return N.join("")}}e.StatTimer=F;function v($,N){try{const{protocol:q}=N?new URL($,N):new URL($);return q==="http:"||q==="https:"}catch{return!1}}function r($,N=!1){return new Promise((q,S)=>{const l=document.createElement("script");l.src=$,l.onload=function(n){N&&l.remove(),q(n)},l.onerror=function(){S(new Error(`Cannot load script at: ${l.src}`))},(document.head||document.documentElement).append(l)})}function f($){console.log("Deprecated API usage: "+$)}let T;class j{static toDateObject(N){if(!N||typeof N!="string")return null;T||(T=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const q=T.exec(N);if(!q)return null;const S=parseInt(q[1],10);let l=parseInt(q[2],10);l=l>=1&&l<=12?l-1:0;let n=parseInt(q[3],10);n=n>=1&&n<=31?n:1;let y=parseInt(q[4],10);y=y>=0&&y<=23?y:0;let R=parseInt(q[5],10);R=R>=0&&R<=59?R:0;let k=parseInt(q[6],10);k=k>=0&&k<=59?k:0;const t=q[7]||"Z";let a=parseInt(q[8],10);a=a>=0&&a<=23?a:0;let b=parseInt(q[9],10)||0;return b=b>=0&&b<=59?b:0,t==="-"?(y+=a,R+=b):t==="+"&&(y-=a,R-=b),new Date(Date.UTC(S,l,n,y,R,k))}}e.PDFDateString=j;function L($,{scale:N=1,rotation:q=0}){const{width:S,height:l}=$.attributes.style,n=[0,0,parseInt(S),parseInt(l)];return new s({viewBox:n,scale:N,rotation:q})}function B($){if($.startsWith("#")){const N=parseInt($.slice(1),16);return[(N&16711680)>>16,(N&65280)>>8,N&255]}return $.startsWith("rgb(")?$.slice(4,-1).split(",").map(N=>parseInt(N)):$.startsWith("rgba(")?$.slice(5,-1).split(",").map(N=>parseInt(N)).slice(0,3):((0,p.warn)(`Not a valid color format: "${$}"`),[0,0,0])}function U($){const N=document.createElement("span");N.style.visibility="hidden",document.body.append(N);for(const q of $.keys()){N.style.color=q;const S=window.getComputedStyle(N).color;$.set(q,B(S))}N.remove()}function J($){const{a:N,b:q,c:S,d:l,e:n,f:y}=$.getTransform();return[N,q,S,l,n,y]}function rt($){const{a:N,b:q,c:S,d:l,e:n,f:y}=$.getTransform().invertSelf();return[N,q,S,l,n,y]}function Q($,N,q=!1,S=!0){if(N instanceof s){const{pageWidth:l,pageHeight:n}=N.rawDims,{style:y}=$,R=`calc(var(--scale-factor) * ${l}px)`,k=`calc(var(--scale-factor) * ${n}px)`;!q||N.rotation%180===0?(y.width=R,y.height=k):(y.width=k,y.height=R)}S&&$.setAttribute("data-main-rotation",N.rotation)}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var i=A(1);class p{constructor(){this.constructor===p&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,o){if(h<=0||o<=0)throw new Error("Invalid canvas size");const c=this._createCanvas(h,o);return{canvas:c,context:c.getContext("2d")}}reset(h,o,c){if(!h.canvas)throw new Error("Canvas is not specified");if(o<=0||c<=0)throw new Error("Invalid canvas size");h.canvas.width=o,h.canvas.height=c}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,o){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=p;class O{constructor({baseUrl:h=null,isCompressed:o=!1}){this.constructor===O&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=o}async fetch({name:h}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const o=this.baseUrl+h+(this.isCompressed?".bcmap":""),c=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(o,c).catch(d=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${o}`)})}_fetchData(h,o){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=O;class w{constructor({baseUrl:h=null}){this.constructor===w&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch({filename:h}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const o=`${this.baseUrl}${h}`;return this._fetchData(o).catch(c=>{throw new Error(`Unable to load font data at: ${o}`)})}_fetchData(h){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=w;class M{constructor(){this.constructor===M&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,o,c=!1){if(h<=0||o<=0)throw new Error("Invalid SVG dimensions");const d=this._createSVG("svg:svg");return d.setAttribute("version","1.1"),c||(d.setAttribute("width",`${h}px`),d.setAttribute("height",`${o}px`)),d.setAttribute("preserveAspectRatio","none"),d.setAttribute("viewBox",`0 0 ${h} ${o}`),d}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,i.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var i=A(1);const p=3285377520,O=4294901760,w=65535;class M{constructor(h){this.h1=h?h&4294967295:p,this.h2=h?h&4294967295:p}update(h){let o,c;if(typeof h=="string"){o=new Uint8Array(h.length*2),c=0;for(let T=0,j=h.length;T<j;T++){const L=h.charCodeAt(T);L<=255?o[c++]=L:(o[c++]=L>>>8,o[c++]=L&255)}}else if((0,i.isArrayBuffer)(h))o=h.slice(),c=o.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const d=c>>2,s=c-d*4,u=new Uint32Array(o.buffer,0,d);let _=0,m=0,g=this.h1,x=this.h2;const F=3432918353,v=461845907,r=F&w,f=v&w;for(let T=0;T<d;T++)T&1?(_=u[T],_=_*F&O|_*r&w,_=_<<15|_>>>17,_=_*v&O|_*f&w,g^=_,g=g<<13|g>>>19,g=g*5+3864292196):(m=u[T],m=m*F&O|m*r&w,m=m<<15|m>>>17,m=m*v&O|m*f&w,x^=m,x=x<<13|x>>>19,x=x*5+3864292196);switch(_=0,s){case 3:_^=o[d*4+2]<<16;case 2:_^=o[d*4+1]<<8;case 1:_^=o[d*4],_=_*F&O|_*r&w,_=_<<15|_>>>17,_=_*v&O|_*f&w,d&1?g^=_:x^=_}this.h1=g,this.h2=x}hexdigest(){let h=this.h1,o=this.h2;return h^=o>>>1,h=h*3981806797&O|h*36045&w,o=o*4283543511&O|((o<<16|h>>>16)*2950163797&O)>>>16,h^=o>>>1,h=h*444984403&O|h*60499&w,o=o*3301882366&O|((o<<16|h>>>16)*3120437893&O)>>>16,h^=o>>>1,(h>>>0).toString(16).padStart(8,"0")+(o>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var i=A(1),p=A(10);class O{constructor({onUnsupportedFeature:C,ownerDocument:h=globalThis.document,styleElement:o=null}){this._onUnsupportedFeature=C,this._document=h,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(C){this.nativeFontFaces.push(C),this._document.fonts.add(C)}insertRule(C){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const h=this.styleElement.sheet;h.insertRule(C,h.cssRules.length)}clear(){for(const C of this.nativeFontFaces)this._document.fonts.delete(C);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(C){if(C.attached||C.missingFile)return;if(C.attached=!0,this.isFontLoadingAPISupported){const o=C.createNativeFontFace();if(o){this.addNativeFontFace(o);try{await o.loaded}catch(c){throw this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,i.warn)(`Failed to load font '${o.family}': '${c}'.`),C.disableFontFace=!0,c}}return}const h=C.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(o=>{const c=this._queueLoadingCallback(o);this._prepareFontLoadEvent(C,c)})}}get isFontLoadingAPISupported(){const C=!!this._document?.fonts;return(0,i.shadow)(this,"isFontLoadingAPISupported",C)}get isSyncFontLoadingSupported(){let C=!1;return(p.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(C=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",C)}_queueLoadingCallback(C){function h(){for((0,i.assert)(!c.done,"completeRequest() cannot be called twice."),c.done=!0;o.length>0&&o[0].done;){const d=o.shift();setTimeout(d.callback,0)}}const{loadingRequests:o}=this,c={done:!1,complete:h,callback:C};return o.push(c),c}get _loadTestFont(){const C=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",C)}_prepareFontLoadEvent(C,h){function o(U,J){return U.charCodeAt(J)<<24|U.charCodeAt(J+1)<<16|U.charCodeAt(J+2)<<8|U.charCodeAt(J+3)&255}function c(U,J,rt,Q){const $=U.substring(0,J),N=U.substring(J+rt);return $+Q+N}let d,s;const u=this._document.createElement("canvas");u.width=1,u.height=1;const _=u.getContext("2d");let m=0;function g(U,J){if(++m>30){(0,i.warn)("Load test font never loaded."),J();return}if(_.font="30px "+U,_.fillText(".",0,20),_.getImageData(0,0,1,1).data[3]>0){J();return}setTimeout(g.bind(null,U,J))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=c(F,976,x.length,x);const r=16,f=1482184792;let T=o(F,r);for(d=0,s=x.length-3;d<s;d+=4)T=T-f+o(x,d)|0;d<x.length&&(T=T-f+o(x+"XXX",d)|0),F=c(F,r,4,(0,i.string32)(T));const j=`url(data:font/opentype;base64,${btoa(F)});`,L=`@font-face {font-family:"${x}";src:${j}}`;this.insertRule(L);const B=this._document.createElement("div");B.style.visibility="hidden",B.style.width=B.style.height="10px",B.style.position="absolute",B.style.top=B.style.left="0px";for(const U of[C.loadedName,x]){const J=this._document.createElement("span");J.textContent="Hi",J.style.fontFamily=U,B.append(J)}this._document.body.append(B),g(x,()=>{B.remove(),h.complete()})}}e.FontLoader=O;class w{constructor(C,{isEvalSupported:h=!0,disableFontFace:o=!1,ignoreErrors:c=!1,onUnsupportedFeature:d,fontRegistry:s=null}){this.compiledGlyphs=Object.create(null);for(const u in C)this[u]=C[u];this.isEvalSupported=h!==!1,this.disableFontFace=o===!0,this.ignoreErrors=c===!0,this._onUnsupportedFeature=d,this.fontRegistry=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let C;if(!this.cssFontInfo)C=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),C=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this.fontRegistry?.registerFont(this),C}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const C=(0,i.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(C)});`;let o;if(!this.cssFontInfo)o=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let c=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(c+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),o=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${c}src:${h}}`}return this.fontRegistry?.registerFont(this,h),o}getPathGenerator(C,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let o;try{o=C.get(this.loadedName+"_path_"+h)}catch(c){if(!this.ignoreErrors)throw c;return this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,i.warn)(`getPathGenerator - ignoring character: "${c}".`),this.compiledGlyphs[h]=function(d,s){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const c=[];for(const d of o){const s=d.args!==void 0?d.args.join(","):"";c.push("c.",d.cmd,"(",s,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",c.join(""))}return this.compiledGlyphs[h]=function(c,d){for(const s of o)s.cmd==="scale"&&(s.args=[d,-d]),c[s.cmd].apply(c,s.args)}}}e.FontFaceObject=w},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeJS=void 0;const A=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=A},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var i=A(1),p=A(6),O=A(12),w=A(13);const M=16,C=100,h=4096,o=15,c=10,d=1e3,s=16;function u(S,l){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){l.save(),this.__originalSave()},S.restore=function(){l.restore(),this.__originalRestore()},S.translate=function(y,R){l.translate(y,R),this.__originalTranslate(y,R)},S.scale=function(y,R){l.scale(y,R),this.__originalScale(y,R)},S.transform=function(y,R,k,t,a,b){l.transform(y,R,k,t,a,b),this.__originalTransform(y,R,k,t,a,b)},S.setTransform=function(y,R,k,t,a,b){l.setTransform(y,R,k,t,a,b),this.__originalSetTransform(y,R,k,t,a,b)},S.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},S.rotate=function(y){l.rotate(y),this.__originalRotate(y)},S.clip=function(y){l.clip(y),this.__originalClip(y)},S.moveTo=function(n,y){l.moveTo(n,y),this.__originalMoveTo(n,y)},S.lineTo=function(n,y){l.lineTo(n,y),this.__originalLineTo(n,y)},S.bezierCurveTo=function(n,y,R,k,t,a){l.bezierCurveTo(n,y,R,k,t,a),this.__originalBezierCurveTo(n,y,R,k,t,a)},S.rect=function(n,y,R,k){l.rect(n,y,R,k),this.__originalRect(n,y,R,k)},S.closePath=function(){l.closePath(),this.__originalClosePath()},S.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class _{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,n,y){let R;return this.cache[l]!==void 0?(R=this.cache[l],this.canvasFactory.reset(R,n,y)):(R=this.canvasFactory.create(n,y),this.cache[l]=R),R}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const n=this.cache[l];this.canvasFactory.destroy(n),delete this.cache[l]}}}function m(S,l,n,y,R,k,t,a,b,P){const[E,I,D,X,G,V]=(0,p.getCurrentTransform)(S);if(I===0&&D===0){const tt=t*E+G,st=Math.round(tt),nt=a*X+V,at=Math.round(nt),et=(t+b)*E+G,ct=Math.abs(Math.round(et)-st)||1,ft=(a+P)*X+V,ot=Math.abs(Math.round(ft)-at)||1;return S.setTransform(Math.sign(E),0,0,Math.sign(X),st,at),S.drawImage(l,n,y,R,k,0,0,ct,ot),S.setTransform(E,I,D,X,G,V),[ct,ot]}if(E===0&&X===0){const tt=a*D+G,st=Math.round(tt),nt=t*I+V,at=Math.round(nt),et=(a+P)*D+G,ct=Math.abs(Math.round(et)-st)||1,ft=(t+b)*I+V,ot=Math.abs(Math.round(ft)-at)||1;return S.setTransform(0,Math.sign(I),Math.sign(D),0,st,at),S.drawImage(l,n,y,R,k,0,0,ot,ct),S.setTransform(E,I,D,X,G,V),[ot,ct]}S.drawImage(l,n,y,R,k,t,a,b,P);const Z=Math.hypot(E,I),Y=Math.hypot(D,X);return[Z*b,Y*P]}function g(S){const{width:l,height:n}=S;if(l>d||n>d)return null;const y=1e3,R=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),k=l+1;let t=new Uint8Array(k*(n+1)),a,b,P;const E=l+7&-8;let I=new Uint8Array(E*n),D=0;for(const Y of S.data){let tt=128;for(;tt>0;)I[D++]=Y&tt?0:255,tt>>=1}let X=0;for(D=0,I[D]!==0&&(t[0]=1,++X),b=1;b<l;b++)I[D]!==I[D+1]&&(t[b]=I[D]?2:1,++X),D++;for(I[D]!==0&&(t[b]=2,++X),a=1;a<n;a++){D=a*E,P=a*k,I[D-E]!==I[D]&&(t[P]=I[D]?1:8,++X);let Y=(I[D]?4:0)+(I[D-E]?8:0);for(b=1;b<l;b++)Y=(Y>>2)+(I[D+1]?4:0)+(I[D-E+1]?8:0),R[Y]&&(t[P+b]=R[Y],++X),D++;if(I[D-E]!==I[D]&&(t[P+b]=I[D]?2:4,++X),X>y)return null}for(D=E*(n-1),P=a*k,I[D]!==0&&(t[P]=8,++X),b=1;b<l;b++)I[D]!==I[D+1]&&(t[P+b]=I[D]?4:8,++X),D++;if(I[D]!==0&&(t[P+b]=4,++X),X>y)return null;const G=new Int32Array([0,k,-1,0,-k,0,0,0,1]),V=new Path2D;for(a=0;X&&a<=n;a++){let Y=a*k;const tt=Y+l;for(;Y<tt&&!t[Y];)Y++;if(Y===tt)continue;V.moveTo(Y%k,a);const st=Y;let nt=t[Y];do{const at=G[nt];do Y+=at;while(!t[Y]);const et=t[Y];et!==5&&et!==10?(nt=et,t[Y]=0):(nt=et&51*nt>>4,t[Y]&=nt>>2|nt<<2),V.lineTo(Y%k,Y/k|0),t[Y]||--X}while(st!==Y);--a}return I=null,t=null,function(Y){Y.save(),Y.scale(1/l,-1/n),Y.translate(0,-n),Y.fill(V),Y.beginPath(),Y.restore()}}class x{constructor(l,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,l,n])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,n){this.x=l,this.y=n}updatePathMinMax(l,n,y){[n,y]=i.Util.applyTransform([n,y],l),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,y),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,y)}updateRectMinMax(l,n){const y=i.Util.applyTransform(n,l),R=i.Util.applyTransform(n.slice(2),l);this.minX=Math.min(this.minX,y[0],R[0]),this.minY=Math.min(this.minY,y[1],R[1]),this.maxX=Math.max(this.maxX,y[0],R[0]),this.maxY=Math.max(this.maxY,y[1],R[1])}updateScalingPathMinMax(l,n){i.Util.scaleMinMax(l,n),this.minX=Math.min(this.minX,n[0]),this.maxX=Math.max(this.maxX,n[1]),this.minY=Math.min(this.minY,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(l,n,y,R,k,t,a,b,P,E){const I=i.Util.bezierBoundingBox(n,y,R,k,t,a,b,P);if(E){E[0]=Math.min(E[0],I[0],I[2]),E[1]=Math.max(E[1],I[0],I[2]),E[2]=Math.min(E[2],I[1],I[3]),E[3]=Math.max(E[3],I[1],I[3]);return}this.updateRectMinMax(l,I)}getPathBoundingBox(l=O.PathType.FILL,n=null){const y=[this.minX,this.minY,this.maxX,this.maxY];if(l===O.PathType.STROKE){n||(0,i.unreachable)("Stroke bounding box must include transform.");const R=i.Util.singularValueDecompose2dScale(n),k=R[0]*this.lineWidth/2,t=R[1]*this.lineWidth/2;y[0]-=k,y[1]-=t,y[2]+=k,y[3]+=t}return y}updateClipFromPath(){const l=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=O.PathType.FILL,n=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(l,n))}}function F(S,l,n=null){if(typeof ImageData<"u"&&l instanceof ImageData){S.putImageData(l,0,0);return}const y=l.height,R=l.width,k=y%s,t=(y-k)/s,a=k===0?t:t+1,b=S.createImageData(R,s);let P=0,E;const I=l.data,D=b.data;let X,G,V,Z,Y,tt,st,nt;if(n)switch(n.length){case 1:Y=n[0],tt=n[0],st=n[0],nt=n[0];break;case 4:Y=n[0],tt=n[1],st=n[2],nt=n[3];break}if(l.kind===i.ImageKind.GRAYSCALE_1BPP){const at=I.byteLength,et=new Uint32Array(D.buffer,0,D.byteLength>>2),ct=et.length,ft=R+7>>3;let ot=4294967295,ht=i.FeatureTest.isLittleEndian?4278190080:255;for(nt&&nt[0]===255&&nt[255]===0&&([ot,ht]=[ht,ot]),X=0;X<a;X++){for(V=X<t?s:k,E=0,G=0;G<V;G++){const yt=at-P;let vt=0;const bt=yt>ft?R:yt*8-7,Ct=bt&-8;let gt=0,pt=0;for(;vt<Ct;vt+=8)pt=I[P++],et[E++]=pt&128?ot:ht,et[E++]=pt&64?ot:ht,et[E++]=pt&32?ot:ht,et[E++]=pt&16?ot:ht,et[E++]=pt&8?ot:ht,et[E++]=pt&4?ot:ht,et[E++]=pt&2?ot:ht,et[E++]=pt&1?ot:ht;for(;vt<bt;vt++)gt===0&&(pt=I[P++],gt=128),et[E++]=pt&gt?ot:ht,gt>>=1}for(;E<ct;)et[E++]=0;S.putImageData(b,0,X*s)}}else if(l.kind===i.ImageKind.RGBA_32BPP){const at=!!(Y||tt||st);for(G=0,Z=R*s*4,X=0;X<t;X++){if(D.set(I.subarray(P,P+Z)),P+=Z,at)for(let et=0;et<Z;et+=4)Y&&(D[et+0]=Y[D[et+0]]),tt&&(D[et+1]=tt[D[et+1]]),st&&(D[et+2]=st[D[et+2]]);S.putImageData(b,0,G),G+=s}if(X<a){if(Z=R*k*4,D.set(I.subarray(P,P+Z)),at)for(let et=0;et<Z;et+=4)Y&&(D[et+0]=Y[D[et+0]]),tt&&(D[et+1]=tt[D[et+1]]),st&&(D[et+2]=st[D[et+2]]);S.putImageData(b,0,G)}}else if(l.kind===i.ImageKind.RGB_24BPP){const at=!!(Y||tt||st);for(V=s,Z=R*V,X=0;X<a;X++){for(X>=t&&(V=k,Z=R*V),E=0,G=Z;G--;)D[E++]=I[P++],D[E++]=I[P++],D[E++]=I[P++],D[E++]=255;if(at)for(let et=0;et<E;et+=4)Y&&(D[et+0]=Y[D[et+0]]),tt&&(D[et+1]=tt[D[et+1]]),st&&(D[et+2]=st[D[et+2]]);S.putImageData(b,0,X*s)}}else throw new Error(`bad image kind: ${l.kind}`)}function v(S,l){if(l.bitmap){S.drawImage(l.bitmap,0,0);return}const n=l.height,y=l.width,R=n%s,k=(n-R)/s,t=R===0?k:k+1,a=S.createImageData(y,s);let b=0;const P=l.data,E=a.data;for(let I=0;I<t;I++){const D=I<k?s:R;({srcPos:b}=(0,w.applyMaskImageData)({src:P,srcPos:b,dest:E,width:y,height:D})),S.putImageData(a,0,I*s)}}function r(S,l){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const y of n)S[y]!==void 0&&(l[y]=S[y]);S.setLineDash!==void 0&&(l.setLineDash(S.getLineDash()),l.lineDashOffset=S.lineDashOffset)}function f(S,l){S.strokeStyle=S.fillStyle=l||"#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0)}function T(S,l,n,y){const R=S.length;for(let k=3;k<R;k+=4){const t=S[k];if(t===0)S[k-3]=l,S[k-2]=n,S[k-1]=y;else if(t<255){const a=255-t;S[k-3]=S[k-3]*t+l*a>>8,S[k-2]=S[k-2]*t+n*a>>8,S[k-1]=S[k-1]*t+y*a>>8}}}function j(S,l,n){const y=S.length,R=1/255;for(let k=3;k<y;k+=4){const t=n?n[S[k]]:S[k];l[k]=l[k]*t*R|0}}function L(S,l,n){const y=S.length;for(let R=3;R<y;R+=4){const k=S[R-3]*77+S[R-2]*152+S[R-1]*28;l[R]=n?l[R]*n[k>>8]>>8:l[R]*k>>16}}function B(S,l,n,y,R,k,t,a,b,P,E){const I=!!k,D=I?k[0]:0,X=I?k[1]:0,G=I?k[2]:0;let V;R==="Luminosity"?V=L:V=j;const Y=Math.min(y,Math.ceil(1048576/n));for(let tt=0;tt<y;tt+=Y){const st=Math.min(Y,y-tt),nt=S.getImageData(a-P,tt+(b-E),n,st),at=l.getImageData(a,tt+b,n,st);I&&T(nt.data,D,X,G),V(nt.data,at.data,t),l.putImageData(at,a,tt+b)}}function U(S,l,n,y){const R=y[0],k=y[1],t=y[2]-R,a=y[3]-k;t===0||a===0||(B(l.context,n,t,a,l.subtype,l.backdrop,l.transferMap,R,k,l.offsetX,l.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(n.canvas,0,0),S.restore())}function J(S,l){const n=i.Util.singularValueDecompose2dScale(S);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const y=Math.fround((globalThis.devicePixelRatio||1)*p.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:n[0]<=y||n[1]<=y}const rt=["butt","round","square"],Q=["miter","round","bevel"],$={},N={};class q{constructor(l,n,y,R,{optionalContentConfig:k,markedContentStack:t=null},a,b){this.ctx=l,this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=y,this.canvasFactory=R,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=t||[],this.optionalContentConfig=k,this.cachedCanvases=new _(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=b?.background||null,this.foregroundColor=b?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,n=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):n}beginDrawing({transform:l,viewport:n,transparency:y=!1,background:R=null}){const k=this.ctx.canvas.width,t=this.ctx.canvas.height,a=R||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const b=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const P=this.backgroundColor=this.ctx.fillStyle;let E=!0,I=a;if(this.ctx.fillStyle=a,I=this.ctx.fillStyle,E=typeof I=="string"&&/^#[0-9A-Fa-f]{6}$/.test(I),b==="#000000"&&P==="#ffffff"||b===P||!E)this.foregroundColor=this.backgroundColor=null;else{const[D,X,G]=(0,p.getRGB)(I),V=Y=>(Y/=255,Y<=.03928?Y/12.92:((Y+.055)/1.055)**2.4),Z=Math.round(.2126*V(D)+.7152*V(X)+.0722*V(G));this.selectColor=(Y,tt,st)=>{const nt=.2126*V(Y)+.7152*V(tt)+.0722*V(st);return Math.round(nt)===Z?P:b}}}if(this.ctx.fillStyle=this.backgroundColor||a,this.ctx.fillRect(0,0,k,t),this.ctx.restore(),y){const b=this.cachedCanvases.getCanvas("transparent",k,t);this.compositeCtx=this.ctx,this.transparentCanvas=b.canvas,this.ctx=b.context,this.ctx.save(),this.ctx.transform(...(0,p.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),f(this.ctx,this.foregroundColor),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,p.getCurrentTransform)(this.ctx)}executeOperatorList(l,n,y,R){const k=l.argsArray,t=l.fnArray;let a=n||0;const b=k.length;if(b===a)return a;const P=b-a>c&&typeof y=="function",E=P?Date.now()+o:0;let I=0;const D=this.commonObjs,X=this.objs;let G;for(;;){if(R!==void 0&&a===R.nextBreakPoint)return R.breakIt(a,y),a;if(G=t[a],G!==i.OPS.dependency)this[G].apply(this,k[a]);else for(const V of k[a]){const Z=V.startsWith("g_")?D:X;if(!Z.has(V))return Z.get(V,y),a}if(a++,a===b)return a;if(P&&++I>c){if(Date.now()>E)return y(),a;I=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const l of this._cachedBitmapsMap.values()){for(const n of l.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);l.clear()}this._cachedBitmapsMap.clear()}_scaleImage(l,n){const y=l.width,R=l.height;let k=Math.max(Math.hypot(n[0],n[1]),1),t=Math.max(Math.hypot(n[2],n[3]),1),a=y,b=R,P="prescale1",E,I;for(;k>2&&a>1||t>2&&b>1;){let D=a,X=b;k>2&&a>1&&(D=Math.ceil(a/2),k/=a/D),t>2&&b>1&&(X=Math.ceil(b/2),t/=b/X),E=this.cachedCanvases.getCanvas(P,D,X),I=E.context,I.clearRect(0,0,D,X),I.drawImage(l,0,0,a,b,0,0,D,X),l=E.canvas,a=D,b=X,P=P==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:a,paintHeight:b}}_createMaskCanvas(l){const n=this.ctx,{width:y,height:R}=l,k=this.current.fillColor,t=this.current.patternFill,a=(0,p.getCurrentTransform)(n);let b,P,E,I;if((l.bitmap||l.data)&&l.count>1){const ct=l.bitmap||l.data.buffer;P=JSON.stringify(t?a:[a.slice(0,4),k]),b=this._cachedBitmapsMap.get(ct),b||(b=new Map,this._cachedBitmapsMap.set(ct,b));const ft=b.get(P);if(ft&&!t){const ot=Math.round(Math.min(a[0],a[2])+a[4]),ht=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:ft,offsetX:ot,offsetY:ht}}E=ft}E||(I=this.cachedCanvases.getCanvas("maskCanvas",y,R),v(I.context,l));let D=i.Util.transform(a,[1/y,0,0,-1/R,0,0]);D=i.Util.transform(D,[1,0,0,1,0,-R]);const X=i.Util.applyTransform([0,0],D),G=i.Util.applyTransform([y,R],D),V=i.Util.normalizeRect([X[0],X[1],G[0],G[1]]),Z=Math.round(V[2]-V[0])||1,Y=Math.round(V[3]-V[1])||1,tt=this.cachedCanvases.getCanvas("fillCanvas",Z,Y),st=tt.context,nt=Math.min(X[0],G[0]),at=Math.min(X[1],G[1]);st.translate(-nt,-at),st.transform(...D),E||(E=this._scaleImage(I.canvas,(0,p.getCurrentTransformInverse)(st)),E=E.img,b&&t&&b.set(P,E)),st.imageSmoothingEnabled=J((0,p.getCurrentTransform)(st),l.interpolate),m(st,E,0,0,E.width,E.height,0,0,y,R),st.globalCompositeOperation="source-in";const et=i.Util.transform((0,p.getCurrentTransformInverse)(st),[1,0,0,1,-nt,-at]);return st.fillStyle=t?k.getPattern(n,this,et,O.PathType.FILL):k,st.fillRect(0,0,y,R),b&&!t&&(this.cachedCanvases.delete("fillCanvas"),b.set(P,tt.canvas)),{canvas:tt.canvas,offsetX:Math.round(nt),offsetY:Math.round(at)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=rt[l]}setLineJoin(l){this.ctx.lineJoin=Q[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,n){const y=this.ctx;y.setLineDash!==void 0&&(y.setLineDash(l),y.lineDashOffset=n)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[n,y]of l)switch(n){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y[0],y[1]);break;case"CA":this.current.strokeAlpha=y;break;case"ca":this.current.fillAlpha=y,this.ctx.globalAlpha=y;break;case"BM":this.ctx.globalCompositeOperation=y;break;case"SMask":this.current.activeSMask=y?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=y}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,n=this.ctx.canvas.height,y="smaskGroupAt"+this.groupLevel,R=this.cachedCanvases.getCanvas(y,l,n);this.suspendedCtx=this.ctx,this.ctx=R.context;const k=this.ctx;k.setTransform(...(0,p.getCurrentTransform)(this.suspendedCtx)),r(this.suspendedCtx,k),u(k,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),r(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,y=this.suspendedCtx;U(y,n,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(r(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),r(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(l,n,y,R,k,t){this.ctx.transform(l,n,y,R,k,t),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(l,n,y){const R=this.ctx,k=this.current;let t=k.x,a=k.y,b,P;const E=(0,p.getCurrentTransform)(R),I=E[0]===0&&E[3]===0||E[1]===0&&E[2]===0,D=I?y.slice(0):null;for(let X=0,G=0,V=l.length;X<V;X++)switch(l[X]|0){case i.OPS.rectangle:t=n[G++],a=n[G++];const Z=n[G++],Y=n[G++],tt=t+Z,st=a+Y;R.moveTo(t,a),Z===0||Y===0?R.lineTo(tt,st):(R.lineTo(tt,a),R.lineTo(tt,st),R.lineTo(t,st)),I||k.updateRectMinMax(E,[t,a,tt,st]),R.closePath();break;case i.OPS.moveTo:t=n[G++],a=n[G++],R.moveTo(t,a),I||k.updatePathMinMax(E,t,a);break;case i.OPS.lineTo:t=n[G++],a=n[G++],R.lineTo(t,a),I||k.updatePathMinMax(E,t,a);break;case i.OPS.curveTo:b=t,P=a,t=n[G+4],a=n[G+5],R.bezierCurveTo(n[G],n[G+1],n[G+2],n[G+3],t,a),k.updateCurvePathMinMax(E,b,P,n[G],n[G+1],n[G+2],n[G+3],t,a,D),G+=6;break;case i.OPS.curveTo2:b=t,P=a,R.bezierCurveTo(t,a,n[G],n[G+1],n[G+2],n[G+3]),k.updateCurvePathMinMax(E,b,P,t,a,n[G],n[G+1],n[G+2],n[G+3],D),t=n[G+2],a=n[G+3],G+=4;break;case i.OPS.curveTo3:b=t,P=a,t=n[G+2],a=n[G+3],R.bezierCurveTo(n[G],n[G+1],t,a,t,a),k.updateCurvePathMinMax(E,b,P,n[G],n[G+1],t,a,t,a,D),G+=4;break;case i.OPS.closePath:R.closePath();break}I&&k.updateScalingPathMinMax(E,D),k.setCurrentPoint(t,a)}closePath(){this.ctx.closePath()}stroke(l=!0){const n=this.ctx,y=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof y=="object"&&y?.getPattern?(n.save(),n.strokeStyle=y.getPattern(n,this,(0,p.getCurrentTransformInverse)(n),O.PathType.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const n=this.ctx,y=this.current.fillColor,R=this.current.patternFill;let k=!1;R&&(n.save(),n.fillStyle=y.getPattern(n,this,(0,p.getCurrentTransformInverse)(n),O.PathType.FILL),k=!0);const t=this.current.getClippedPathBoundingBox();this.contentVisible&&t!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),k&&n.restore(),l&&this.consumePath(t)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$}eoClip(){this.pendingClip=N}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,n=this.ctx;if(l===void 0){n.beginPath();return}n.save(),n.beginPath();for(const y of l)n.setTransform(...y.transform),n.translate(y.x,y.y),y.addToPath(n,y.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,n){const y=this.commonObjs.get(l),R=this.current;if(!y)throw new Error(`Can't find font for ${l}`);if(R.fontMatrix=y.fontMatrix||i.FONT_IDENTITY_MATRIX,(R.fontMatrix[0]===0||R.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+l),n<0?(n=-n,R.fontDirection=-1):R.fontDirection=1,this.current.font=y,this.current.fontSize=n,y.isType3Font)return;const k=y.loadedName||"sans-serif";let t="normal";y.black?t="900":y.bold&&(t="bold");const a=y.italic?"italic":"normal",b=`"${k}", ${y.fallbackName}`;let P=n;n<M?P=M:n>C&&(P=C),this.current.fontSizeScale=n/P,this.ctx.font=`${a} ${t} ${P}px ${b}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,n){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=n}setLeadingMoveText(l,n){this.setLeading(-n),this.moveText(l,n)}setTextMatrix(l,n,y,R,k,t){this.current.textMatrix=[l,n,y,R,k,t],this.current.textMatrixScale=Math.hypot(l,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,n,y,R){const k=this.ctx,t=this.current,a=t.font,b=t.textRenderingMode,P=t.fontSize/t.fontSizeScale,E=b&i.TextRenderingMode.FILL_STROKE_MASK,I=!!(b&i.TextRenderingMode.ADD_TO_PATH_FLAG),D=t.patternFill&&!a.missingFile;let X;(a.disableFontFace||I||D)&&(X=a.getPathGenerator(this.commonObjs,l)),a.disableFontFace||D?(k.save(),k.translate(n,y),k.beginPath(),X(k,P),R&&k.setTransform(...R),(E===i.TextRenderingMode.FILL||E===i.TextRenderingMode.FILL_STROKE)&&k.fill(),(E===i.TextRenderingMode.STROKE||E===i.TextRenderingMode.FILL_STROKE)&&k.stroke(),k.restore()):((E===i.TextRenderingMode.FILL||E===i.TextRenderingMode.FILL_STROKE)&&k.fillText(l,n,y),(E===i.TextRenderingMode.STROKE||E===i.TextRenderingMode.FILL_STROKE)&&k.strokeText(l,n,y)),I&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,p.getCurrentTransform)(k),x:n,y,fontSize:P,addToPath:X})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const n=l.getImageData(0,0,10,10).data;let y=!1;for(let R=3;R<n.length;R+=4)if(n[R]>0&&n[R]<255){y=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",y)}showText(l){const n=this.current,y=n.font;if(y.isType3Font)return this.showType3Text(l);const R=n.fontSize;if(R===0)return;const k=this.ctx,t=n.fontSizeScale,a=n.charSpacing,b=n.wordSpacing,P=n.fontDirection,E=n.textHScale*P,I=l.length,D=y.vertical,X=D?1:-1,G=y.defaultVMetrics,V=R*n.fontMatrix[0],Z=n.textRenderingMode===i.TextRenderingMode.FILL&&!y.disableFontFace&&!n.patternFill;k.save(),k.transform(...n.textMatrix),k.translate(n.x,n.y+n.textRise),P>0?k.scale(E,-1):k.scale(E,1);let Y;if(n.patternFill){k.save();const et=n.fillColor.getPattern(k,this,(0,p.getCurrentTransformInverse)(k),O.PathType.FILL);Y=(0,p.getCurrentTransform)(k),k.restore(),k.fillStyle=et}let tt=n.lineWidth;const st=n.textMatrixScale;if(st===0||tt===0){const et=n.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(et===i.TextRenderingMode.STROKE||et===i.TextRenderingMode.FILL_STROKE)&&(tt=this.getSinglePixelWidth())}else tt/=st;if(t!==1&&(k.scale(t,t),tt/=t),k.lineWidth=tt,y.isInvalidPDFjsFont){const et=[];let ct=0;for(const ft of l)et.push(ft.unicode),ct+=ft.width;k.fillText(et.join(""),0,0),n.x+=ct*V*E,k.restore(),this.compose();return}let nt=0,at;for(at=0;at<I;++at){const et=l[at];if(typeof et=="number"){nt+=X*et*R/1e3;continue}let ct=!1;const ft=(et.isSpace?b:0)+a,ot=et.fontChar,ht=et.accent;let yt,vt,bt=et.width;if(D){const gt=et.vmetric||G,pt=-(et.vmetric?gt[1]:bt*.5)*V,Dt=gt[2]*V;bt=gt?-gt[0]:bt,yt=pt/t,vt=(nt+Dt)/t}else yt=nt/t,vt=0;if(y.remeasure&&bt>0){const gt=k.measureText(ot).width*1e3/R*t;if(bt<gt&&this.isFontSubpixelAAEnabled){const pt=bt/gt;ct=!0,k.save(),k.scale(pt,1),yt/=pt}else bt!==gt&&(yt+=(bt-gt)/2e3*R/t)}if(this.contentVisible&&(et.isInFont||y.missingFile)){if(Z&&!ht)k.fillText(ot,yt,vt);else if(this.paintChar(ot,yt,vt,Y),ht){const gt=yt+R*ht.offset.x/t,pt=vt-R*ht.offset.y/t;this.paintChar(ht.fontChar,gt,pt,Y)}}let Ct;D?Ct=bt*V-ft*P:Ct=bt*V+ft*P,nt+=Ct,ct&&k.restore()}D?n.y-=nt:n.x+=nt*E,k.restore(),this.compose()}showType3Text(l){const n=this.ctx,y=this.current,R=y.font,k=y.fontSize,t=y.fontDirection,a=R.vertical?1:-1,b=y.charSpacing,P=y.wordSpacing,E=y.textHScale*t,I=y.fontMatrix||i.FONT_IDENTITY_MATRIX,D=l.length,X=y.textRenderingMode===i.TextRenderingMode.INVISIBLE;let G,V,Z,Y;if(!(X||k===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...y.textMatrix),n.translate(y.x,y.y),n.scale(E,t),G=0;G<D;++G){if(V=l[G],typeof V=="number"){Y=a*V*k/1e3,this.ctx.translate(Y,0),y.x+=Y*E;continue}const tt=(V.isSpace?P:0)+b,st=R.charProcOperatorList[V.operatorListId];if(!st){(0,i.warn)(`Type3 character "${V.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=V,this.save(),n.scale(k,k),n.transform(...I),this.executeOperatorList(st),this.restore()),Z=i.Util.applyTransform([V.width,0],I)[0]*k+tt,n.translate(Z,0),y.x+=Z*E}n.restore(),this.processingType3=null}}setCharWidth(l,n){}setCharWidthAndBounds(l,n,y,R,k,t){this.ctx.rect(y,R,k-y,t-R),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let n;if(l[0]==="TilingPattern"){const y=l[1],R=this.baseTransform||(0,p.getCurrentTransform)(this.ctx),k={createCanvasGraphics:t=>new q(t,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new O.TilingPattern(l,y,this.ctx,k,R)}else n=this._getPattern(l[1],l[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,n,y){const R=this.selectColor?.(l,n,y)||i.Util.makeHexColor(l,n,y);this.ctx.strokeStyle=R,this.current.strokeColor=R}setFillRGBColor(l,n,y){const R=this.selectColor?.(l,n,y)||i.Util.makeHexColor(l,n,y);this.ctx.fillStyle=R,this.current.fillColor=R,this.current.patternFill=!1}_getPattern(l,n=null){let y;return this.cachedPatterns.has(l)?y=this.cachedPatterns.get(l):(y=(0,O.getShadingPattern)(this.objs.get(l)),this.cachedPatterns.set(l,y)),n&&(y.matrix=n),y}shadingFill(l){if(!this.contentVisible)return;const n=this.ctx;this.save();const y=this._getPattern(l);n.fillStyle=y.getPattern(n,this,(0,p.getCurrentTransformInverse)(n),O.PathType.SHADING);const R=(0,p.getCurrentTransformInverse)(n);if(R){const k=n.canvas,t=k.width,a=k.height,b=i.Util.applyTransform([0,0],R),P=i.Util.applyTransform([0,a],R),E=i.Util.applyTransform([t,0],R),I=i.Util.applyTransform([t,a],R),D=Math.min(b[0],P[0],E[0],I[0]),X=Math.min(b[1],P[1],E[1],I[1]),G=Math.max(b[0],P[0],E[0],I[0]),V=Math.max(b[1],P[1],E[1],I[1]);this.ctx.fillRect(D,X,G-D,V-X)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,p.getCurrentTransform)(this.ctx),n)){const y=n[2]-n[0],R=n[3]-n[1];this.ctx.rect(n[0],n[1],y,R),this.current.updateRectMinMax((0,p.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;l.isolated||(0,i.info)("TODO: Support non-isolated groups."),l.knockout&&(0,i.warn)("Knockout groups not supported.");const y=(0,p.getCurrentTransform)(n);if(l.matrix&&n.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let R=i.Util.getAxialAlignedBoundingBox(l.bbox,(0,p.getCurrentTransform)(n));const k=[0,0,n.canvas.width,n.canvas.height];R=i.Util.intersect(R,k)||[0,0,0,0];const t=Math.floor(R[0]),a=Math.floor(R[1]);let b=Math.max(Math.ceil(R[2])-t,1),P=Math.max(Math.ceil(R[3])-a,1),E=1,I=1;b>h&&(E=b/h,b=h),P>h&&(I=P/h,P=h),this.current.startNewPathAndClipBox([0,0,b,P]);let D="groupAt"+this.groupLevel;l.smask&&(D+="_smask_"+this.smaskCounter++%2);const X=this.cachedCanvases.getCanvas(D,b,P),G=X.context;G.scale(1/E,1/I),G.translate(-t,-a),G.transform(...y),l.smask?this.smaskStack.push({canvas:X.canvas,context:G,offsetX:t,offsetY:a,scaleX:E,scaleY:I,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(t,a),n.scale(E,I),n.save()),r(n,G),this.ctx=G,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,y=this.groupStack.pop();if(this.ctx=y,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const R=(0,p.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...R);const k=i.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],R);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(k)}}beginAnnotation(l,n,y,R,k){if(this.#t(),f(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const t=n[2]-n[0],a=n[3]-n[1];if(k&&this.annotationCanvasMap){y=y.slice(),y[4]-=n[0],y[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=t,n[3]=a;const[b,P]=i.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(this.ctx)),{viewportScale:E}=this,I=Math.ceil(t*this.outputScaleX*E),D=Math.ceil(a*this.outputScaleY*E);this.annotationCanvas=this.canvasFactory.create(I,D);const{canvas:X,context:G}=this.annotationCanvas;this.annotationCanvasMap.set(l,X),this.annotationCanvas.savedCtx=this.ctx,this.ctx=G,this.ctx.setTransform(b,0,0,-P,0,a*P),f(this.ctx,this.foregroundColor)}else f(this.ctx,this.foregroundColor),this.ctx.rect(n[0],n[1],t,a),this.ctx.clip(),this.endPath()}this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...y),this.transform(...R)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const n=l.count;l=this.getObject(l.data,l),l.count=n;const y=this.ctx,R=this.processingType3;if(R&&(R.compiled===void 0&&(R.compiled=g(l)),R.compiled)){R.compiled(y);return}const k=this._createMaskCanvas(l),t=k.canvas;y.save(),y.setTransform(1,0,0,1,0,0),y.drawImage(t,k.offsetX,k.offsetY),y.restore(),this.compose()}paintImageMaskXObjectRepeat(l,n,y=0,R=0,k,t){if(!this.contentVisible)return;l=this.getObject(l.data,l);const a=this.ctx;a.save();const b=(0,p.getCurrentTransform)(a);a.transform(n,y,R,k,0,0);const P=this._createMaskCanvas(l);a.setTransform(1,0,0,1,P.offsetX-b[4],P.offsetY-b[5]);for(let E=0,I=t.length;E<I;E+=2){const D=i.Util.transform(b,[n,y,R,k,t[E],t[E+1]]),[X,G]=i.Util.applyTransform([0,0],D);a.drawImage(P.canvas,X,G)}a.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const n=this.ctx,y=this.current.fillColor,R=this.current.patternFill;for(const k of l){const{data:t,width:a,height:b,transform:P}=k,E=this.cachedCanvases.getCanvas("maskCanvas",a,b),I=E.context;I.save();const D=this.getObject(t,k);v(I,D),I.globalCompositeOperation="source-in",I.fillStyle=R?y.getPattern(I,this,(0,p.getCurrentTransformInverse)(n),O.PathType.FILL):y,I.fillRect(0,0,a,b),I.restore(),n.save(),n.transform(...P),n.scale(1,-1),m(n,E.canvas,0,0,a,b,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const n=this.getObject(l);if(!n){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(l,n,y,R){if(!this.contentVisible)return;const k=this.getObject(l);if(!k){(0,i.warn)("Dependent image isn't ready yet");return}const t=k.width,a=k.height,b=[];for(let P=0,E=R.length;P<E;P+=2)b.push({transform:[n,0,0,y,R[P],R[P+1]],x:0,y:0,w:t,h:a});this.paintInlineImageXObjectGroup(k,b)}paintInlineImageXObject(l){if(!this.contentVisible)return;const n=l.width,y=l.height,R=this.ctx;this.save(),R.scale(1/n,-1/y);let k;if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)k=l;else{const a=this.cachedCanvases.getCanvas("inlineImage",n,y),b=a.context;F(b,l,this.current.transferMaps),k=a.canvas}const t=this._scaleImage(k,(0,p.getCurrentTransformInverse)(R));R.imageSmoothingEnabled=J((0,p.getCurrentTransform)(R),l.interpolate),m(R,t.img,0,0,t.paintWidth,t.paintHeight,0,-y,n,y),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,n){if(!this.contentVisible)return;const y=this.ctx,R=l.width,k=l.height,t=this.cachedCanvases.getCanvas("inlineImage",R,k),a=t.context;F(a,l,this.current.transferMaps);for(const b of n)y.save(),y.transform(...b.transform),y.scale(1,-1),m(y,t.canvas,b.x,b.y,b.w,b.h,0,-1,1,1),y.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,n){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,n){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const y=this.ctx;this.pendingClip&&(n||(this.pendingClip===N?y.clip("evenodd"):y.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),y.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,p.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const n=Math.abs(l[0]*l[3]-l[2]*l[1]),y=Math.hypot(l[0],l[2]),R=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(y,R)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:l}=this.current,n=(0,p.getCurrentTransform)(this.ctx);let y,R;if(n[1]===0&&n[2]===0){const k=Math.abs(n[0]),t=Math.abs(n[3]);if(l===0)y=1/k,R=1/t;else{const a=k*l,b=t*l;y=a<1?1/a:1,R=b<1?1/b:1}}else{const k=Math.abs(n[0]*n[3]-n[2]*n[1]),t=Math.hypot(n[0],n[1]),a=Math.hypot(n[2],n[3]);if(l===0)y=a/k,R=t/k;else{const b=l*k;y=a>b?a/b:1,R=t>b?t/b:1}}this._cachedScaleForStroking=[y,R]}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:n}=this,{lineWidth:y}=this.current,[R,k]=this.getScaleForStroking();if(n.lineWidth=y||1,R===1&&k===1){n.stroke();return}let t,a,b;l&&(t=(0,p.getCurrentTransform)(n),a=n.getLineDash().slice(),b=n.lineDashOffset),n.scale(R,k);const P=Math.max(R,k);n.setLineDash(n.getLineDash().map(E=>E/P)),n.lineDashOffset/=P,n.stroke(),l&&(n.setTransform(...t),n.setLineDash(a),n.lineDashOffset=b)}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}}e.CanvasGraphics=q;for(const S in i.OPS)q.prototype[S]!==void 0&&(q.prototype[i.OPS[S]]=q.prototype[S])},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=s;var i=A(1),p=A(6);const O={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=O;function w(m,g){if(!g)return;const x=g[2]-g[0],F=g[3]-g[1],v=new Path2D;v.rect(g[0],g[1],x,F),m.clip(v)}class M{constructor(){this.constructor===M&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class C extends M{constructor(g){super(),this._type=g[1],this._bbox=g[2],this._colorStops=g[3],this._p0=g[4],this._p1=g[5],this._r0=g[6],this._r1=g[7],this.matrix=null}_createGradient(g){let x;this._type==="axial"?x=g.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(x=g.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const F of this._colorStops)x.addColorStop(F[0],F[1]);return x}getPattern(g,x,F,v){let r;if(v===O.STROKE||v===O.FILL){const f=x.current.getClippedPathBoundingBox(v,(0,p.getCurrentTransform)(g))||[0,0,0,0],T=Math.ceil(f[2]-f[0])||1,j=Math.ceil(f[3]-f[1])||1,L=x.cachedCanvases.getCanvas("pattern",T,j,!0),B=L.context;B.clearRect(0,0,B.canvas.width,B.canvas.height),B.beginPath(),B.rect(0,0,B.canvas.width,B.canvas.height),B.translate(-f[0],-f[1]),F=i.Util.transform(F,[1,0,0,1,f[0],f[1]]),B.transform(...x.baseTransform),this.matrix&&B.transform(...this.matrix),w(B,this._bbox),B.fillStyle=this._createGradient(B),B.fill(),r=g.createPattern(L.canvas,"no-repeat");const U=new DOMMatrix(F);r.setTransform(U)}else w(g,this._bbox),r=this._createGradient(g);return r}}function h(m,g,x,F,v,r,f,T){const j=g.coords,L=g.colors,B=m.data,U=m.width*4;let J;j[x+1]>j[F+1]&&(J=x,x=F,F=J,J=r,r=f,f=J),j[F+1]>j[v+1]&&(J=F,F=v,v=J,J=f,f=T,T=J),j[x+1]>j[F+1]&&(J=x,x=F,F=J,J=r,r=f,f=J);const rt=(j[x]+g.offsetX)*g.scaleX,Q=(j[x+1]+g.offsetY)*g.scaleY,$=(j[F]+g.offsetX)*g.scaleX,N=(j[F+1]+g.offsetY)*g.scaleY,q=(j[v]+g.offsetX)*g.scaleX,S=(j[v+1]+g.offsetY)*g.scaleY;if(Q>=S)return;const l=L[r],n=L[r+1],y=L[r+2],R=L[f],k=L[f+1],t=L[f+2],a=L[T],b=L[T+1],P=L[T+2],E=Math.round(Q),I=Math.round(S);let D,X,G,V,Z,Y,tt,st;for(let nt=E;nt<=I;nt++){if(nt<N){let ot;nt<Q?ot=0:ot=(Q-nt)/(Q-N),D=rt-(rt-$)*ot,X=l-(l-R)*ot,G=n-(n-k)*ot,V=y-(y-t)*ot}else{let ot;nt>S?ot=1:N===S?ot=0:ot=(N-nt)/(N-S),D=$-($-q)*ot,X=R-(R-a)*ot,G=k-(k-b)*ot,V=t-(t-P)*ot}let at;nt<Q?at=0:nt>S?at=1:at=(Q-nt)/(Q-S),Z=rt-(rt-q)*at,Y=l-(l-a)*at,tt=n-(n-b)*at,st=y-(y-P)*at;const et=Math.round(Math.min(D,Z)),ct=Math.round(Math.max(D,Z));let ft=U*nt+et*4;for(let ot=et;ot<=ct;ot++)at=(D-ot)/(D-Z),at<0?at=0:at>1&&(at=1),B[ft++]=X-(X-Y)*at|0,B[ft++]=G-(G-tt)*at|0,B[ft++]=V-(V-st)*at|0,B[ft++]=255}}function o(m,g,x){const F=g.coords,v=g.colors;let r,f;switch(g.type){case"lattice":const T=g.verticesPerRow,j=Math.floor(F.length/T)-1,L=T-1;for(r=0;r<j;r++){let B=r*T;for(let U=0;U<L;U++,B++)h(m,x,F[B],F[B+1],F[B+T],v[B],v[B+1],v[B+T]),h(m,x,F[B+T+1],F[B+1],F[B+T],v[B+T+1],v[B+1],v[B+T])}break;case"triangles":for(r=0,f=F.length;r<f;r+=3)h(m,x,F[r],F[r+1],F[r+2],v[r],v[r+1],v[r+2]);break;default:throw new Error("illegal figure")}}class c extends M{constructor(g){super(),this._coords=g[2],this._colors=g[3],this._figures=g[4],this._bounds=g[5],this._bbox=g[7],this._background=g[8],this.matrix=null}_createMeshCanvas(g,x,F){const T=Math.floor(this._bounds[0]),j=Math.floor(this._bounds[1]),L=Math.ceil(this._bounds[2])-T,B=Math.ceil(this._bounds[3])-j,U=Math.min(Math.ceil(Math.abs(L*g[0]*1.1)),3e3),J=Math.min(Math.ceil(Math.abs(B*g[1]*1.1)),3e3),rt=L/U,Q=B/J,$={coords:this._coords,colors:this._colors,offsetX:-T,offsetY:-j,scaleX:1/rt,scaleY:1/Q},N=U+2*2,q=J+2*2,S=F.getCanvas("mesh",N,q,!1),l=S.context,n=l.createImageData(U,J);if(x){const R=n.data;for(let k=0,t=R.length;k<t;k+=4)R[k]=x[0],R[k+1]=x[1],R[k+2]=x[2],R[k+3]=255}for(const R of this._figures)o(n,R,$);return l.putImageData(n,2,2),{canvas:S.canvas,offsetX:T-2*rt,offsetY:j-2*Q,scaleX:rt,scaleY:Q}}getPattern(g,x,F,v){w(g,this._bbox);let r;if(v===O.SHADING)r=i.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(g));else if(r=i.Util.singularValueDecompose2dScale(x.baseTransform),this.matrix){const T=i.Util.singularValueDecompose2dScale(this.matrix);r=[r[0]*T[0],r[1]*T[1]]}const f=this._createMeshCanvas(r,v===O.SHADING?null:this._background,x.cachedCanvases);return v!==O.SHADING&&(g.setTransform(...x.baseTransform),this.matrix&&g.transform(...this.matrix)),g.translate(f.offsetX,f.offsetY),g.scale(f.scaleX,f.scaleY),g.createPattern(f.canvas,"no-repeat")}}class d extends M{getPattern(){return"hotpink"}}function s(m){switch(m[0]){case"RadialAxial":return new C(m);case"Mesh":return new c(m);case"Dummy":return new d}throw new Error(`Unknown IR type: ${m[0]}`)}const u={COLORED:1,UNCOLORED:2};class _{static get MAX_PATTERN_SIZE(){return(0,i.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(g,x,F,v,r){this.operatorList=g[2],this.matrix=g[3]||[1,0,0,1,0,0],this.bbox=g[4],this.xstep=g[5],this.ystep=g[6],this.paintType=g[7],this.tilingType=g[8],this.color=x,this.ctx=F,this.canvasGraphicsFactory=v,this.baseTransform=r}createPatternCanvas(g){const x=this.operatorList,F=this.bbox,v=this.xstep,r=this.ystep,f=this.paintType,T=this.tilingType,j=this.color,L=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+T);const B=F[0],U=F[1],J=F[2],rt=F[3],Q=i.Util.singularValueDecompose2dScale(this.matrix),$=i.Util.singularValueDecompose2dScale(this.baseTransform),N=[Q[0]*$[0],Q[1]*$[1]],q=this.getSizeAndScale(v,this.ctx.canvas.width,N[0]),S=this.getSizeAndScale(r,this.ctx.canvas.height,N[1]),l=g.cachedCanvases.getCanvas("pattern",q.size,S.size,!0),n=l.context,y=L.createCanvasGraphics(n);y.groupLevel=g.groupLevel,this.setFillAndStrokeStyleToContext(y,f,j);let R=B,k=U,t=J,a=rt;return B<0&&(R=0,t+=Math.abs(B)),U<0&&(k=0,a+=Math.abs(U)),n.translate(-(q.scale*R),-(S.scale*k)),y.transform(q.scale,0,0,S.scale,0,0),n.save(),this.clipBbox(y,R,k,t,a),y.baseTransform=(0,p.getCurrentTransform)(y.ctx),y.executeOperatorList(x),y.endDrawing(),{canvas:l.canvas,scaleX:q.scale,scaleY:S.scale,offsetX:R,offsetY:k}}getSizeAndScale(g,x,F){g=Math.abs(g);const v=Math.max(_.MAX_PATTERN_SIZE,x);let r=Math.ceil(g*F);return r>=v?r=v:F=r/g,{scale:F,size:r}}clipBbox(g,x,F,v,r){const f=v-x,T=r-F;g.ctx.rect(x,F,f,T),g.current.updateRectMinMax((0,p.getCurrentTransform)(g.ctx),[x,F,v,r]),g.clip(),g.endPath()}setFillAndStrokeStyleToContext(g,x,F){const v=g.ctx,r=g.current;switch(x){case u.COLORED:const f=this.ctx;v.fillStyle=f.fillStyle,v.strokeStyle=f.strokeStyle,r.fillColor=f.fillStyle,r.strokeColor=f.strokeStyle;break;case u.UNCOLORED:const T=i.Util.makeHexColor(F[0],F[1],F[2]);v.fillStyle=T,v.strokeStyle=T,r.fillColor=T,r.strokeColor=T;break;default:throw new i.FormatError(`Unsupported paint type: ${x}`)}}getPattern(g,x,F,v){let r=F;v!==O.SHADING&&(r=i.Util.transform(r,x.baseTransform),this.matrix&&(r=i.Util.transform(r,this.matrix)));const f=this.createPatternCanvas(x);let T=new DOMMatrix(r);T=T.translate(f.offsetX,f.offsetY),T=T.scale(1/f.scaleX,1/f.scaleY);const j=g.createPattern(f.canvas,"repeat");return j.setTransform(T),j}}e.TilingPattern=_},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.applyMaskImageData=p;var i=A(1);function p({src:O,srcPos:w=0,dest:M,destPos:C=0,width:h,height:o,inverseDecode:c=!1}){const d=i.FeatureTest.isLittleEndian?4278190080:255,[s,u]=c?[0,d]:[d,0],_=h>>3,m=h&7,g=O.length;M=new Uint32Array(M.buffer);for(let x=0;x<o;x++){for(const v=w+_;w<v;w++){const r=w<g?O[w]:255;M[C++]=r&128?u:s,M[C++]=r&64?u:s,M[C++]=r&32?u:s,M[C++]=r&16?u:s,M[C++]=r&8?u:s,M[C++]=r&4?u:s,M[C++]=r&2?u:s,M[C++]=r&1?u:s}if(m===0)continue;const F=w<g?O[w++]:255;for(let v=0;v<m;v++)M[C++]=F&1<<7-v?u:s}return{srcPos:w,destPos:C}}},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const A=Object.create(null);e.GlobalWorkerOptions=A,A.workerPort=null,A.workerSrc=""},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var i=A(1);const p={UNKNOWN:0,DATA:1,ERROR:2},O={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function w(C){switch(C instanceof Error||typeof C=="object"&&C!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),C.name){case"AbortException":return new i.AbortException(C.message);case"MissingPDFException":return new i.MissingPDFException(C.message);case"PasswordException":return new i.PasswordException(C.message,C.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(C.message,C.status);case"UnknownErrorException":return new i.UnknownErrorException(C.message,C.details);default:return new i.UnknownErrorException(C.message,C.toString())}}class M{constructor(h,o,c){this.sourceName=h,this.targetName=o,this.comObj=c,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=d=>{const s=d.data;if(s.targetName!==this.sourceName)return;if(s.stream){this._processStreamMessage(s);return}if(s.callback){const _=s.callbackId,m=this.callbackCapabilities[_];if(!m)throw new Error(`Cannot resolve callback ${_}`);if(delete this.callbackCapabilities[_],s.callback===p.DATA)m.resolve(s.data);else if(s.callback===p.ERROR)m.reject(w(s.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[s.action];if(!u)throw new Error(`Unknown action from worker: ${s.action}`);if(s.callbackId){const _=this.sourceName,m=s.sourceName;new Promise(function(g){g(u(s.data))}).then(function(g){c.postMessage({sourceName:_,targetName:m,callback:p.DATA,callbackId:s.callbackId,data:g})},function(g){c.postMessage({sourceName:_,targetName:m,callback:p.ERROR,callbackId:s.callbackId,reason:w(g)})});return}if(s.streamId){this._createStreamSink(s);return}u(s.data)},c.addEventListener("message",this._onComObjOnMessage)}on(h,o){const c=this.actionHandler;if(c[h])throw new Error(`There is already an actionName called "${h}"`);c[h]=o}send(h,o,c){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:o},c)}sendWithPromise(h,o,c){const d=this.callbackId++,s=(0,i.createPromiseCapability)();this.callbackCapabilities[d]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:d,data:o},c)}catch(u){s.reject(u)}return s.promise}sendWithStream(h,o,c,d){const s=this.streamId++,u=this.sourceName,_=this.targetName,m=this.comObj;return new ReadableStream({start:g=>{const x=(0,i.createPromiseCapability)();return this.streamControllers[s]={controller:g,startCall:x,pullCall:null,cancelCall:null,isClosed:!1},m.postMessage({sourceName:u,targetName:_,action:h,streamId:s,data:o,desiredSize:g.desiredSize},d),x.promise},pull:g=>{const x=(0,i.createPromiseCapability)();return this.streamControllers[s].pullCall=x,m.postMessage({sourceName:u,targetName:_,stream:O.PULL,streamId:s,desiredSize:g.desiredSize}),x.promise},cancel:g=>{(0,i.assert)(g instanceof Error,"cancel must have a valid reason");const x=(0,i.createPromiseCapability)();return this.streamControllers[s].cancelCall=x,this.streamControllers[s].isClosed=!0,m.postMessage({sourceName:u,targetName:_,stream:O.CANCEL,streamId:s,reason:w(g)}),x.promise}},c)}_createStreamSink(h){const o=h.streamId,c=this.sourceName,d=h.sourceName,s=this.comObj,u=this,_=this.actionHandler[h.action],m={enqueue(g,x=1,F){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=x,v>0&&this.desiredSize<=0&&(this.sinkCapability=(0,i.createPromiseCapability)(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:c,targetName:d,stream:O.ENQUEUE,streamId:o,chunk:g},F)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:c,targetName:d,stream:O.CLOSE,streamId:o}),delete u.streamSinks[o])},error(g){(0,i.assert)(g instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:c,targetName:d,stream:O.ERROR,streamId:o,reason:w(g)}))},sinkCapability:(0,i.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};m.sinkCapability.resolve(),m.ready=m.sinkCapability.promise,this.streamSinks[o]=m,new Promise(function(g){g(_(h.data,m))}).then(function(){s.postMessage({sourceName:c,targetName:d,stream:O.START_COMPLETE,streamId:o,success:!0})},function(g){s.postMessage({sourceName:c,targetName:d,stream:O.START_COMPLETE,streamId:o,reason:w(g)})})}_processStreamMessage(h){const o=h.streamId,c=this.sourceName,d=h.sourceName,s=this.comObj,u=this.streamControllers[o],_=this.streamSinks[o];switch(h.stream){case O.START_COMPLETE:h.success?u.startCall.resolve():u.startCall.reject(w(h.reason));break;case O.PULL_COMPLETE:h.success?u.pullCall.resolve():u.pullCall.reject(w(h.reason));break;case O.PULL:if(!_){s.postMessage({sourceName:c,targetName:d,stream:O.PULL_COMPLETE,streamId:o,success:!0});break}_.desiredSize<=0&&h.desiredSize>0&&_.sinkCapability.resolve(),_.desiredSize=h.desiredSize,new Promise(function(m){m(_.onPull&&_.onPull())}).then(function(){s.postMessage({sourceName:c,targetName:d,stream:O.PULL_COMPLETE,streamId:o,success:!0})},function(m){s.postMessage({sourceName:c,targetName:d,stream:O.PULL_COMPLETE,streamId:o,reason:w(m)})});break;case O.ENQUEUE:if((0,i.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(h.chunk);break;case O.CLOSE:if((0,i.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,o);break;case O.ERROR:(0,i.assert)(u,"error should have stream controller"),u.controller.error(w(h.reason)),this._deleteStreamController(u,o);break;case O.CANCEL_COMPLETE:h.success?u.cancelCall.resolve():u.cancelCall.reject(w(h.reason)),this._deleteStreamController(u,o);break;case O.CANCEL:if(!_)break;new Promise(function(m){m(_.onCancel&&_.onCancel(w(h.reason)))}).then(function(){s.postMessage({sourceName:c,targetName:d,stream:O.CANCEL_COMPLETE,streamId:o,success:!0})},function(m){s.postMessage({sourceName:c,targetName:d,stream:O.CANCEL_COMPLETE,streamId:o,reason:w(m)})}),_.sinkCapability.reject(w(h.reason)),_.isCancelled=!0,delete this.streamSinks[o];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(h,o){await Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete this.streamControllers[o]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}e.MessageHandler=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var i=A(1);class p{#t;#e;constructor({parsedData:w,rawData:M}){this.#t=w,this.#e=M}getRaw(){return this.#e}get(w){return this.#t.get(w)??null}getAll(){return(0,i.objectFromMap)(this.#t)}has(w){return this.#t.has(w)}}e.Metadata=p},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var i=A(1),p=A(8);const O=Symbol("INTERNAL");class w{#t=!0;constructor(h,o){this.name=h,this.intent=o}get visible(){return this.#t}_setVisible(h,o){h!==O&&(0,i.unreachable)("Internal method `_setVisible` called."),this.#t=o}}class M{#t=null;#e=new Map;#n=null;#i=null;constructor(h){if(this.name=null,this.creator=null,h!==null){this.name=h.name,this.creator=h.creator,this.#i=h.order;for(const o of h.groups)this.#e.set(o.id,new w(o.name,o.intent));if(h.baseState==="OFF")for(const o of this.#e.values())o._setVisible(O,!1);for(const o of h.on)this.#e.get(o)._setVisible(O,!0);for(const o of h.off)this.#e.get(o)._setVisible(O,!1);this.#n=this.getHash()}}#r(h){const o=h.length;if(o<2)return!0;const c=h[0];for(let d=1;d<o;d++){const s=h[d];let u;if(Array.isArray(s))u=this.#r(s);else if(this.#e.has(s))u=this.#e.get(s).visible;else return(0,i.warn)(`Optional content group not found: ${s}`),!0;switch(c){case"And":if(!u)return!1;break;case"Or":if(u)return!0;break;case"Not":return!u;default:return!0}}return c==="And"}isVisible(h){if(this.#e.size===0)return!0;if(!h)return(0,i.warn)("Optional content group not defined."),!0;if(h.type==="OCG")return this.#e.has(h.id)?this.#e.get(h.id).visible:((0,i.warn)(`Optional content group not found: ${h.id}`),!0);if(h.type==="OCMD"){if(h.expression)return this.#r(h.expression);if(!h.policy||h.policy==="AnyOn"){for(const o of h.ids){if(!this.#e.has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(this.#e.get(o).visible)return!0}return!1}else if(h.policy==="AllOn"){for(const o of h.ids){if(!this.#e.has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(!this.#e.get(o).visible)return!1}return!0}else if(h.policy==="AnyOff"){for(const o of h.ids){if(!this.#e.has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(!this.#e.get(o).visible)return!0}return!1}else if(h.policy==="AllOff"){for(const o of h.ids){if(!this.#e.has(o))return(0,i.warn)(`Optional content group not found: ${o}`),!0;if(this.#e.get(o).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${h.policy}.`),!0}return(0,i.warn)(`Unknown group type ${h.type}.`),!0}setVisibility(h,o=!0){if(!this.#e.has(h)){(0,i.warn)(`Optional content group not found: ${h}`);return}this.#e.get(h)._setVisible(O,!!o),this.#t=null}get hasInitialVisibility(){return this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,i.objectFromMap)(this.#e):null}getGroup(h){return this.#e.get(h)||null}getHash(){if(this.#t!==null)return this.#t;const h=new p.MurmurHash3_64;for(const[o,c]of this.#e)h.update(`${o}:${c.visible}`);return this.#t=h.hexdigest()}}e.OptionalContentConfig=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var i=A(1),p=A(6);class O{constructor({length:h,initialData:o,progressiveDone:c=!1,contentDispositionFilename:d=null,disableRange:s=!1,disableStream:u=!1},_){if((0,i.assert)(_,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=d,o?.length>0){const m=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(m)}this._pdfDataRangeTransport=_,this._isStreamingSupported=!u,this._isRangeSupported=!s,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((m,g)=>{this._onReceiveData({begin:m,chunk:g})}),this._pdfDataRangeTransport.addProgressListener((m,g)=>{this._onProgress({loaded:m,total:g})}),this._pdfDataRangeTransport.addProgressiveReadListener(m=>{this._onReceiveData({chunk:m})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:h,chunk:o}){const c=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(c):this._queuedChunks.push(c);else{const d=this._rangeReaders.some(function(s){return s._begin!==h?!1:(s._enqueue(c),!0)});(0,i.assert)(d,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){h.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:h.loaded}):this._fullRequestReader?.onProgress?.({loaded:h.loaded,total:h.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const o=this._rangeReaders.indexOf(h);o>=0&&this._rangeReaders.splice(o,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new w(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,o){if(o<=this._progressiveDataLength)return null;const c=new M(this,h,o);return this._pdfDataRangeTransport.requestDataRange(h,o),this._rangeReaders.push(c),c}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(const o of this._rangeReaders.slice(0))o.cancel(h);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=O;class w{constructor(h,o,c=!1,d=null){this._stream=h,this._done=c||!1,this._filename=(0,p.isPdfFile)(d)?d:null,this._queuedChunks=o||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=(0,i.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class M{constructor(h,o,c){this._stream=h,this._begin=o,this._end=c,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};const h=(0,i.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class A{static textContent(p){const O=[],w={items:O,styles:Object.create(null)};function M(C){if(!C)return;let h=null;const o=C.name;if(o==="#text")h=C.value;else if(A.shouldBuildText(o))C?.attributes?.textContent?h=C.attributes.textContent:C.value&&(h=C.value);else return;if(h!==null&&O.push({str:h}),!!C.children)for(const c of C.children)M(c)}return M(p),w}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}e.XfaText=A},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var i=A(7);const p=function(C){return new Promise((h,o)=>{require$$5.readFile(C,(d,s)=>{if(d||!s){o(new Error(d));return}h(new Uint8Array(s))})})};class O extends i.BaseCanvasFactory{_createCanvas(h,o){return require$$5.createCanvas(h,o)}}e.NodeCanvasFactory=O;class w extends i.BaseCMapReaderFactory{_fetchData(h,o){return p(h).then(c=>({cMapData:c,compressionType:o}))}}e.NodeCMapReaderFactory=w;class M extends i.BaseStandardFontDataFactory{_fetchData(h){return p(h)}}e.NodeStandardFontDataFactory=M},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var i=A(1),p=A(22);const O=require$$5,w=require$$5,M=require$$5,C=require$$5,h=/^file:\/\/\/[a-zA-Z]:\//;function o(F){const v=C.parse(F);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(F)?C.parse(`file:///${F}`):(v.host||(v.protocol="file:"),v)}class c{constructor(v){this.source=v,this.url=o(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new g(this):new _(this),this._fullRequestReader}getRangeReader(v,r){if(r<=this._progressiveDataLength)return null;const f=this.isFsUrl?new x(this,v,r):new m(this,v,r);return this._rangeRequestReaders.push(f),f}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(const r of this._rangeRequestReaders.slice(0))r.cancel(v)}}e.PDFNodeStream=c;class d{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=v.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)(),this._headersCapability=(0,i.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",r=>{this._error(r)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class s{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)();const r=v.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",r=>{this._error(r)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(F,v){return{protocol:F.protocol,auth:F.auth,host:F.hostname,port:F.port,path:F.path,method:"GET",headers:v}}class _ extends d{constructor(v){super(v);const r=f=>{if(f.statusCode===404){const B=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=B,this._headersCapability.reject(B);return}this._headersCapability.resolve(),this._setReadableStream(f);const T=B=>this._readableStream.headers[B.toLowerCase()],{allowRangeRequests:j,suggestedLength:L}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=j,this._contentLength=L||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(T)};this._request=null,this._url.protocol==="http:"?this._request=w.request(u(this._url,v.httpHeaders),r):this._request=M.request(u(this._url,v.httpHeaders),r),this._request.on("error",f=>{this._storedError=f,this._headersCapability.reject(f)}),this._request.end()}}class m extends s{constructor(v,r,f){super(v),this._httpHeaders={};for(const j in v.httpHeaders){const L=v.httpHeaders[j];L!==void 0&&(this._httpHeaders[j]=L)}this._httpHeaders.Range=`bytes=${r}-${f-1}`;const T=j=>{if(j.statusCode===404){const L=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=L;return}this._setReadableStream(j)};this._request=null,this._url.protocol==="http:"?this._request=w.request(u(this._url,this._httpHeaders),T):this._request=M.request(u(this._url,this._httpHeaders),T),this._request.on("error",j=>{this._storedError=j}),this._request.end()}}class g extends d{constructor(v){super(v);let r=decodeURIComponent(this._url.path);h.test(this._url.href)&&(r=r.replace(/^\//,"")),O.lstat(r,(f,T)=>{if(f){f.code==="ENOENT"&&(f=new i.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=f,this._headersCapability.reject(f);return}this._contentLength=T.size,this._setReadableStream(O.createReadStream(r)),this._headersCapability.resolve()})}}class x extends s{constructor(v,r,f){super(v);let T=decodeURIComponent(this._url.path);h.test(this._url.href)&&(T=T.replace(/^\//,"")),this._setReadableStream(O.createReadStream(T,{start:r,end:f-1}))}}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=C,e.extractFilenameFromHeader=M,e.validateRangeRequestCapabilities=w,e.validateResponseStatus=h;var i=A(1),p=A(23),O=A(6);function w({getResponseHeader:o,isHttp:c,rangeChunkSize:d,disableRange:s}){const u={allowRangeRequests:!1,suggestedLength:void 0},_=parseInt(o("Content-Length"),10);return!Number.isInteger(_)||(u.suggestedLength=_,_<=2*d)||s||!c||o("Accept-Ranges")!=="bytes"||(o("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function M(o){const c=o("Content-Disposition");if(c){let d=(0,p.getFilenameFromContentDispositionHeader)(c);if(d.includes("%"))try{d=decodeURIComponent(d)}catch{}if((0,O.isPdfFile)(d))return d}return null}function C(o,c){return o===404||o===0&&c.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+c+'".'):new i.UnexpectedResponseException(`Unexpected server response (${o}) while retrieving PDF "${c}".`,o)}function h(o){return o===200||o===206}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=p;var i=A(1);function p(O){let w=!0,M=C("filename\\*","i").exec(O);if(M){M=M[1];let _=d(M);return _=unescape(_),_=s(_),_=u(_),o(_)}if(M=c(O),M){const _=u(M);return o(_)}if(M=C("filename","i").exec(O),M){M=M[1];let _=d(M);return _=u(_),o(_)}function C(_,m){return new RegExp("(?:^|;)\\s*"+_+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function h(_,m){if(_){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const g=new TextDecoder(_,{fatal:!0}),x=(0,i.stringToBytes)(m);m=g.decode(x),w=!1}catch{}}return m}function o(_){return w&&/[\x80-\xff]/.test(_)&&(_=h("utf-8",_),w&&(_=h("iso-8859-1",_))),_}function c(_){const m=[];let g;const x=C("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=x.exec(_))!==null;){let[,v,r,f]=g;if(v=parseInt(v,10),v in m){if(v===0)break;continue}m[v]=[r,f]}const F=[];for(let v=0;v<m.length&&v in m;++v){let[r,f]=m[v];f=d(f),r&&(f=unescape(f),v===0&&(f=s(f))),F.push(f)}return F.join("")}function d(_){if(_.startsWith('"')){const m=_.slice(1).split('\\"');for(let g=0;g<m.length;++g){const x=m[g].indexOf('"');x!==-1&&(m[g]=m[g].slice(0,x),m.length=g+1),m[g]=m[g].replace(/\\(.)/g,"$1")}_=m.join('"')}return _}function s(_){const m=_.indexOf("'");if(m===-1)return _;const g=_.slice(0,m),F=_.slice(m+1).replace(/^[^']*'/,"");return h(g,F)}function u(_){return!_.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(_)?_:_.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,g,x,F){if(x==="q"||x==="Q")return F=F.replace(/_/g," "),F=F.replace(/=([0-9a-fA-F]{2})/g,function(v,r){return String.fromCharCode(parseInt(r,16))}),h(g,F);try{F=atob(F)}catch{}return h(g,F)})}return""}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var i=A(1),p=A(22);const O=200,w=206;function M(d){const s=d.response;return typeof s!="string"?s:(0,i.stringToBytes)(s).buffer}class C{constructor(s,u={}){this.url=s,this.isHttp=/^https?:/i.test(s),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(s,u,_){const m={begin:s,end:u};for(const g in _)m[g]=_[g];return this.request(m)}requestFull(s){return this.request(s)}request(s){const u=this.getXhr(),_=this.currXhrId++,m=this.pendingRequests[_]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const g in this.httpHeaders){const x=this.httpHeaders[g];x!==void 0&&u.setRequestHeader(g,x)}return this.isHttp&&"begin"in s&&"end"in s?(u.setRequestHeader("Range",`bytes=${s.begin}-${s.end-1}`),m.expectedStatus=w):m.expectedStatus=O,u.responseType="arraybuffer",s.onError&&(u.onerror=function(g){s.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,_),u.onprogress=this.onProgress.bind(this,_),m.onHeadersReceived=s.onHeadersReceived,m.onDone=s.onDone,m.onError=s.onError,m.onProgress=s.onProgress,u.send(null),_}onProgress(s,u){const _=this.pendingRequests[s];_&&_.onProgress?.(u)}onStateChange(s,u){const _=this.pendingRequests[s];if(!_)return;const m=_.xhr;if(m.readyState>=2&&_.onHeadersReceived&&(_.onHeadersReceived(),delete _.onHeadersReceived),m.readyState!==4||!(s in this.pendingRequests))return;if(delete this.pendingRequests[s],m.status===0&&this.isHttp){_.onError?.(m.status);return}const g=m.status||O;if(!(g===O&&_.expectedStatus===w)&&g!==_.expectedStatus){_.onError?.(m.status);return}const F=M(m);if(g===w){const v=m.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);_.onDone({begin:parseInt(r[1],10),chunk:F})}else F?_.onDone({begin:0,chunk:F}):_.onError?.(m.status)}getRequestXhr(s){return this.pendingRequests[s].xhr}isPendingRequest(s){return s in this.pendingRequests}abortRequest(s){const u=this.pendingRequests[s].xhr;delete this.pendingRequests[s],u.abort()}}class h{constructor(s){this._source=s,this._manager=new C(s.url,{httpHeaders:s.httpHeaders,withCredentials:s.withCredentials}),this._rangeChunkSize=s.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(s){const u=this._rangeRequestReaders.indexOf(s);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new o(this._manager,this._source),this._fullRequestReader}getRangeReader(s,u){const _=new c(this._manager,s,u);return _.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(_),_}cancelAllRequests(s){this._fullRequestReader?.cancel(s);for(const u of this._rangeRequestReaders.slice(0))u.cancel(s)}}e.PDFNetworkStream=h;class o{constructor(s,u){this._manager=s;const _={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=s.requestFull(_),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const s=this._fullRequestId,u=this._manager.getRequestXhr(s),_=x=>u.getResponseHeader(x),{allowRangeRequests:m,suggestedLength:g}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});m&&(this._isRangeSupported=!0),this._contentLength=g||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(_),this._isRangeSupported&&this._manager.abortRequest(s),this._headersReceivedCapability.resolve()}_onDone(s){if(s&&(this._requests.length>0?this._requests.shift().resolve({value:s.chunk,done:!1}):this._cachedChunks.push(s.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(s){this._storedError=(0,p.createResponseStatusError)(s,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(s){this.onProgress?.({loaded:s.loaded,total:s.lengthComputable?s.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const s=(0,i.createPromiseCapability)();return this._requests.push(s),s.promise}cancel(s){this._done=!0,this._headersReceivedCapability.reject(s);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class c{constructor(s,u,_){this._manager=s;const m={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=s.url,this._requestId=s.requestRange(u,_,m),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(s){const u=s.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(s){this._storedError=(0,p.createResponseStatusError)(s,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(s){this.isStreamingSupported||this.onProgress?.({loaded:s.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const s=(0,i.createPromiseCapability)();return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var i=A(1),p=A(22);function O(c,d,s){return{method:"GET",headers:c,signal:s.signal,mode:"cors",credentials:d?"include":"same-origin",redirect:"follow"}}function w(c){const d=new Headers;for(const s in c){const u=c[s];u!==void 0&&d.append(s,u)}return d}function M(c){return c instanceof Uint8Array?c.buffer:c instanceof ArrayBuffer?c:((0,i.warn)(`getArrayBuffer - unexpected data format: ${c}`),new Uint8Array(c).buffer)}class C{constructor(d){this.source=d,this.isHttp=/^https?:/i.test(d.url),this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h(this),this._fullRequestReader}getRangeReader(d,s){if(s<=this._progressiveDataLength)return null;const u=new o(this,d,s);return this._rangeRequestReaders.push(u),u}cancelAllRequests(d){this._fullRequestReader?.cancel(d);for(const s of this._rangeRequestReaders.slice(0))s.cancel(d)}}e.PDFFetchStream=C;class h{constructor(d){this._stream=d,this._reader=null,this._loaded=0,this._filename=null;const s=d.source;this._withCredentials=s.withCredentials||!1,this._contentLength=s.length,this._headersCapability=(0,i.createPromiseCapability)(),this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._headers=w(this._stream.httpHeaders);const u=s.url;fetch(u,O(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,p.validateResponseStatus)(_.status))throw(0,p.createResponseStatusError)(_.status,u);this._reader=_.body.getReader(),this._headersCapability.resolve();const m=F=>_.headers.get(F),{allowRangeRequests:g,suggestedLength:x}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:m,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=g,this._contentLength=x||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(m),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:d,done:s}=await this._reader.read();return s?{value:d,done:s}:(this._loaded+=d.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:M(d),done:!1})}cancel(d){this._reader?.cancel(d),this._abortController.abort()}}class o{constructor(d,s,u){this._stream=d,this._reader=null,this._loaded=0;const _=d.source;this._withCredentials=_.withCredentials||!1,this._readCapability=(0,i.createPromiseCapability)(),this._isStreamingSupported=!_.disableStream,this._abortController=new AbortController,this._headers=w(this._stream.httpHeaders),this._headers.append("Range",`bytes=${s}-${u-1}`);const m=_.url;fetch(m,O(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,p.validateResponseStatus)(g.status))throw(0,p.createResponseStatusError)(g.status,m);this._readCapability.resolve(),this._reader=g.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:d,done:s}=await this._reader.read();return s?{value:d,done:s}:(this._loaded+=d.byteLength,this.onProgress?.({loaded:this._loaded}),{value:M(d),done:!1})}cancel(d){this._reader?.cancel(d),this._abortController.abort()}}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=_,e.updateTextLayer=m;var i=A(1),p=A(6);const O=1e5,w=30,M=.8,C=new Map;function h(g,x){let F;if(x&&i.FeatureTest.isOffscreenCanvasSupported)F=new OffscreenCanvas(g,g).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=g,F=v.getContext("2d",{alpha:!1})}return F}function o(g,x){const F=C.get(g);if(F)return F;const v=h(w,x);v.font=`${w}px ${g}`;const r=v.measureText("");let f=r.fontBoundingBoxAscent,T=Math.abs(r.fontBoundingBoxDescent);if(f){const L=f/(f+T);return C.set(g,L),v.canvas.width=v.canvas.height=0,L}v.strokeStyle="red",v.clearRect(0,0,w,w),v.strokeText("g",0,0);let j=v.getImageData(0,0,w,w).data;T=0;for(let L=j.length-1-3;L>=0;L-=4)if(j[L]>0){T=Math.ceil(L/4/w);break}v.clearRect(0,0,w,w),v.strokeText("A",0,w),j=v.getImageData(0,0,w,w).data,f=0;for(let L=0,B=j.length;L<B;L+=4)if(j[L]>0){f=w-Math.floor(L/4/w);break}if(v.canvas.width=v.canvas.height=0,f){const L=f/(f+T);return C.set(g,L),L}return C.set(g,M),M}function c(g,x,F){const v=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};g._textDivs.push(v);const f=i.Util.transform(g._transform,x.transform);let T=Math.atan2(f[1],f[0]);const j=F[x.fontName];j.vertical&&(T+=Math.PI/2);const L=Math.hypot(f[2],f[3]),B=L*o(j.fontFamily,g._isOffscreenCanvasSupported);let U,J;T===0?(U=f[4],J=f[5]-B):(U=f[4]+B*Math.sin(T),J=f[5]-B*Math.cos(T));const rt="calc(var(--scale-factor)*",Q=v.style;g._container===g._rootContainer?(Q.left=`${(100*U/g._pageWidth).toFixed(2)}%`,Q.top=`${(100*J/g._pageHeight).toFixed(2)}%`):(Q.left=`${rt}${U.toFixed(2)}px)`,Q.top=`${rt}${J.toFixed(2)}px)`),Q.fontSize=`${rt}${L.toFixed(2)}px)`,Q.fontFamily=j.fontFamily,r.fontSize=L,v.setAttribute("role","presentation"),v.textContent=x.str,v.dir=x.dir,g._fontInspectorEnabled&&(v.dataset.fontName=x.fontName),T!==0&&(r.angle=T*(180/Math.PI));let $=!1;if(x.str.length>1)$=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){const N=Math.abs(x.transform[0]),q=Math.abs(x.transform[3]);N!==q&&Math.max(N,q)/Math.min(N,q)>1.5&&($=!0)}$&&(r.canvasWidth=j.vertical?x.height:x.width),g._textDivProperties.set(v,r),g._isReadableStream&&g._layoutText(v)}function d(g){const{div:x,scale:F,properties:v,ctx:r,prevFontSize:f,prevFontFamily:T}=g,{style:j}=x;let L="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:B}=j,{canvasWidth:U,fontSize:J}=v;(f!==J||T!==B)&&(r.font=`${J*F}px ${B}`,g.prevFontSize=J,g.prevFontFamily=B);const{width:rt}=r.measureText(x.textContent);rt>0&&(L=`scaleX(${U*F/rt})`)}v.angle!==0&&(L=`rotate(${v.angle}deg) ${L}`),L.length>0&&(j.transform=L)}function s(g){if(g._canceled)return;const x=g._textDivs,F=g._capability;if(x.length>O){F.resolve();return}if(!g._isReadableStream)for(const r of x)g._layoutText(r);F.resolve()}class u{constructor({textContentSource:x,container:F,viewport:v,textDivs:r,textDivProperties:f,textContentItemsStr:T,isOffscreenCanvasSupported:j}){this._textContentSource=x,this._isReadableStream=x instanceof ReadableStream,this._container=this._rootContainer=F,this._textDivs=r||[],this._textContentItemsStr=T||[],this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=f||new WeakMap,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:h(0,j)};const{pageWidth:L,pageHeight:B,pageX:U,pageY:J}=v.rawDims;this._transform=[1,0,0,-1,-U,J+B],this._pageWidth=L,this._pageHeight=B,(0,p.setLayerDimensions)(F,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(x,F){for(const v of x){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const r=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),r.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),c(this,v,F)}}_layoutText(x){const F=this._layoutTextParams.properties=this._textDivProperties.get(x);if(this._layoutTextParams.div=x,d(this._layoutTextParams),F.hasText&&this._container.append(x),F.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const x=(0,i.createPromiseCapability)();let F=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:r,done:f})=>{if(f){x.resolve();return}Object.assign(F,r.styles),this._processItems(r.items,F),v()},x.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:r}=this._textContentSource;this._processItems(v,r),x.resolve()}else throw new Error('No "textContentSource" parameter specified.');x.promise.then(()=>{F=null,s(this)},this._capability.reject)}}e.TextLayerRenderTask=u;function _(g){!g.textContentSource&&(g.textContent||g.textContentStream)&&((0,p.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),g.textContentSource=g.textContent||g.textContentStream);const x=new u(g);return x._render(),x}function m({container:g,viewport:x,textDivs:F,textDivProperties:v,isOffscreenCanvasSupported:r,mustRotate:f=!0,mustRescale:T=!0}){if(f&&(0,p.setLayerDimensions)(g,{rotation:x.rotation}),T){const j=h(0,r),B={prevFontSize:null,prevFontFamily:null,div:null,scale:x.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:j};for(const U of F)B.properties=v.get(U),B.div=U,d(B)}}},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var i=A(1),p=A(5),O=A(28),w=A(29),M=A(6);class C{#t;#e=!1;#n=this.pointerup.bind(this);#i=this.pointerdown.bind(this);#r=new Map;#l=!1;#c=!1;#s;static _initialized=!1;constructor(o){C._initialized||(C._initialized=!0,O.FreeTextEditor.initialize(o.l10n),w.InkEditor.initialize(o.l10n)),o.uiManager.registerEditorTypes([O.FreeTextEditor,w.InkEditor]),this.#s=o.uiManager,this.pageIndex=o.pageIndex,this.div=o.div,this.#t=o.accessibilityManager,this.#s.addLayer(this)}updateToolbar(o){this.#s.updateToolbar(o)}updateMode(o=this.#s.getMode()){this.#f(),o===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#s.unselectAll(),this.div.classList.toggle("freeTextEditing",o===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",o===i.AnnotationEditorType.INK)}addInkEditorIfNeeded(o){if(!o&&this.#s.getMode()!==i.AnnotationEditorType.INK)return;if(!o){for(const d of this.#r.values())if(d.isEmpty()){d.setInBackground();return}}this.#h({offsetX:0,offsetY:0}).setInBackground()}setEditingState(o){this.#s.setEditingState(o)}addCommands(o){this.#s.addCommands(o)}enable(){this.div.style.pointerEvents="auto";for(const o of this.#r.values())o.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const o of this.#r.values())o.disableEditing()}setActiveEditor(o){this.#s.getActive()!==o&&this.#s.setActiveEditor(o)}enableClick(){this.div.addEventListener("pointerdown",this.#i),this.div.addEventListener("pointerup",this.#n)}disableClick(){this.div.removeEventListener("pointerdown",this.#i),this.div.removeEventListener("pointerup",this.#n)}attach(o){this.#r.set(o.id,o)}detach(o){this.#r.delete(o.id),this.#t?.removePointerInTextLayer(o.contentDiv)}remove(o){this.#s.removeEditor(o),this.detach(o),o.div.style.display="none",setTimeout(()=>{o.div.style.display="",o.div.remove(),o.isAttachedToDOM=!1,document.activeElement===document.body&&this.#s.focusMainContainer()},0),this.#c||this.addInkEditorIfNeeded(!1)}#a(o){o.parent!==this&&(this.attach(o),o.parent?.detach(o),o.setParent(this),o.div&&o.isAttachedToDOM&&(o.div.remove(),this.div.append(o.div)))}add(o){if(this.#a(o),this.#s.addEditor(o),this.attach(o),!o.isAttachedToDOM){const c=o.render();this.div.append(c),o.isAttachedToDOM=!0}this.moveEditorInDOM(o),o.onceAdded(),this.#s.addToAnnotationStorage(o)}moveEditorInDOM(o){this.#t?.moveElementInDOM(this.div,o.div,o.contentDiv,!0)}addOrRebuild(o){o.needsToBeRebuilt()?o.rebuild():this.add(o)}addANewEditor(o){const c=()=>{this.addOrRebuild(o)},d=()=>{o.remove()};this.addCommands({cmd:c,undo:d,mustExec:!0})}addUndoableEditor(o){const c=()=>{this.addOrRebuild(o)},d=()=>{o.remove()};this.addCommands({cmd:c,undo:d,mustExec:!1})}getNextId(){return this.#s.getId()}#p(o){switch(this.#s.getMode()){case i.AnnotationEditorType.FREETEXT:return new O.FreeTextEditor(o);case i.AnnotationEditorType.INK:return new w.InkEditor(o)}return null}deserialize(o){switch(o.annotationType){case i.AnnotationEditorType.FREETEXT:return O.FreeTextEditor.deserialize(o,this,this.#s);case i.AnnotationEditorType.INK:return w.InkEditor.deserialize(o,this,this.#s)}return null}#h(o){const c=this.getNextId(),d=this.#p({parent:this,id:c,x:o.offsetX,y:o.offsetY,uiManager:this.#s});return d&&this.add(d),d}setSelected(o){this.#s.setSelected(o)}toggleSelected(o){this.#s.toggleSelected(o)}isSelected(o){return this.#s.isSelected(o)}unselect(o){this.#s.unselect(o)}pointerup(o){const{isMac:c}=i.FeatureTest.platform;if(!(o.button!==0||o.ctrlKey&&c)&&o.target===this.div&&this.#l){if(this.#l=!1,!this.#e){this.#e=!0;return}this.#h(o)}}pointerdown(o){const{isMac:c}=i.FeatureTest.platform;if(o.button!==0||o.ctrlKey&&c||o.target!==this.div)return;this.#l=!0;const d=this.#s.getActive();this.#e=!d||d.isEmpty()}drop(o){const c=o.dataTransfer.getData("text/plain"),d=this.#s.getEditor(c);if(!d)return;o.preventDefault(),o.dataTransfer.dropEffect="move",this.#a(d);const s=this.div.getBoundingClientRect(),u=o.clientX-s.x,_=o.clientY-s.y;d.translate(u-d.startX,_-d.startY),this.moveEditorInDOM(d),d.div.focus()}dragover(o){o.preventDefault()}destroy(){this.#s.getActive()?.parent===this&&this.#s.setActiveEditor(null);for(const o of this.#r.values())this.#t?.removePointerInTextLayer(o.contentDiv),o.setParent(null),o.isAttachedToDOM=!1,o.div.remove();this.div=null,this.#r.clear(),this.#s.removeLayer(this)}#f(){this.#c=!0;for(const o of this.#r.values())o.isEmpty()&&o.remove();this.#c=!1}render({viewport:o}){this.viewport=o,(0,M.setLayerDimensions)(this.div,o),(0,p.bindEvents)(this,this.div,["dragover","drop"]);for(const c of this.#s.getEditors(this.pageIndex))this.add(c);this.updateMode()}update({viewport:o}){this.#s.commitOrRemove(),this.viewport=o,(0,M.setLayerDimensions)(this.div,{rotation:o.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:o,pageHeight:c}=this.viewport.rawDims;return[o,c]}}e.AnnotationEditorLayer=C},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var i=A(1),p=A(5),O=A(4);class w extends O.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#i=this.editorDivKeydown.bind(this);#r;#l="";#c=`${this.id}-editor`;#s=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new p.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],w.prototype.commitOrRemove]]);static _type="freetext";constructor(C){super({...C,name:"freeTextEditor"}),this.#r=C.color||w._defaultColor||O.AnnotationEditor._defaultLineColor,this.#a=C.fontSize||w._defaultFontSize}static initialize(C){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(o=>[o,C.get(o)]));const h=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(h.getPropertyValue("--freetext-padding"))}static updateDefaultParams(C,h){switch(C){case i.AnnotationEditorParamsType.FREETEXT_SIZE:w._defaultFontSize=h;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:w._defaultColor=h;break}}updateParams(C,h){switch(C){case i.AnnotationEditorParamsType.FREETEXT_SIZE:this.#p(h);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:this.#h(h);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,w._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,w._defaultColor||O.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[i.AnnotationEditorParamsType.FREETEXT_COLOR,this.#r]]}#p(C){const h=c=>{this.editorDiv.style.fontSize=`calc(${c}px * var(--scale-factor))`,this.translate(0,-(c-this.#a)*this.parentScale),this.#a=c,this.#o()},o=this.#a;this.addCommands({cmd:()=>{h(C)},undo:()=>{h(o)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#h(C){const h=this.#r;this.addCommands({cmd:()=>{this.#r=this.editorDiv.style.color=C},undo:()=>{this.#r=this.editorDiv.style.color=h},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const C=this.parentScale;return[-w._internalPadding*C,-(w._internalPadding+this.#a)*C]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#c),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(C){super.focusin(C),C.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#f(){const C=this.editorDiv.getElementsByTagName("div");if(C.length===0)return this.editorDiv.innerText;const h=[];for(const o of C)h.push(o.innerText.replace(/\r\n?|\n/,""));return h.join(`
`)}#o(){const[C,h]=this.parentDimensions;let o;if(this.isAttachedToDOM)o=this.div.getBoundingClientRect();else{const{currentLayer:c,div:d}=this,s=d.style.display;d.style.display="hidden",c.div.append(this.div),o=d.getBoundingClientRect(),d.remove(),d.style.display=s}this.width=o.width/C,this.height=o.height/h}commit(){this.isInEditMode()&&(super.commit(),this.#s||(this.#s=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#l=this.#f().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(C){this.enableEditMode(),this.editorDiv.focus()}keydown(C){C.target===this.div&&C.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(C){w._keyboardManager.exec(this,C)}editorDivFocus(C){this.isEditing=!0}editorDivBlur(C){this.isEditing=!1}editorDivInput(C){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let C,h;this.width&&(C=this.x,h=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#c),this.enableEditing(),w._l10nPromise.get("editor_free_text2_aria_label").then(c=>this.editorDiv?.setAttribute("aria-label",c)),w._l10nPromise.get("free_text2_default_content").then(c=>this.editorDiv?.setAttribute("default-content",c)),this.editorDiv.contentEditable=!0;const{style:o}=this.editorDiv;if(o.fontSize=`calc(${this.#a}px * var(--scale-factor))`,o.color=this.#r,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,p.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[c,d]=this.parentDimensions;this.setAt(C*c,h*d,this.width*c,this.height*d);for(const s of this.#l.split(`
`)){const u=document.createElement("div");u.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(u)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(C,h,o){const c=super.deserialize(C,h,o);return c.#a=C.fontSize,c.#r=i.Util.makeHexColor(...C.color),c.#l=C.value,c}serialize(){if(this.isEmpty())return null;const C=w._internalPadding*this.parentScale,h=this.getRect(C,C),o=O.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#r);return{annotationType:i.AnnotationEditorType.FREETEXT,color:o,fontSize:this.#a,value:this.#l,pageIndex:this.pageIndex,rect:h,rotation:this.rotation}}}e.FreeTextEditor=w},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,Object.defineProperty(e,"fitCurve",{enumerable:!0,get:function(){return O.fitCurve}});var i=A(1),p=A(4),O=A(30),w=A(5);const M=16,C=100;class h extends p.AnnotationEditor{#t=0;#e=0;#n=0;#i=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#l=this.canvasPointerup.bind(this);#c=this.canvasPointerdown.bind(this);#s=!1;#a=!1;#p=null;#h=null;#f=0;#o=0;#g=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(c){super({...c,name:"inkEditor"}),this.color=c.color||null,this.thickness=c.thickness||null,this.opacity=c.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(c){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(d=>[d,c.get(d)]))}static updateDefaultParams(c,d){switch(c){case i.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=d;break;case i.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=d;break;case i.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=d/100;break}}updateParams(c,d){switch(c){case i.AnnotationEditorParamsType.INK_THICKNESS:this.#C(d);break;case i.AnnotationEditorParamsType.INK_COLOR:this.#T(d);break;case i.AnnotationEditorParamsType.INK_OPACITY:this.#P(d);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||p.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(h._defaultOpacity*100)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||p.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#C(c){const d=this.thickness;this.addCommands({cmd:()=>{this.thickness=c,this.#E()},undo:()=>{this.thickness=d,this.#E()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#T(c){const d=this.color;this.addCommands({cmd:()=>{this.color=c,this.#d()},undo:()=>{this.color=d,this.#d()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#P(c){c/=100;const d=this.opacity;this.addCommands({cmd:()=>{this.opacity=c,this.#d()},undo:()=>{this.opacity=d,this.#d()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#_(),this.#v()),this.isAttachedToDOM||(this.parent.add(this),this.#b()),this.#E())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#h.disconnect(),this.#h=null,super.remove())}setParent(c){!this.parent&&c?this._uiManager.removeShouldRescale(this):this.parent&&c===null&&this._uiManager.addShouldRescale(this),super.setParent(c)}onScaleChanging(){const[c,d]=this.parentDimensions,s=this.width*c,u=this.height*d;this.setDimensions(s,u)}enableEditMode(){this.#s||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#c),this.canvas.addEventListener("pointerup",this.#l))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#c),this.canvas.removeEventListener("pointerup",this.#l))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#x(){const{parentRotation:c,parentDimensions:[d,s]}=this;switch(c){case 90:return[0,s,s,d];case 180:return[d,s,d,s];case 270:return[d,0,s,d];default:return[0,0,d,s]}}#y(){const{ctx:c,color:d,opacity:s,thickness:u,parentScale:_,scaleFactor:m}=this;c.lineWidth=u*_/m,c.lineCap="round",c.lineJoin="round",c.miterLimit=10,c.strokeStyle=`${d}${(0,w.opacityToHex)(s)}`}#w(c,d){this.isEditing=!0,this.#a||(this.#a=!0,this.#b(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||p.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([c,d]),this.#p=null,this.#y(),this.ctx.beginPath(),this.ctx.moveTo(c,d),this.#g=()=>{this.#g&&(this.#p&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#d(),this.ctx.lineTo(...this.#p),this.#p=null,this.ctx.stroke()),window.requestAnimationFrame(this.#g))},window.requestAnimationFrame(this.#g)}#k(c,d){const[s,u]=this.currentPath.at(-1);c===s&&d===u||(this.currentPath.push([c,d]),this.#p=[c,d])}#R(c,d){this.ctx.closePath(),this.#g=null,c=Math.min(Math.max(c,0),this.canvas.width),d=Math.min(Math.max(d,0),this.canvas.height);const[s,u]=this.currentPath.at(-1);(c!==s||d!==u)&&this.currentPath.push([c,d]);let _;if(this.currentPath.length!==1)_=(0,O.fitCurve)(this.currentPath,30,null);else{const F=[c,d];_=[[F,F.slice(),F.slice(),F]]}const m=h.#M(_);this.currentPath.length=0;const g=()=>{this.paths.push(_),this.bezierPath2D.push(m),this.rebuild()},x=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#_(),this.#v()),this.#E())};this.addCommands({cmd:g,undo:x,mustExec:!0})}#d(){if(this.isEmpty()){this.#m();return}this.#y();const{canvas:c,ctx:d}=this;d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,c.width,c.height),this.#m();for(const s of this.bezierPath2D)d.stroke(s)}commit(){this.#s||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#s=!0,this.div.classList.add("disabled"),this.#E(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(c){super.focusin(c),this.enableEditMode()}canvasPointerdown(c){c.button!==0||!this.isInEditMode()||this.#s||(this.setInForeground(),c.type!=="mouse"&&this.div.focus(),c.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#i),this.#w(c.offsetX,c.offsetY))}canvasPointermove(c){c.stopPropagation(),this.#k(c.offsetX,c.offsetY)}canvasPointerup(c){c.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(c.stopPropagation(),this.#F(c),this.setInBackground())}canvasPointerleave(c){this.#F(c),this.setInBackground()}#F(c){this.#R(c.offsetX,c.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#i),this.addToAnnotationStorage()}#_(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",h._l10nPromise.get("editor_ink_canvas_aria_label").then(c=>this.canvas?.setAttribute("aria-label",c)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#v(){let c=null;this.#h=new ResizeObserver(d=>{const s=d[0].contentRect;s.width&&s.height&&(c!==null&&clearTimeout(c),c=setTimeout(()=>{this.fixDims(),c=null},C),this.setDimensions(s.width,s.height))}),this.#h.observe(this.div)}render(){if(this.div)return this.div;let c,d;this.width&&(c=this.x,d=this.y),super.render(),h._l10nPromise.get("editor_ink2_aria_label").then(g=>this.div?.setAttribute("aria-label",g));const[s,u,_,m]=this.#x();if(this.setAt(s,u,0,0),this.setDims(_,m),this.#_(),this.width){const[g,x]=this.parentDimensions;this.setAt(c*g,d*x,this.width*g,this.height*x),this.#a=!0,this.#b(),this.setDims(this.width*g,this.height*x),this.#d(),this.#L(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#v(),this.div}#b(){if(!this.#a)return;const[c,d]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*c),this.canvas.height=Math.ceil(this.height*d),this.#m()}setDimensions(c,d){const s=Math.round(c),u=Math.round(d);if(this.#f===s&&this.#o===u)return;this.#f=s,this.#o=u,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-c/d)>.01&&(d=Math.ceil(c/this.#t),this.setDims(c,d));const[_,m]=this.parentDimensions;this.width=c/_,this.height=d/m,this.#s&&this.#u(c,d),this.#b(),this.#d(),this.canvas.style.visibility="visible"}#u(c,d){const s=this.#I(),u=(c-s)/this.#n,_=(d-s)/this.#e;this.scaleFactor=Math.min(u,_)}#m(){const c=this.#I()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+c,this.translationY*this.scaleFactor+c)}static#M(c){const d=new Path2D;for(let s=0,u=c.length;s<u;s++){const[_,m,g,x]=c[s];s===0&&d.moveTo(..._),d.bezierCurveTo(m[0],m[1],g[0],g[1],x[0],x[1])}return d}#O(c,d,s,u){const m=[],g=this.thickness/2;let x,F;for(const v of this.paths){x=[],F=[];for(let r=0,f=v.length;r<f;r++){const[T,j,L,B]=v[r],U=c*(T[0]+d)+g,J=u-c*(T[1]+s)-g,rt=c*(j[0]+d)+g,Q=u-c*(j[1]+s)-g,$=c*(L[0]+d)+g,N=u-c*(L[1]+s)-g,q=c*(B[0]+d)+g,S=u-c*(B[1]+s)-g;r===0&&(x.push(U,J),F.push(U,J)),x.push(rt,Q,$,N,q,S),this.#D(U,J,rt,Q,$,N,q,S,4,F)}m.push({bezier:x,points:F})}return m}#D(c,d,s,u,_,m,g,x,F,v){if(this.#A(c,d,s,u,_,m,g,x)){v.push(g,x);return}for(let r=1;r<F-1;r++){const f=r/F,T=1-f;let j=f*c+T*s,L=f*d+T*u,B=f*s+T*_,U=f*u+T*m;const J=f*_+T*g,rt=f*m+T*x;j=f*j+T*B,L=f*L+T*U,B=f*B+T*J,U=f*U+T*rt,j=f*j+T*B,L=f*L+T*U,v.push(j,L)}v.push(g,x)}#A(c,d,s,u,_,m,g,x){const v=(3*s-2*c-g)**2,r=(3*u-2*d-x)**2,f=(3*_-c-2*g)**2,T=(3*m-d-2*x)**2;return Math.max(v,f)+Math.max(r,T)<=10}#S(){let c=1/0,d=-1/0,s=1/0,u=-1/0;for(const _ of this.paths)for(const[m,g,x,F]of _){const v=i.Util.bezierBoundingBox(...m,...g,...x,...F);c=Math.min(c,v[0]),s=Math.min(s,v[1]),d=Math.max(d,v[2]),u=Math.max(u,v[3])}return[c,s,d,u]}#I(){return this.#s?Math.ceil(this.thickness*this.parentScale):0}#E(c=!1){if(this.isEmpty())return;if(!this.#s){this.#d();return}const d=this.#S(),s=this.#I();this.#n=Math.max(M,d[2]-d[0]),this.#e=Math.max(M,d[3]-d[1]);const u=Math.ceil(s+this.#n*this.scaleFactor),_=Math.ceil(s+this.#e*this.scaleFactor),[m,g]=this.parentDimensions;this.width=u/m,this.height=_/g,this.#t=u/_,this.#L();const x=this.translationX,F=this.translationY;this.translationX=-d[0],this.translationY=-d[1],this.#b(),this.#d(),this.#f=u,this.#o=_,this.setDims(u,_);const v=c?s/this.scaleFactor/2:0;this.translate(x-this.translationX-v,F-this.translationY-v)}#L(){const{style:c}=this.div;this.#t>=1?(c.minHeight=`${M}px`,c.minWidth=`${Math.round(this.#t*M)}px`):(c.minWidth=`${M}px`,c.minHeight=`${Math.round(M/this.#t)}px`)}static deserialize(c,d,s){const u=super.deserialize(c,d,s);u.thickness=c.thickness,u.color=i.Util.makeHexColor(...c.color),u.opacity=c.opacity;const[_,m]=u.pageDimensions,g=u.width*_,x=u.height*m,F=u.parentScale,v=c.thickness/2;u.#t=g/x,u.#s=!0,u.#f=Math.round(g),u.#o=Math.round(x);for(const{bezier:f}of c.paths){const T=[];u.paths.push(T);let j=F*(f[0]-v),L=F*(x-f[1]-v);for(let U=2,J=f.length;U<J;U+=6){const rt=F*(f[U]-v),Q=F*(x-f[U+1]-v),$=F*(f[U+2]-v),N=F*(x-f[U+3]-v),q=F*(f[U+4]-v),S=F*(x-f[U+5]-v);T.push([[j,L],[rt,Q],[$,N],[q,S]]),j=q,L=S}const B=this.#M(T);u.bezierPath2D.push(B)}const r=u.#S();return u.#n=Math.max(M,r[2]-r[0]),u.#e=Math.max(M,r[3]-r[1]),u.#u(g,x),u}serialize(){if(this.isEmpty())return null;const c=this.getRect(0,0),d=this.rotation%180===0?c[3]-c[1]:c[2]-c[0],s=p.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:this.#O(this.scaleFactor/this.parentScale,this.translationX,this.translationY,d),pageIndex:this.pageIndex,rect:c,rotation:this.rotation}}}e.InkEditor=h},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fitCurve=void 0;const i=A(31);e.fitCurve=i},z=>{function e(u,_,m){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(v=>{if(!Array.isArray(v)||v.some(r=>typeof r!="number")||v.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((v,r)=>r===0||!v.every((f,T)=>f===u[r-1][T])),u.length<2)return[];const g=u.length,x=c(u[1],u[0]),F=c(u[g-2],u[g-1]);return A(u,x,F,_,m)}function A(u,_,m,g,x){var v,r,f,T,j,L,B,U,J,rt,Q,$,N;if(u.length===2)return $=d.vectorLen(d.subtract(u[0],u[1]))/3,v=[u[0],d.addArrays(u[0],d.mulItems(_,$)),d.addArrays(u[1],d.mulItems(m,$)),u[1]],[v];if(r=M(u),[v,T,L]=i(u,r,r,_,m,x),T===0||T<g)return[v];if(T<g*g)for(f=r,j=T,B=L,N=0;N<20;N++){if(f=O(v,u,f),[v,T,L]=i(u,r,f,_,m,x),T<g)return[v];if(L===B){let q=T/j;if(q>.9999&&q<1.0001)break}j=T,B=L}return Q=[],U=d.subtract(u[L-1],u[L+1]),U.every(q=>q===0)&&(U=d.subtract(u[L-1],u[L]),[U[0],U[1]]=[-U[1],U[0]]),J=d.normalize(U),rt=d.mulItems(J,-1),Q=Q.concat(A(u.slice(0,L+1),_,J,g,x)),Q=Q.concat(A(u.slice(L),rt,m,g,x)),Q}function i(u,_,m,g,x,F){var v,r,f;return v=p(u,m,g,x),[r,f]=C(u,v,_),F&&F({bez:v,points:u,params:_,maxErr:r,maxPoint:f}),[v,r,f]}function p(u,_,m,g){var x,F,v,r,f,T,j,L,B,U,J,rt,Q,$,N,q,S,l=u[0],n=u[u.length-1];for(x=[l,null,null,n],F=d.zeros_Xx2x2(_.length),Q=0,$=_.length;Q<$;Q++)q=_[Q],S=1-q,v=F[Q],v[0]=d.mulItems(m,3*q*(S*S)),v[1]=d.mulItems(g,3*S*(q*q));for(r=[[0,0],[0,0]],f=[0,0],Q=0,$=u.length;Q<$;Q++)q=_[Q],v=F[Q],r[0][0]+=d.dot(v[0],v[0]),r[0][1]+=d.dot(v[0],v[1]),r[1][0]+=d.dot(v[0],v[1]),r[1][1]+=d.dot(v[1],v[1]),N=d.subtract(u[Q],s.q([l,l,n,n],q)),f[0]+=d.dot(v[0],N),f[1]+=d.dot(v[1],N);return T=r[0][0]*r[1][1]-r[1][0]*r[0][1],j=r[0][0]*f[1]-r[1][0]*f[0],L=f[0]*r[1][1]-f[1]*r[0][1],B=T===0?0:L/T,U=T===0?0:j/T,rt=d.vectorLen(d.subtract(l,n)),J=1e-6*rt,B<J||U<J?(x[1]=d.addArrays(l,d.mulItems(m,rt/3)),x[2]=d.addArrays(n,d.mulItems(g,rt/3))):(x[1]=d.addArrays(l,d.mulItems(m,B)),x[2]=d.addArrays(n,d.mulItems(g,U))),x}function O(u,_,m){return m.map((g,x)=>w(u,_[x],g))}function w(u,_,m){var g=d.subtract(s.q(u,m),_),x=s.qprime(u,m),F=d.mulMatrix(g,x),v=d.sum(d.squareItems(x))+2*d.mulMatrix(g,s.qprimeprime(u,m));return v===0?m:m-F/v}function M(u){var _=[],m,g,x;return u.forEach((F,v)=>{m=v?g+d.vectorLen(d.subtract(F,x)):0,_.push(m),g=m,x=F}),_=_.map(F=>F/g),_}function C(u,_,m){var g,x,F,v,r,f,T,j;x=0,F=Math.floor(u.length/2);const L=h(_,10);for(r=0,f=u.length;r<f;r++)T=u[r],j=o(_,m[r],L,10),v=d.subtract(s.q(_,j),T),g=v[0]*v[0]+v[1]*v[1],g>x&&(x=g,F=r);return[x,F]}var h=function(u,_){for(var m,g=[0],x=u[0],F=0,v=1;v<=_;v++)m=s.q(u,v/_),F+=d.vectorLen(d.subtract(m,x)),g.push(F),x=m;return g=g.map(r=>r/F),g};function o(u,_,m,g){if(_<0)return 0;if(_>1)return 1;for(var x,F,v,r,f,T=1;T<=g;T++)if(_<=m[T]){r=(T-1)/g,v=T/g,F=m[T-1],x=m[T],f=(_-F)/(x-F)*(v-r)+r;break}return f}function c(u,_){return d.normalize(d.subtract(u,_))}class d{static zeros_Xx2x2(_){for(var m=[];_--;)m.push([0,0]);return m}static mulItems(_,m){return _.map(g=>g*m)}static mulMatrix(_,m){return _.reduce((g,x,F)=>g+x*m[F],0)}static subtract(_,m){return _.map((g,x)=>g-m[x])}static addArrays(_,m){return _.map((g,x)=>g+m[x])}static addItems(_,m){return _.map(g=>g+m)}static sum(_){return _.reduce((m,g)=>m+g)}static dot(_,m){return d.mulMatrix(_,m)}static vectorLen(_){return Math.hypot(..._)}static divItems(_,m){return _.map(g=>g/m)}static squareItems(_){return _.map(m=>m*m)}static normalize(_){return this.divItems(_,this.vectorLen(_))}}class s{static q(_,m){var g=1-m,x=d.mulItems(_[0],g*g*g),F=d.mulItems(_[1],3*g*g*m),v=d.mulItems(_[2],3*g*m*m),r=d.mulItems(_[3],m*m*m);return d.addArrays(d.addArrays(x,F),d.addArrays(v,r))}static qprime(_,m){var g=1-m,x=d.mulItems(d.subtract(_[1],_[0]),3*g*g),F=d.mulItems(d.subtract(_[2],_[1]),6*g*m),v=d.mulItems(d.subtract(_[3],_[2]),3*m*m);return d.addArrays(d.addArrays(x,F),v)}static qprimeprime(_,m){return d.addArrays(d.mulItems(d.addArrays(d.subtract(_[2],d.mulItems(_[1],2)),_[0]),6*(1-m)),d.mulItems(d.addArrays(d.subtract(_[3],d.mulItems(_[2],2)),_[1]),6*m))}}z.exports=e,z.exports.fitCubic=A,z.exports.createTangent=c},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var i=A(1),p=A(6),O=A(3),w=A(33),M=A(34);const C=1e3,h=9,o=new WeakSet;function c(k){return{width:k[2]-k[0],height:k[3]-k[1]}}class d{static create(t){switch(t.data.annotationType){case i.AnnotationType.LINK:return new u(t);case i.AnnotationType.TEXT:return new _(t);case i.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new g(t);case"Btn":return t.data.radioButton?new F(t):t.data.checkBox?new x(t):new v(t);case"Ch":return new r(t)}return new m(t);case i.AnnotationType.POPUP:return new f(t);case i.AnnotationType.FREETEXT:return new j(t);case i.AnnotationType.LINE:return new L(t);case i.AnnotationType.SQUARE:return new B(t);case i.AnnotationType.CIRCLE:return new U(t);case i.AnnotationType.POLYLINE:return new J(t);case i.AnnotationType.CARET:return new Q(t);case i.AnnotationType.INK:return new $(t);case i.AnnotationType.POLYGON:return new rt(t);case i.AnnotationType.HIGHLIGHT:return new N(t);case i.AnnotationType.UNDERLINE:return new q(t);case i.AnnotationType.SQUIGGLY:return new S(t);case i.AnnotationType.STRIKEOUT:return new l(t);case i.AnnotationType.STAMP:return new n(t);case i.AnnotationType.FILEATTACHMENT:return new y(t);default:return new s(t)}}}class s{constructor(t,{isRenderable:a=!1,ignoreBorder:b=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=a,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,a&&(this.container=this._createContainer(b)),P&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(t=!1){const{data:a,page:b,viewport:P}=this,E=document.createElement("section");E.setAttribute("data-annotation-id",a.id);const{pageWidth:I,pageHeight:D,pageX:X,pageY:G}=P.rawDims,{width:V,height:Z}=c(a.rect),Y=i.Util.normalizeRect([a.rect[0],b.view[3]-a.rect[1]+b.view[1],a.rect[2],b.view[3]-a.rect[3]+b.view[1]]);if(!t&&a.borderStyle.width>0){E.style.borderWidth=`${a.borderStyle.width}px`;const st=a.borderStyle.horizontalCornerRadius,nt=a.borderStyle.verticalCornerRadius;if(st>0||nt>0){const et=`calc(${st}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;E.style.borderRadius=et}else if(this instanceof F){const et=`calc(${V}px * var(--scale-factor)) / calc(${Z}px * var(--scale-factor))`;E.style.borderRadius=et}switch(a.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:E.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:E.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:E.style.borderBottomStyle="solid";break}const at=a.borderColor||null;at?E.style.borderColor=i.Util.makeHexColor(at[0]|0,at[1]|0,at[2]|0):E.style.borderWidth=0}E.style.left=`${100*(Y[0]-X)/I}%`,E.style.top=`${100*(Y[1]-G)/D}%`;const{rotation:tt}=a;return a.hasOwnCanvas||tt===0?(E.style.width=`${100*V/I}%`,E.style.height=`${100*Z/D}%`):this.setRotation(tt,E),E}setRotation(t,a=this.container){const{pageWidth:b,pageHeight:P}=this.viewport.rawDims,{width:E,height:I}=c(this.data.rect);let D,X;t%180===0?(D=100*E/b,X=100*I/P):(D=100*I/b,X=100*E/P),a.style.width=`${D}%`,a.style.height=`${X}%`,a.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(a,b,P)=>{const E=P.detail[a];P.target.style[b]=w.ColorConverters[`${E[0]}_HTML`](E.slice(1))};return(0,i.shadow)(this,"_commonActions",{display:a=>{const b=a.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:a.detail.display===0||a.detail.display===3})},print:a=>{this.annotationStorage.setValue(this.data.id,{print:a.detail.print})},hidden:a=>{this.container.style.visibility=a.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:a.detail.hidden})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.detail.readonly?a.target.setAttribute("readonly",""):a.target.removeAttribute("readonly")},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{t("bgColor","backgroundColor",a)},fillColor:a=>{t("fillColor","backgroundColor",a)},fgColor:a=>{t("fgColor","color",a)},textColor:a=>{t("textColor","color",a)},borderColor:a=>{t("borderColor","borderColor",a)},strokeColor:a=>{t("strokeColor","borderColor",a)},rotation:a=>{const b=a.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(t,a){const b=this._commonActions;for(const P of Object.keys(a.detail))(t[P]||b[P])?.(a)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const b=this._commonActions;for(const[P,E]of Object.entries(a)){const I=b[P];if(I){const D={detail:{[P]:E},target:t};I(D),delete a[P]}}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const a=[],b=this.data.rect;for(const P of this.data.quadPoints)this.data.rect=[P[2].x,P[2].y,P[1].x,P[1].y],a.push(this._createContainer(t));return this.data.rect=b,a}_createPopup(t,a){let b=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,b=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.className="popupTriggerArea",b.append(t));const E=new T({container:b,trigger:t,color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,hideWrapper:!0}).render();E.style.left="100%",b.append(E)}_renderQuadrilaterals(t){for(const a of this.quadrilaterals)a.className=t;return this.quadrilaterals}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,a=null){const b=[];if(this._fieldObjects){const P=this._fieldObjects[t];if(P)for(const{page:E,id:I,exportValues:D}of P){if(E===-1||I===a)continue;const X=typeof D=="string"?D:null,G=document.querySelector(`[data-element-id="${I}"]`);if(G&&!o.has(G)){(0,i.warn)(`_getElementsByName - element not allowed: ${I}`);continue}b.push({id:I,exportValue:X,domElement:G})}return b}for(const P of document.getElementsByName(t)){const{exportValue:E}=P,I=P.getAttribute("data-element-id");I!==a&&o.has(P)&&b.push({id:I,exportValue:E,domElement:P})}return b}}class u extends s{constructor(t,a=null){super(t,{isRenderable:!0,ignoreBorder:!!a?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:a}=this,b=document.createElement("a");b.setAttribute("data-element-id",t.id);let P=!1;return t.url?(a.addLinkAttributes(b,t.url,t.newWindow),P=!0):t.action?(this._bindNamedAction(b,t.action),P=!0):t.attachment?(this._bindAttachment(b,t.attachment),P=!0):t.setOCGState?(this.#e(b,t.setOCGState),P=!0):t.dest?(this._bindLink(b,t.dest),P=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(b,t),P=!0),t.resetForm?(this._bindResetFormAction(b,t.resetForm),P=!0):this.isTooltipOnly&&!P&&(this._bindLink(b,""),P=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((E,I)=>{const D=I===0?b:b.cloneNode();return E.append(D),E}):(this.container.className="linkAnnotation",P&&this.container.append(b),this.container)}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,a){t.href=this.linkService.getDestinationHash(a),t.onclick=()=>(a&&this.linkService.goToDestination(a),!1),(a||a==="")&&this.#t()}_bindNamedAction(t,a){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(a),!1),this.#t()}_bindAttachment(t,a){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,a.content,a.filename),!1),this.#t()}#e(t,a){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(a),!1),this.#t()}_bindJSAction(t,a){t.href=this.linkService.getAnchorUrl("");const b=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const P of Object.keys(a.actions)){const E=b.get(P);E&&(t[E]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a.id,name:P}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,a){const b=t.onclick;if(b||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),b||(t.onclick=()=>!1);return}t.onclick=()=>{b?.();const{fields:P,refs:E,include:I}=a,D=[];if(P.length!==0||E.length!==0){const V=new Set(E);for(const Z of P){const Y=this._fieldObjects[Z]||[];for(const{id:tt}of Y)V.add(tt)}for(const Z of Object.values(this._fieldObjects))for(const Y of Z)V.has(Y.id)===I&&D.push(Y)}else for(const V of Object.values(this._fieldObjects))D.push(...V);const X=this.annotationStorage,G=[];for(const V of D){const{id:Z}=V;switch(G.push(Z),V.type){case"text":{const tt=V.defaultValue||"";X.setValue(Z,{value:tt});break}case"checkbox":case"radiobutton":{const tt=V.defaultValue===V.exportValues;X.setValue(Z,{value:tt});break}case"combobox":case"listbox":{const tt=V.defaultValue||"";X.setValue(Z,{value:tt});break}default:continue}const Y=document.querySelector(`[data-element-id="${Z}"]`);if(Y){if(!o.has(Y)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${Z}`);continue}}else continue;Y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:G,name:"ResetForm"}}),!1}}}class _ extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class m extends s{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:a,isMac:b}=i.FeatureTest.platform;return a&&t.ctrlKey||b&&t.metaKey}_setEventListener(t,a,b,P){a.includes("mouse")?t.addEventListener(a,E=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:P(E),shift:E.shiftKey,modifier:this._getKeyModifier(E)}})}):t.addEventListener(a,E=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:P(E)}})})}_setEventListeners(t,a,b){for(const[P,E]of a)(E==="Action"||this.data.actions?.[E])&&this._setEventListener(t,P,E,b)}_setBackgroundColor(t){const a=this.data.backgroundColor||null;t.style.backgroundColor=a===null?"transparent":i.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(t){const a=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||h,E=t.style;let I;const D=2,X=G=>Math.round(10*G)/10;if(this.data.multiLine){const G=Math.abs(this.data.rect[3]-this.data.rect[1]-D),V=Math.round(G/(i.LINE_FACTOR*P))||1,Z=G/V;I=Math.min(P,X(Z/i.LINE_FACTOR))}else{const G=Math.abs(this.data.rect[3]-this.data.rect[1]-D);I=Math.min(P,X(G/i.LINE_FACTOR))}E.fontSize=`calc(${I}px * var(--scale-factor))`,E.color=i.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(E.textAlign=a[this.data.textAlignment])}_setRequired(t,a){a?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",a)}}class g extends m{constructor(t){const a=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:a})}setPropertyOnSiblings(t,a,b,P){const E=this.annotationStorage;for(const I of this._getElementsByName(t.name,t.id))I.domElement&&(I.domElement[a]=b),E.setValue(I.id,{[P]:b})}render(){const t=this.annotationStorage,a=this.data.id;this.container.className="textWidgetAnnotation";let b=null;if(this.renderForms){const P=t.getValue(a,{value:this.data.fieldValue});let E=P.formattedValue||P.value||"";const I=t.getValue(a,{charLimit:this.data.maxLen}).charLimit;I&&E.length>I&&(E=E.slice(0,I));const D={userValue:E,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=E,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",E),this.data.doNotScroll&&(b.style.overflowX="hidden")),o.add(b),b.setAttribute("data-element-id",a),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=C,this._setRequired(b,this.data.required),I&&(b.maxLength=I),b.addEventListener("input",G=>{t.setValue(a,{value:G.target.value}),this.setPropertyOnSiblings(b,"value",G.target.value,"value")}),b.addEventListener("resetform",G=>{const V=this.data.defaultFieldValue??"";b.value=D.userValue=V,D.formattedValue=null});let X=G=>{const{formattedValue:V}=D;V!=null&&(G.target.value=V),G.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",V=>{const{target:Z}=V;D.userValue&&(Z.value=D.userValue),D.lastCommittedValue=Z.value,D.commitKey=1}),b.addEventListener("updatefromsandbox",V=>{const Z={value(Y){D.userValue=Y.detail.value??"",t.setValue(a,{value:D.userValue.toString()}),Y.target.value=D.userValue},formattedValue(Y){const{formattedValue:tt}=Y.detail;D.formattedValue=tt,tt!=null&&Y.target!==document.activeElement&&(Y.target.value=tt),t.setValue(a,{formattedValue:tt})},selRange(Y){Y.target.setSelectionRange(...Y.detail.selRange)},charLimit:Y=>{const{charLimit:tt}=Y.detail,{target:st}=Y;if(tt===0){st.removeAttribute("maxLength");return}st.setAttribute("maxLength",tt);let nt=D.userValue;!nt||nt.length<=tt||(nt=nt.slice(0,tt),st.value=D.userValue=nt,t.setValue(a,{value:nt}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:nt,willCommit:!0,commitKey:1,selStart:st.selectionStart,selEnd:st.selectionEnd}}))}};this._dispatchEventFromSandbox(Z,V)}),b.addEventListener("keydown",V=>{D.commitKey=1;let Z=-1;if(V.key==="Escape"?Z=0:V.key==="Enter"&&!this.data.multiLine?Z=2:V.key==="Tab"&&(D.commitKey=3),Z===-1)return;const{value:Y}=V.target;D.lastCommittedValue!==Y&&(D.lastCommittedValue=Y,D.userValue=Y,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Y,willCommit:!0,commitKey:Z,selStart:V.target.selectionStart,selEnd:V.target.selectionEnd}}))});const G=X;X=null,b.addEventListener("blur",V=>{if(!V.relatedTarget)return;const{value:Z}=V.target;D.userValue=Z,D.lastCommittedValue!==Z&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Z,willCommit:!0,commitKey:D.commitKey,selStart:V.target.selectionStart,selEnd:V.target.selectionEnd}}),G(V)}),this.data.actions?.Keystroke&&b.addEventListener("beforeinput",V=>{D.lastCommittedValue=null;const{data:Z,target:Y}=V,{value:tt,selectionStart:st,selectionEnd:nt}=Y;let at=st,et=nt;switch(V.inputType){case"deleteWordBackward":{const ct=tt.substring(0,st).match(/\w*[^\w]*$/);ct&&(at-=ct[0].length);break}case"deleteWordForward":{const ct=tt.substring(st).match(/^[^\w]*\w*/);ct&&(et+=ct[0].length);break}case"deleteContentBackward":st===nt&&(at-=1);break;case"deleteContentForward":st===nt&&(et+=1);break}V.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:tt,change:Z||"",willCommit:!1,selStart:at,selEnd:et}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.value)}if(X&&b.addEventListener("blur",X),this.data.comb){const V=(this.data.rect[2]-this.data.rect[0])/I;b.classList.add("comb"),b.style.letterSpacing=`calc(${V}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class x extends m{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,a=this.data,b=a.id;let P=t.getValue(b,{value:a.exportValue===a.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",t.setValue(b,{value:P})),this.container.className="buttonWidgetAnnotation checkBox";const E=document.createElement("input");return o.add(E),E.setAttribute("data-element-id",b),E.disabled=a.readOnly,this._setRequired(E,this.data.required),E.type="checkbox",E.name=a.fieldName,P&&E.setAttribute("checked",!0),E.setAttribute("exportValue",a.exportValue),E.tabIndex=C,E.addEventListener("change",I=>{const{name:D,checked:X}=I.target;for(const G of this._getElementsByName(D,b)){const V=X&&G.exportValue===a.exportValue;G.domElement&&(G.domElement.checked=V),t.setValue(G.id,{value:V})}t.setValue(b,{value:X})}),E.addEventListener("resetform",I=>{const D=a.defaultFieldValue||"Off";I.target.checked=D===a.exportValue}),this.enableScripting&&this.hasJSActions&&(E.addEventListener("updatefromsandbox",I=>{const D={value(X){X.target.checked=X.detail.value!=="Off",t.setValue(b,{value:X.target.checked})}};this._dispatchEventFromSandbox(D,I)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.checked)),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class F extends m{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,a=this.data,b=a.id;let P=t.getValue(b,{value:a.fieldValue===a.buttonValue}).value;typeof P=="string"&&(P=P!==a.buttonValue,t.setValue(b,{value:P}));const E=document.createElement("input");if(o.add(E),E.setAttribute("data-element-id",b),E.disabled=a.readOnly,this._setRequired(E,this.data.required),E.type="radio",E.name=a.fieldName,P&&E.setAttribute("checked",!0),E.tabIndex=C,E.addEventListener("change",I=>{const{name:D,checked:X}=I.target;for(const G of this._getElementsByName(D,b))t.setValue(G.id,{value:!1});t.setValue(b,{value:X})}),E.addEventListener("resetform",I=>{const D=a.defaultFieldValue;I.target.checked=D!=null&&D===a.buttonValue}),this.enableScripting&&this.hasJSActions){const I=a.buttonValue;E.addEventListener("updatefromsandbox",D=>{const X={value:G=>{const V=I===G.detail.value;for(const Z of this._getElementsByName(G.target.name)){const Y=V&&Z.id===b;Z.domElement&&(Z.domElement.checked=Y),t.setValue(Z.id,{value:Y})}}};this._dispatchEventFromSandbox(X,D)}),this._setEventListeners(E,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],D=>D.target.checked)}return this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class v extends u{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText);const a=t.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),t}}class r extends m{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,a=this.data.id,b=t.getValue(a,{value:this.data.fieldValue}),P=document.createElement("select");o.add(P),P.setAttribute("data-element-id",a),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=C;let E=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",V=>{const Z=this.data.defaultFieldValue;for(const Y of P.options)Y.selected=Y.value===Z});for(const V of this.data.options){const Z=document.createElement("option");Z.textContent=V.displayValue,Z.value=V.exportValue,b.value.includes(V.exportValue)&&(Z.setAttribute("selected",!0),E=!1),P.append(Z)}let I=null;if(E){const V=document.createElement("option");V.value=" ",V.setAttribute("hidden",!0),V.setAttribute("selected",!0),P.prepend(V),I=()=>{V.remove(),P.removeEventListener("input",I),I=null},P.addEventListener("input",I)}const D=V=>{const Z=V?"value":"textContent",{options:Y,multiple:tt}=P;return tt?Array.prototype.filter.call(Y,st=>st.selected).map(st=>st[Z]):Y.selectedIndex===-1?null:Y[Y.selectedIndex][Z]};let X=D(!1);const G=V=>{const Z=V.target.options;return Array.prototype.map.call(Z,Y=>({displayValue:Y.textContent,exportValue:Y.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",V=>{const Z={value(Y){I?.();const tt=Y.detail.value,st=new Set(Array.isArray(tt)?tt:[tt]);for(const nt of P.options)nt.selected=st.has(nt.value);t.setValue(a,{value:D(!0)}),X=D(!1)},multipleSelection(Y){P.multiple=!0},remove(Y){const tt=P.options,st=Y.detail.remove;tt[st].selected=!1,P.remove(st),tt.length>0&&Array.prototype.findIndex.call(tt,at=>at.selected)===-1&&(tt[0].selected=!0),t.setValue(a,{value:D(!0),items:G(Y)}),X=D(!1)},clear(Y){for(;P.length!==0;)P.remove(0);t.setValue(a,{value:null,items:[]}),X=D(!1)},insert(Y){const{index:tt,displayValue:st,exportValue:nt}=Y.detail.insert,at=P.children[tt],et=document.createElement("option");et.textContent=st,et.value=nt,at?at.before(et):P.append(et),t.setValue(a,{value:D(!0),items:G(Y)}),X=D(!1)},items(Y){const{items:tt}=Y.detail;for(;P.length!==0;)P.remove(0);for(const st of tt){const{displayValue:nt,exportValue:at}=st,et=document.createElement("option");et.textContent=nt,et.value=at,P.append(et)}P.options.length>0&&(P.options[0].selected=!0),t.setValue(a,{value:D(!0),items:G(Y)}),X=D(!1)},indices(Y){const tt=new Set(Y.detail.indices);for(const st of Y.target.options)st.selected=tt.has(st.index);t.setValue(a,{value:D(!0)}),X=D(!1)},editable(Y){Y.target.disabled=!Y.detail.editable}};this._dispatchEventFromSandbox(Z,V)}),P.addEventListener("input",V=>{const Z=D(!0);t.setValue(a,{value:Z}),V.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:X,changeEx:Z,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],V=>V.target.checked)):P.addEventListener("input",function(V){t.setValue(a,{value:D(!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class f extends s{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(t){const{data:a}=t,b=!f.IGNORE_TYPES.has(a.parentType)&&!!(a.titleObj?.str||a.contentsObj?.str||a.richText?.str);super(t,{isRenderable:b})}render(){this.container.className="popupAnnotation";const t=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(t.length===0)return this.container;const a=new T({container:this.container,trigger:Array.from(t),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,P=i.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),E=P[0]+this.data.parentRect[2]-this.data.parentRect[0],I=P[1],{pageWidth:D,pageHeight:X,pageX:G,pageY:V}=this.viewport.rawDims;return this.container.style.left=`${100*(E-G)/D}%`,this.container.style.top=`${100*(I-V)/X}%`,this.container.append(a.render()),this.container}}class T{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const a=document.createElement("div");a.className="popupWrapper",this.hideElement=this.hideWrapper?a:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.className="popup";const P=this.color;if(P){const D=.7*(255-P[0])+P[0],X=.7*(255-P[1])+P[1],G=.7*(255-P[2])+P[2];b.style.backgroundColor=i.Util.makeHexColor(D|0,X|0,G|0)}const E=document.createElement("h1");E.dir=this.titleObj.dir,E.textContent=this.titleObj.str,b.append(E);const I=p.PDFDateString.toDateObject(this.modificationDate);if(I){const D=document.createElement("span");D.className="popupDate",D.textContent="{{date}}, {{time}}",D.dataset.l10nId="annotation_date_string",D.dataset.l10nArgs=JSON.stringify({date:I.toLocaleDateString(),time:I.toLocaleTimeString()}),b.append(D)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))M.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.className="richText popupContent";else{const D=this._formatContents(this.contentsObj);b.append(D)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const D of this.trigger)D.addEventListener("click",this._toggle.bind(this)),D.addEventListener("mouseover",this._show.bind(this,!1)),D.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),a.append(b),a}_formatContents({str:t,dir:a}){const b=document.createElement("p");b.className="popupContent",b.dir=a;const P=t.split(/(?:\r\n?|\n)/);for(let E=0,I=P.length;E<I;++E){const D=P[E];b.append(document.createTextNode(D)),E<I-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class j extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const t=document.createElement("div");t.className="annotationTextContent",t.setAttribute("role","comment");for(const a of this.textContent){const b=document.createElement("span");b.textContent=a,t.append(b)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class L extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,{width:a,height:b}=c(t.rect),P=this.svgFactory.create(a,b,!0),E=this.svgFactory.createElement("svg:line");return E.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),E.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),E.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),E.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),E.setAttribute("stroke-width",t.borderStyle.width||1),E.setAttribute("stroke","transparent"),E.setAttribute("fill","transparent"),P.append(E),this.container.append(P),this._createPopup(E,t),this.container}}class B extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,{width:a,height:b}=c(t.rect),P=this.svgFactory.create(a,b,!0),E=t.borderStyle.width,I=this.svgFactory.createElement("svg:rect");return I.setAttribute("x",E/2),I.setAttribute("y",E/2),I.setAttribute("width",a-E),I.setAttribute("height",b-E),I.setAttribute("stroke-width",E||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),P.append(I),this.container.append(P),this._createPopup(I,t),this.container}}class U extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,{width:a,height:b}=c(t.rect),P=this.svgFactory.create(a,b,!0),E=t.borderStyle.width,I=this.svgFactory.createElement("svg:ellipse");return I.setAttribute("cx",a/2),I.setAttribute("cy",b/2),I.setAttribute("rx",a/2-E/2),I.setAttribute("ry",b/2-E/2),I.setAttribute("stroke-width",E||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),P.append(I),this.container.append(P),this._createPopup(I,t),this.container}}class J extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:a,height:b}=c(t.rect),P=this.svgFactory.create(a,b,!0);let E=[];for(const D of t.vertices){const X=D.x-t.rect[0],G=t.rect[3]-D.y;E.push(X+","+G)}E=E.join(" ");const I=this.svgFactory.createElement(this.svgElementName);return I.setAttribute("points",E),I.setAttribute("stroke-width",t.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),P.append(I),this.container.append(P),this._createPopup(I,t),this.container}}class rt extends J{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class $ extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,{width:a,height:b}=c(t.rect),P=this.svgFactory.create(a,b,!0);for(const E of t.inkLists){let I=[];for(const X of E){const G=X.x-t.rect[0],V=t.rect[3]-X.y;I.push(`${G},${V}`)}I=I.join(" ");const D=this.svgFactory.createElement(this.svgElementName);D.setAttribute("points",I),D.setAttribute("stroke-width",t.borderStyle.width||1),D.setAttribute("stroke","transparent"),D.setAttribute("fill","transparent"),this._createPopup(D,t),P.append(D)}return this.container.append(P),this.container}}class N extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class q extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class S extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class l extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class n extends s{constructor(t){const a=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class y extends s{constructor(t){super(t,{isRenderable:!0});const{filename:a,content:b}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(a,!0),this.content=b,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:a,content:b})}render(){this.container.className="fileAttachmentAnnotation";let t;return this.data.hasAppearance?t=document.createElement("div"):(t=document.createElement("img"),t.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),t.className="popupTriggerArea",t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class R{static#t(t,a,b,P){const E=t.firstChild||t;E.id=`${p.AnnotationPrefix}${a}`,b.append(t),P?.moveElementInDOM(b,t,E,!1)}static render(t){const{annotations:a,div:b,viewport:P,accessibilityManager:E}=t;(0,p.setLayerDimensions)(b,P);const I={data:null,layer:b,page:t.page,viewport:P,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:t.annotationStorage||new O.AnnotationStorage,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects};let D=0;for(const X of a){if(X.annotationType!==i.AnnotationType.POPUP){const{width:Z,height:Y}=c(X.rect);if(Z<=0||Y<=0)continue}I.data=X;const G=d.create(I);if(!G.isRenderable)continue;const V=G.render();if(X.hidden&&(V.style.visibility="hidden"),Array.isArray(V))for(const Z of V)Z.style.zIndex=D++,R.#t(Z,X.id,b,E);else V.style.zIndex=D++,G instanceof f?b.prepend(V):R.#t(V,X.id,b,E)}this.#e(b,t.annotationCanvasMap)}static update(t){const{annotationCanvasMap:a,div:b,viewport:P}=t;(0,p.setLayerDimensions)(b,{rotation:P.rotation}),this.#e(b,a),b.hidden=!1}static#e(t,a){if(a){for(const[b,P]of a){const E=t.querySelector(`[data-annotation-id="${b}"]`);if(!E)continue;const{firstChild:I}=E;I?I.nodeName==="CANVAS"?I.replaceWith(P):I.before(P):E.append(P)}a.clear()}}}e.AnnotationLayer=R},(z,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function A(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}class i{static CMYK_G([O,w,M,C]){return["G",1-Math.min(1,.3*O+.59*M+.11*w+C)]}static G_CMYK([O]){return["CMYK",0,0,0,1-O]}static G_RGB([O]){return["RGB",O,O,O]}static G_HTML([O]){const w=A(O);return`#${w}${w}${w}`}static RGB_G([O,w,M]){return["G",.3*O+.59*w+.11*M]}static RGB_HTML([O,w,M]){const C=A(O),h=A(w),o=A(M);return`#${C}${h}${o}`}static T_HTML(){return"#00000000"}static CMYK_RGB([O,w,M,C]){return["RGB",1-Math.min(1,O+C),1-Math.min(1,M+C),1-Math.min(1,w+C)]}static CMYK_HTML(O){const w=this.CMYK_RGB(O).slice(1);return this.RGB_HTML(w)}static RGB_CMYK([O,w,M]){const C=1-O,h=1-w,o=1-M,c=Math.min(C,h,o);return["CMYK",C,h,o,c]}}e.ColorConverters=i},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var i=A(19);class p{static setupStorage(w,M,C,h,o){const c=h.getValue(M,{value:null});switch(C.name){case"textarea":if(c.value!==null&&(w.textContent=c.value),o==="print")break;w.addEventListener("input",d=>{h.setValue(M,{value:d.target.value})});break;case"input":if(C.attributes.type==="radio"||C.attributes.type==="checkbox"){if(c.value===C.attributes.xfaOn?w.setAttribute("checked",!0):c.value===C.attributes.xfaOff&&w.removeAttribute("checked"),o==="print")break;w.addEventListener("change",d=>{h.setValue(M,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&w.setAttribute("value",c.value),o==="print")break;w.addEventListener("input",d=>{h.setValue(M,{value:d.target.value})})}break;case"select":if(c.value!==null)for(const d of C.children)d.attributes.value===c.value&&(d.attributes.selected=!0);w.addEventListener("input",d=>{const s=d.target.options,u=s.selectedIndex===-1?"":s[s.selectedIndex].value;h.setValue(M,{value:u})});break}}static setAttributes({html:w,element:M,storage:C=null,intent:h,linkService:o}){const{attributes:c}=M,d=w instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${h}`);for(const[s,u]of Object.entries(c))if(u!=null)switch(s){case"class":u.length&&w.setAttribute(s,u.join(" "));break;case"dataId":break;case"id":w.setAttribute("data-element-id",u);break;case"style":Object.assign(w.style,u);break;case"textContent":w.textContent=u;break;default:(!d||s!=="href"&&s!=="newWindow")&&w.setAttribute(s,u)}d&&o.addLinkAttributes(w,c.href,c.newWindow),C&&c.dataId&&this.setupStorage(w,c.dataId,M,C)}static render(w){const M=w.annotationStorage,C=w.linkService,h=w.xfaHtml,o=w.intent||"display",c=document.createElement(h.name);h.attributes&&this.setAttributes({html:c,element:h,intent:o,linkService:C});const d=[[h,-1,c]],s=w.div;if(s.append(c),w.viewport){const _=`matrix(${w.viewport.transform.join(",")})`;s.style.transform=_}o!=="richText"&&s.setAttribute("class","xfaLayer xfaFont");const u=[];for(;d.length>0;){const[_,m,g]=d.at(-1);if(m+1===_.children.length){d.pop();continue}const x=_.children[++d.at(-1)[1]];if(x===null)continue;const{name:F}=x;if(F==="#text"){const r=document.createTextNode(x.value);u.push(r),g.append(r);continue}let v;if(x?.attributes?.xmlns?v=document.createElementNS(x.attributes.xmlns,F):v=document.createElement(F),g.append(v),x.attributes&&this.setAttributes({html:v,element:x,storage:M,intent:o,linkService:C}),x.children&&x.children.length>0)d.push([x,-1,v]);else if(x.value){const r=document.createTextNode(x.value);i.XfaText.shouldBuildText(F)&&u.push(r),v.append(r)}}for(const _ of s.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:u}}static update(w){const M=`matrix(${w.viewport.transform.join(",")})`;w.div.style.transform=M,w.div.hidden=!1}}e.XfaLayer=p},(z,e,A)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var i=A(6),p=A(1),O=A(10);let w=class{constructor(){(0,p.unreachable)("Not implemented: SVGGraphics")}};e.SVGGraphics=w;{let _=function(r){let f=[];const T=[];for(const j of r){if(j.fn==="save"){f.push({fnId:92,fn:"group",items:[]}),T.push(f),f=f.at(-1).items;continue}j.fn==="restore"?f=T.pop():f.push(j)}return f},m=function(r){if(Number.isInteger(r))return r.toString();const f=r.toFixed(10);let T=f.length-1;if(f[T]!=="0")return f;do T--;while(f[T]==="0");return f.substring(0,f[T]==="."?T:T+1)},g=function(r){if(r[4]===0&&r[5]===0){if(r[1]===0&&r[2]===0)return r[0]===1&&r[3]===1?"":`scale(${m(r[0])} ${m(r[3])})`;if(r[0]===r[3]&&r[1]===-r[2]){const f=Math.acos(r[0])*180/Math.PI;return`rotate(${m(f)})`}}else if(r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1)return`translate(${m(r[4])} ${m(r[5])})`;return`matrix(${m(r[0])} ${m(r[1])} ${m(r[2])} ${m(r[3])} ${m(r[4])} ${m(r[5])})`};const M={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},C="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",o=["butt","round","square"],c=["miter","round","bevel"],d=function(r,f="",T=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!T)return URL.createObjectURL(new Blob([r],{type:f}));const j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let L=`data:${f};base64,`;for(let B=0,U=r.length;B<U;B+=3){const J=r[B]&255,rt=r[B+1]&255,Q=r[B+2]&255,$=J>>2,N=(J&3)<<4|rt>>4,q=B+1<U?(rt&15)<<2|Q>>6:64,S=B+2<U?Q&63:64;L+=j[$]+j[N]+j[q]+j[S]}return L},s=function(){const r=new Uint8Array([137,80,78,71,13,10,26,10]),f=12,T=new Int32Array(256);for(let Q=0;Q<256;Q++){let $=Q;for(let N=0;N<8;N++)$&1?$=3988292384^$>>1&2147483647:$=$>>1&2147483647;T[Q]=$}function j(Q,$,N){let q=-1;for(let S=$;S<N;S++){const l=(q^Q[S])&255,n=T[l];q=q>>>8^n}return q^-1}function L(Q,$,N,q){let S=q;const l=$.length;N[S]=l>>24&255,N[S+1]=l>>16&255,N[S+2]=l>>8&255,N[S+3]=l&255,S+=4,N[S]=Q.charCodeAt(0)&255,N[S+1]=Q.charCodeAt(1)&255,N[S+2]=Q.charCodeAt(2)&255,N[S+3]=Q.charCodeAt(3)&255,S+=4,N.set($,S),S+=$.length;const n=j(N,q+4,S);N[S]=n>>24&255,N[S+1]=n>>16&255,N[S+2]=n>>8&255,N[S+3]=n&255}function B(Q,$,N){let q=1,S=0;for(let l=$;l<N;++l)q=(q+(Q[l]&255))%65521,S=(S+q)%65521;return S<<16|q}function U(Q){if(!O.isNodeJS)return J(Q);try{let $;parseInt(process.versions.node)>=8?$=Q:$=Buffer.from(Q);const N=require$$5.deflateSync($,{level:9});return N instanceof Uint8Array?N:new Uint8Array(N)}catch($){(0,p.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+$)}return J(Q)}function J(Q){let $=Q.length;const N=65535,q=Math.ceil($/N),S=new Uint8Array(2+$+q*5+4);let l=0;S[l++]=120,S[l++]=156;let n=0;for(;$>N;)S[l++]=0,S[l++]=255,S[l++]=255,S[l++]=0,S[l++]=0,S.set(Q.subarray(n,n+N),l),l+=N,n+=N,$-=N;S[l++]=1,S[l++]=$&255,S[l++]=$>>8&255,S[l++]=~$&65535&255,S[l++]=(~$&65535)>>8&255,S.set(Q.subarray(n),l),l+=Q.length-n;const y=B(Q,0,Q.length);return S[l++]=y>>24&255,S[l++]=y>>16&255,S[l++]=y>>8&255,S[l++]=y&255,S}function rt(Q,$,N,q){const S=Q.width,l=Q.height;let n,y,R;const k=Q.data;switch($){case p.ImageKind.GRAYSCALE_1BPP:y=0,n=1,R=S+7>>3;break;case p.ImageKind.RGB_24BPP:y=2,n=8,R=S*3;break;case p.ImageKind.RGBA_32BPP:y=6,n=8,R=S*4;break;default:throw new Error("invalid format")}const t=new Uint8Array((1+R)*l);let a=0,b=0;for(let G=0;G<l;++G)t[a++]=0,t.set(k.subarray(b,b+R),a),b+=R,a+=R;if($===p.ImageKind.GRAYSCALE_1BPP&&q){a=0;for(let G=0;G<l;G++){a++;for(let V=0;V<R;V++)t[a++]^=255}}const P=new Uint8Array([S>>24&255,S>>16&255,S>>8&255,S&255,l>>24&255,l>>16&255,l>>8&255,l&255,n,y,0,0,0]),E=U(t),I=r.length+f*3+P.length+E.length,D=new Uint8Array(I);let X=0;return D.set(r,X),X+=r.length,L("IHDR",P,D,X),X+=f+P.length,L("IDATA",E,D,X),X+=f+E.length,L("IEND",new Uint8Array(0),D,X),d(D,"image/png",N)}return function($,N,q){const S=$.kind===void 0?p.ImageKind.GRAYSCALE_1BPP:$.kind;return rt($,S,N,q)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=M.fontWeight,this.fontSize=0,this.textMatrix=p.IDENTITY_MATRIX,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=p.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=M.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(f,T){this.x=f,this.y=T}}let x=0,F=0,v=0;e.SVGGraphics=w=class{constructor(r,f,T=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new u,this.transformMatrix=p.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=r,this.objs=f,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!T,this._operatorIdMapping=[];for(const j in p.OPS)this._operatorIdMapping[p.OPS[j]]=j}getObject(r,f=null){return typeof r=="string"?r.startsWith("g_")?this.commonObjs.get(r):this.objs.get(r):f}save(){this.transformStack.push(this.transformMatrix);const r=this.current;this.extraStack.push(r),this.current=r.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(r){this.save(),this.executeOpTree(r),this.restore()}loadDependencies(r){const f=r.fnArray,T=r.argsArray;for(let j=0,L=f.length;j<L;j++)if(f[j]===p.OPS.dependency)for(const B of T[j]){const U=B.startsWith("g_")?this.commonObjs:this.objs,J=new Promise(rt=>{U.get(B,rt)});this.current.dependencies.push(J)}return Promise.all(this.current.dependencies)}transform(r,f,T,j,L,B){const U=[r,f,T,j,L,B];this.transformMatrix=p.Util.transform(this.transformMatrix,U),this.tgrp=null}getSVG(r,f){this.viewport=f;const T=this._initialize(f);return this.loadDependencies(r).then(()=>(this.transformMatrix=p.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(r)),T))}convertOpList(r){const f=this._operatorIdMapping,T=r.argsArray,j=r.fnArray,L=[];for(let B=0,U=j.length;B<U;B++){const J=j[B];L.push({fnId:J,fn:f[J],args:T[B]})}return _(L)}executeOpTree(r){for(const f of r){const T=f.fn,j=f.fnId,L=f.args;switch(j|0){case p.OPS.beginText:this.beginText();break;case p.OPS.dependency:break;case p.OPS.setLeading:this.setLeading(L);break;case p.OPS.setLeadingMoveText:this.setLeadingMoveText(L[0],L[1]);break;case p.OPS.setFont:this.setFont(L);break;case p.OPS.showText:this.showText(L[0]);break;case p.OPS.showSpacedText:this.showText(L[0]);break;case p.OPS.endText:this.endText();break;case p.OPS.moveText:this.moveText(L[0],L[1]);break;case p.OPS.setCharSpacing:this.setCharSpacing(L[0]);break;case p.OPS.setWordSpacing:this.setWordSpacing(L[0]);break;case p.OPS.setHScale:this.setHScale(L[0]);break;case p.OPS.setTextMatrix:this.setTextMatrix(L[0],L[1],L[2],L[3],L[4],L[5]);break;case p.OPS.setTextRise:this.setTextRise(L[0]);break;case p.OPS.setTextRenderingMode:this.setTextRenderingMode(L[0]);break;case p.OPS.setLineWidth:this.setLineWidth(L[0]);break;case p.OPS.setLineJoin:this.setLineJoin(L[0]);break;case p.OPS.setLineCap:this.setLineCap(L[0]);break;case p.OPS.setMiterLimit:this.setMiterLimit(L[0]);break;case p.OPS.setFillRGBColor:this.setFillRGBColor(L[0],L[1],L[2]);break;case p.OPS.setStrokeRGBColor:this.setStrokeRGBColor(L[0],L[1],L[2]);break;case p.OPS.setStrokeColorN:this.setStrokeColorN(L);break;case p.OPS.setFillColorN:this.setFillColorN(L);break;case p.OPS.shadingFill:this.shadingFill(L[0]);break;case p.OPS.setDash:this.setDash(L[0],L[1]);break;case p.OPS.setRenderingIntent:this.setRenderingIntent(L[0]);break;case p.OPS.setFlatness:this.setFlatness(L[0]);break;case p.OPS.setGState:this.setGState(L[0]);break;case p.OPS.fill:this.fill();break;case p.OPS.eoFill:this.eoFill();break;case p.OPS.stroke:this.stroke();break;case p.OPS.fillStroke:this.fillStroke();break;case p.OPS.eoFillStroke:this.eoFillStroke();break;case p.OPS.clip:this.clip("nonzero");break;case p.OPS.eoClip:this.clip("evenodd");break;case p.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case p.OPS.paintImageXObject:this.paintImageXObject(L[0]);break;case p.OPS.paintInlineImageXObject:this.paintInlineImageXObject(L[0]);break;case p.OPS.paintImageMaskXObject:this.paintImageMaskXObject(L[0]);break;case p.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(L[0],L[1]);break;case p.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case p.OPS.closePath:this.closePath();break;case p.OPS.closeStroke:this.closeStroke();break;case p.OPS.closeFillStroke:this.closeFillStroke();break;case p.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case p.OPS.nextLine:this.nextLine();break;case p.OPS.transform:this.transform(L[0],L[1],L[2],L[3],L[4],L[5]);break;case p.OPS.constructPath:this.constructPath(L[0],L[1]);break;case p.OPS.endPath:this.endPath();break;case 92:this.group(f.items);break;default:(0,p.warn)(`Unimplemented operator ${T}`);break}}}setWordSpacing(r){this.current.wordSpacing=r}setCharSpacing(r){this.current.charSpacing=r}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(r,f,T,j,L,B){const U=this.current;U.textMatrix=U.lineMatrix=[r,f,T,j,L,B],U.textMatrixScale=Math.hypot(r,f),U.x=U.lineX=0,U.y=U.lineY=0,U.xcoords=[],U.ycoords=[],U.tspan=this.svgFactory.createElement("svg:tspan"),U.tspan.setAttributeNS(null,"font-family",U.fontFamily),U.tspan.setAttributeNS(null,"font-size",`${m(U.fontSize)}px`),U.tspan.setAttributeNS(null,"y",m(-U.y)),U.txtElement=this.svgFactory.createElement("svg:text"),U.txtElement.append(U.tspan)}beginText(){const r=this.current;r.x=r.lineX=0,r.y=r.lineY=0,r.textMatrix=p.IDENTITY_MATRIX,r.lineMatrix=p.IDENTITY_MATRIX,r.textMatrixScale=1,r.tspan=this.svgFactory.createElement("svg:tspan"),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtgrp=this.svgFactory.createElement("svg:g"),r.xcoords=[],r.ycoords=[]}moveText(r,f){const T=this.current;T.x=T.lineX+=r,T.y=T.lineY+=f,T.xcoords=[],T.ycoords=[],T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size",`${m(T.fontSize)}px`),T.tspan.setAttributeNS(null,"y",m(-T.y))}showText(r){const f=this.current,T=f.font,j=f.fontSize;if(j===0)return;const L=f.fontSizeScale,B=f.charSpacing,U=f.wordSpacing,J=f.fontDirection,rt=f.textHScale*J,Q=T.vertical,$=Q?1:-1,N=T.defaultVMetrics,q=j*f.fontMatrix[0];let S=0;for(const y of r){if(y===null){S+=J*U;continue}else if(typeof y=="number"){S+=$*y*j/1e3;continue}const R=(y.isSpace?U:0)+B,k=y.fontChar;let t,a,b=y.width;if(Q){let E;const I=y.vmetric||N;E=y.vmetric?I[1]:b*.5,E=-E*q;const D=I[2]*q;b=I?-I[0]:b,t=E/L,a=(S+D)/L}else t=S/L,a=0;(y.isInFont||T.missingFile)&&(f.xcoords.push(f.x+t),Q&&f.ycoords.push(-f.y+a),f.tspan.textContent+=k);let P;Q?P=b*q-R*J:P=b*q+R*J,S+=P}f.tspan.setAttributeNS(null,"x",f.xcoords.map(m).join(" ")),Q?f.tspan.setAttributeNS(null,"y",f.ycoords.map(m).join(" ")):f.tspan.setAttributeNS(null,"y",m(-f.y)),Q?f.y-=S:f.x+=S*rt,f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${m(f.fontSize)}px`),f.fontStyle!==M.fontStyle&&f.tspan.setAttributeNS(null,"font-style",f.fontStyle),f.fontWeight!==M.fontWeight&&f.tspan.setAttributeNS(null,"font-weight",f.fontWeight);const l=f.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;if(l===p.TextRenderingMode.FILL||l===p.TextRenderingMode.FILL_STROKE?(f.fillColor!==M.fillColor&&f.tspan.setAttributeNS(null,"fill",f.fillColor),f.fillAlpha<1&&f.tspan.setAttributeNS(null,"fill-opacity",f.fillAlpha)):f.textRenderingMode===p.TextRenderingMode.ADD_TO_PATH?f.tspan.setAttributeNS(null,"fill","transparent"):f.tspan.setAttributeNS(null,"fill","none"),l===p.TextRenderingMode.STROKE||l===p.TextRenderingMode.FILL_STROKE){const y=1/(f.textMatrixScale||1);this._setStrokeAttributes(f.tspan,y)}let n=f.textMatrix;f.textRise!==0&&(n=n.slice(),n[5]+=f.textRise),f.txtElement.setAttributeNS(null,"transform",`${g(n)} scale(${m(rt)}, -1)`),f.txtElement.setAttributeNS(C,"xml:space","preserve"),f.txtElement.append(f.tspan),f.txtgrp.append(f.txtElement),this._ensureTransformGroup().append(f.txtElement)}setLeadingMoveText(r,f){this.setLeading(-f),this.moveText(r,f)}addFontStyle(r){if(!r.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const f=d(r.data,r.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${r.loadedName}"; src: url(${f}); }
`}setFont(r){const f=this.current,T=this.commonObjs.get(r[0]);let j=r[1];f.font=T,this.embedFonts&&!T.missingFile&&!this.embeddedFonts[T.loadedName]&&(this.addFontStyle(T),this.embeddedFonts[T.loadedName]=T),f.fontMatrix=T.fontMatrix||p.FONT_IDENTITY_MATRIX;let L="normal";T.black?L="900":T.bold&&(L="bold");const B=T.italic?"italic":"normal";j<0?(j=-j,f.fontDirection=-1):f.fontDirection=1,f.fontSize=j,f.fontFamily=T.loadedName,f.fontWeight=L,f.fontStyle=B,f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"y",m(-f.y)),f.xcoords=[],f.ycoords=[]}endText(){const r=this.current;r.textRenderingMode&p.TextRenderingMode.ADD_TO_PATH_FLAG&&r.txtElement?.hasChildNodes()&&(r.element=r.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(r){r>0&&(this.current.lineWidth=r)}setLineCap(r){this.current.lineCap=o[r]}setLineJoin(r){this.current.lineJoin=c[r]}setMiterLimit(r){this.current.miterLimit=r}setStrokeAlpha(r){this.current.strokeAlpha=r}setStrokeRGBColor(r,f,T){this.current.strokeColor=p.Util.makeHexColor(r,f,T)}setFillAlpha(r){this.current.fillAlpha=r}setFillRGBColor(r,f,T){this.current.fillColor=p.Util.makeHexColor(r,f,T),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(r){this.current.strokeColor=this._makeColorN_Pattern(r)}setFillColorN(r){this.current.fillColor=this._makeColorN_Pattern(r)}shadingFill(r){const f=this.viewport.width,T=this.viewport.height,j=p.Util.inverseTransform(this.transformMatrix),L=p.Util.applyTransform([0,0],j),B=p.Util.applyTransform([0,T],j),U=p.Util.applyTransform([f,0],j),J=p.Util.applyTransform([f,T],j),rt=Math.min(L[0],B[0],U[0],J[0]),Q=Math.min(L[1],B[1],U[1],J[1]),$=Math.max(L[0],B[0],U[0],J[0]),N=Math.max(L[1],B[1],U[1],J[1]),q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x",rt),q.setAttributeNS(null,"y",Q),q.setAttributeNS(null,"width",$-rt),q.setAttributeNS(null,"height",N-Q),q.setAttributeNS(null,"fill",this._makeShadingPattern(r)),this.current.fillAlpha<1&&q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(q)}_makeColorN_Pattern(r){return r[0]==="TilingPattern"?this._makeTilingPattern(r):this._makeShadingPattern(r)}_makeTilingPattern(r){const f=r[1],T=r[2],j=r[3]||p.IDENTITY_MATRIX,[L,B,U,J]=r[4],rt=r[5],Q=r[6],$=r[7],N=`shading${v++}`,[q,S,l,n]=p.Util.normalizeRect([...p.Util.applyTransform([L,B],j),...p.Util.applyTransform([U,J],j)]),[y,R]=p.Util.singularValueDecompose2dScale(j),k=rt*y,t=Q*R,a=this.svgFactory.createElement("svg:pattern");a.setAttributeNS(null,"id",N),a.setAttributeNS(null,"patternUnits","userSpaceOnUse"),a.setAttributeNS(null,"width",k),a.setAttributeNS(null,"height",t),a.setAttributeNS(null,"x",`${q}`),a.setAttributeNS(null,"y",`${S}`);const b=this.svg,P=this.transformMatrix,E=this.current.fillColor,I=this.current.strokeColor,D=this.svgFactory.create(l-q,n-S);if(this.svg=D,this.transformMatrix=j,$===2){const X=p.Util.makeHexColor(...f);this.current.fillColor=X,this.current.strokeColor=X}return this.executeOpTree(this.convertOpList(T)),this.svg=b,this.transformMatrix=P,this.current.fillColor=E,this.current.strokeColor=I,a.append(D.childNodes[0]),this.defs.append(a),`url(#${N})`}_makeShadingPattern(r){switch(typeof r=="string"&&(r=this.objs.get(r)),r[0]){case"RadialAxial":const f=`shading${v++}`,T=r[3];let j;switch(r[1]){case"axial":const L=r[4],B=r[5];j=this.svgFactory.createElement("svg:linearGradient"),j.setAttributeNS(null,"id",f),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"x1",L[0]),j.setAttributeNS(null,"y1",L[1]),j.setAttributeNS(null,"x2",B[0]),j.setAttributeNS(null,"y2",B[1]);break;case"radial":const U=r[4],J=r[5],rt=r[6],Q=r[7];j=this.svgFactory.createElement("svg:radialGradient"),j.setAttributeNS(null,"id",f),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"cx",J[0]),j.setAttributeNS(null,"cy",J[1]),j.setAttributeNS(null,"r",Q),j.setAttributeNS(null,"fx",U[0]),j.setAttributeNS(null,"fy",U[1]),j.setAttributeNS(null,"fr",rt);break;default:throw new Error(`Unknown RadialAxial type: ${r[1]}`)}for(const L of T){const B=this.svgFactory.createElement("svg:stop");B.setAttributeNS(null,"offset",L[0]),B.setAttributeNS(null,"stop-color",L[1]),j.append(B)}return this.defs.append(j),`url(#${f})`;case"Mesh":return(0,p.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${r[0]}`)}}setDash(r,f){this.current.dashArray=r,this.current.dashPhase=f}constructPath(r,f){const T=this.current;let j=T.x,L=T.y,B=[],U=0;for(const J of r)switch(J|0){case p.OPS.rectangle:j=f[U++],L=f[U++];const rt=f[U++],Q=f[U++],$=j+rt,N=L+Q;B.push("M",m(j),m(L),"L",m($),m(L),"L",m($),m(N),"L",m(j),m(N),"Z");break;case p.OPS.moveTo:j=f[U++],L=f[U++],B.push("M",m(j),m(L));break;case p.OPS.lineTo:j=f[U++],L=f[U++],B.push("L",m(j),m(L));break;case p.OPS.curveTo:j=f[U+4],L=f[U+5],B.push("C",m(f[U]),m(f[U+1]),m(f[U+2]),m(f[U+3]),m(j),m(L)),U+=6;break;case p.OPS.curveTo2:B.push("C",m(j),m(L),m(f[U]),m(f[U+1]),m(f[U+2]),m(f[U+3])),j=f[U+2],L=f[U+3],U+=4;break;case p.OPS.curveTo3:j=f[U+2],L=f[U+3],B.push("C",m(f[U]),m(f[U+1]),m(j),m(L),m(j),m(L)),U+=4;break;case p.OPS.closePath:B.push("Z");break}B=B.join(" "),T.path&&r.length>0&&r[0]!==p.OPS.rectangle&&r[0]!==p.OPS.moveTo?B=T.path.getAttributeNS(null,"d")+B:(T.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(T.path)),T.path.setAttributeNS(null,"d",B),T.path.setAttributeNS(null,"fill","none"),T.element=T.path,T.setCurrentPoint(j,L)}endPath(){const r=this.current;if(r.path=null,!this.pendingClip)return;if(!r.element){this.pendingClip=null;return}const f=`clippath${x++}`,T=this.svgFactory.createElement("svg:clipPath");T.setAttributeNS(null,"id",f),T.setAttributeNS(null,"transform",g(this.transformMatrix));const j=r.element.cloneNode(!0);if(this.pendingClip==="evenodd"?j.setAttributeNS(null,"clip-rule","evenodd"):j.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,T.append(j),this.defs.append(T),r.activeClipUrl){r.clipGroup=null;for(const L of this.extraStack)L.clipGroup=null;T.setAttributeNS(null,"clip-path",r.activeClipUrl)}r.activeClipUrl=`url(#${f})`,this.tgrp=null}clip(r){this.pendingClip=r}closePath(){const r=this.current;if(r.path){const f=`${r.path.getAttributeNS(null,"d")}Z`;r.path.setAttributeNS(null,"d",f)}}setLeading(r){this.current.leading=-r}setTextRise(r){this.current.textRise=r}setTextRenderingMode(r){this.current.textRenderingMode=r}setHScale(r){this.current.textHScale=r/100}setRenderingIntent(r){}setFlatness(r){}setGState(r){for(const[f,T]of r)switch(f){case"LW":this.setLineWidth(T);break;case"LC":this.setLineCap(T);break;case"LJ":this.setLineJoin(T);break;case"ML":this.setMiterLimit(T);break;case"D":this.setDash(T[0],T[1]);break;case"RI":this.setRenderingIntent(T);break;case"FL":this.setFlatness(T);break;case"Font":this.setFont(T);break;case"CA":this.setStrokeAlpha(T);break;case"ca":this.setFillAlpha(T);break;default:(0,p.warn)(`Unimplemented graphic state operator ${f}`);break}}fill(){const r=this.current;r.element&&(r.element.setAttributeNS(null,"fill",r.fillColor),r.element.setAttributeNS(null,"fill-opacity",r.fillAlpha),this.endPath())}stroke(){const r=this.current;r.element&&(this._setStrokeAttributes(r.element),r.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(r,f=1){const T=this.current;let j=T.dashArray;f!==1&&j.length>0&&(j=j.map(function(L){return f*L})),r.setAttributeNS(null,"stroke",T.strokeColor),r.setAttributeNS(null,"stroke-opacity",T.strokeAlpha),r.setAttributeNS(null,"stroke-miterlimit",m(T.miterLimit)),r.setAttributeNS(null,"stroke-linecap",T.lineCap),r.setAttributeNS(null,"stroke-linejoin",T.lineJoin),r.setAttributeNS(null,"stroke-width",m(f*T.lineWidth)+"px"),r.setAttributeNS(null,"stroke-dasharray",j.map(m).join(" ")),r.setAttributeNS(null,"stroke-dashoffset",m(f*T.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","1px"),r.setAttributeNS(null,"height","1px"),r.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(r)}paintImageXObject(r){const f=this.getObject(r);if(!f){(0,p.warn)(`Dependent image with object ID ${r} is not ready yet`);return}this.paintInlineImageXObject(f)}paintInlineImageXObject(r,f){const T=r.width,j=r.height,L=s(r,this.forceDataSchema,!!f),B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y","0"),B.setAttributeNS(null,"width",m(T)),B.setAttributeNS(null,"height",m(j)),this.current.element=B,this.clip("nonzero");const U=this.svgFactory.createElement("svg:image");U.setAttributeNS(h,"xlink:href",L),U.setAttributeNS(null,"x","0"),U.setAttributeNS(null,"y",m(-j)),U.setAttributeNS(null,"width",m(T)+"px"),U.setAttributeNS(null,"height",m(j)+"px"),U.setAttributeNS(null,"transform",`scale(${m(1/T)} ${m(-1/j)})`),f?f.append(U):this._ensureTransformGroup().append(U)}paintImageMaskXObject(r){const f=this.getObject(r.data,r);if(f.bitmap){(0,p.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const T=this.current,j=f.width,L=f.height,B=T.fillColor;T.maskId=`mask${F++}`;const U=this.svgFactory.createElement("svg:mask");U.setAttributeNS(null,"id",T.maskId);const J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x","0"),J.setAttributeNS(null,"y","0"),J.setAttributeNS(null,"width",m(j)),J.setAttributeNS(null,"height",m(L)),J.setAttributeNS(null,"fill",B),J.setAttributeNS(null,"mask",`url(#${T.maskId})`),this.defs.append(U),this._ensureTransformGroup().append(J),this.paintInlineImageXObject(f,U)}paintFormXObjectBegin(r,f){if(Array.isArray(r)&&r.length===6&&this.transform(r[0],r[1],r[2],r[3],r[4],r[5]),f){const T=f[2]-f[0],j=f[3]-f[1],L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x",f[0]),L.setAttributeNS(null,"y",f[1]),L.setAttributeNS(null,"width",m(T)),L.setAttributeNS(null,"height",m(j)),this.current.element=L,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(r){const f=this.svgFactory.create(r.width,r.height),T=this.svgFactory.createElement("svg:defs");f.append(T),this.defs=T;const j=this.svgFactory.createElement("svg:g");return j.setAttributeNS(null,"transform",g(r.transform)),f.append(j),this.svg=j,f}_ensureClipGroup(){if(!this.current.clipGroup){const r=this.svgFactory.createElement("svg:g");r.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(r),this.current.clipGroup=r}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(z){var e=__webpack_module_cache__[z];if(e!==void 0)return e.exports;var A=__webpack_module_cache__[z]={exports:{}};return __webpack_modules__[z](A,A.exports,__w_pdfjs_require__),A.exports}var __webpack_exports__={};return(()=>{var z=__webpack_exports__;Object.defineProperty(z,"__esModule",{value:!0}),Object.defineProperty(z,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(z,"AnnotationEditorLayer",{enumerable:!0,get:function(){return O.AnnotationEditorLayer}}),Object.defineProperty(z,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(z,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(z,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return w.AnnotationEditorUIManager}}),Object.defineProperty(z,"AnnotationLayer",{enumerable:!0,get:function(){return M.AnnotationLayer}}),Object.defineProperty(z,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(z,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(z,"GlobalWorkerOptions",{enumerable:!0,get:function(){return C.GlobalWorkerOptions}}),Object.defineProperty(z,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(z,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(z,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(z,"PDFDataRangeTransport",{enumerable:!0,get:function(){return A.PDFDataRangeTransport}}),Object.defineProperty(z,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(z,"PDFWorker",{enumerable:!0,get:function(){return A.PDFWorker}}),Object.defineProperty(z,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(z,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(z,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(z,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(z,"SVGGraphics",{enumerable:!0,get:function(){return h.SVGGraphics}}),Object.defineProperty(z,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return e.UNSUPPORTED_FEATURES}}),Object.defineProperty(z,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(z,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(z,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(z,"XfaLayer",{enumerable:!0,get:function(){return o.XfaLayer}}),Object.defineProperty(z,"build",{enumerable:!0,get:function(){return A.build}}),Object.defineProperty(z,"createPromiseCapability",{enumerable:!0,get:function(){return e.createPromiseCapability}}),Object.defineProperty(z,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(z,"getDocument",{enumerable:!0,get:function(){return A.getDocument}}),Object.defineProperty(z,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(z,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(z,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(z,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(z,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(z,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(z,"renderTextLayer",{enumerable:!0,get:function(){return p.renderTextLayer}}),Object.defineProperty(z,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(z,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(z,"updateTextLayer",{enumerable:!0,get:function(){return p.updateTextLayer}}),Object.defineProperty(z,"version",{enumerable:!0,get:function(){return A.version}});var e=__w_pdfjs_require__(1),A=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),p=__w_pdfjs_require__(26),O=__w_pdfjs_require__(27),w=__w_pdfjs_require__(5),M=__w_pdfjs_require__(32),C=__w_pdfjs_require__(14),h=__w_pdfjs_require__(35),o=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$2);const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
