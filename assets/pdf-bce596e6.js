import{g as getAugmentedNamespace,a as getDefaultExportFromCjs,c as commonjsRequire}from"./_commonjs-dynamic-modules-3f1b5830.js";function _mergeNamespaces(L,s){for(var x=0;x<s.length;x++){const a=s[x];if(typeof a!="string"&&!Array.isArray(a)){for(const b in a)if(b!=="default"&&!(b in L)){const M=Object.getOwnPropertyDescriptor(a,b);M&&Object.defineProperty(L,b,M.get?M:{enumerable:!0,get:()=>a[b]})}}}return Object.freeze(Object.defineProperty(L,Symbol.toStringTag,{value:"Module"}))}var pdfExports={},pdf$2={get exports(){return pdfExports},set exports(L){pdfExports=L}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(s,x){module.exports=x()})(globalThis,()=>(()=>{var __webpack_modules__=[,(L,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.VerbosityLevel=s.Util=s.UnknownErrorException=s.UnexpectedResponseException=s.TextRenderingMode=s.RenderingIntentFlag=s.PermissionFlag=s.PasswordResponses=s.PasswordException=s.PageActionEventType=s.OPS=s.MissingPDFException=s.MAX_IMAGE_SIZE_TO_CACHE=s.LINE_FACTOR=s.LINE_DESCENT_FACTOR=s.InvalidPDFException=s.ImageKind=s.IDENTITY_MATRIX=s.FormatError=s.FeatureTest=s.FONT_IDENTITY_MATRIX=s.DocumentActionEventType=s.CMapCompressionType=s.BaseException=s.BASELINE_FACTOR=s.AnnotationType=s.AnnotationStateModelType=s.AnnotationReviewState=s.AnnotationReplyType=s.AnnotationMode=s.AnnotationMarkedState=s.AnnotationFlag=s.AnnotationFieldFlag=s.AnnotationEditorType=s.AnnotationEditorPrefix=s.AnnotationEditorParamsType=s.AnnotationBorderStyleType=s.AnnotationActionEventType=s.AbortException=void 0,s.assert=o,s.bytesToString=U,s.createPromiseCapability=_t,s.createValidAbsoluteUrl=T,s.getModificationDate=Pt,s.getVerbosityLevel=I,s.info=N,s.isArrayBuffer=St,s.isArrayEqual=yt,s.objectFromMap=et,s.objectSize=Y,s.setVerbosityLevel=V,s.shadow=e,s.string32=tt,s.stringToBytes=$,s.stringToPDFString=gt,s.stringToUTF8String=mt,s.unreachable=l,s.utf8StringToString=dt,s.warn=E;const x=[1,0,0,1,0,0];s.IDENTITY_MATRIX=x;const a=[.001,0,0,.001,0,0];s.FONT_IDENTITY_MATRIX=a;const b=1e7;s.MAX_IMAGE_SIZE_TO_CACHE=b;const M=1.35;s.LINE_FACTOR=M;const F=.35;s.LINE_DESCENT_FACTOR=F;const j=F/M;s.BASELINE_FACTOR=j;const v={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};s.RenderingIntentFlag=v;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};s.AnnotationMode=m;const t="pdfjs_internal_editor_";s.AnnotationEditorPrefix=t;const c={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};s.AnnotationEditorType=c;const f={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};s.AnnotationEditorParamsType=f;const n={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};s.PermissionFlag=n;const u={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};s.TextRenderingMode=u;const _={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};s.ImageKind=_;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};s.AnnotationType=g;const d={MARKED:"Marked",REVIEW:"Review"};s.AnnotationStateModelType=d;const w={MARKED:"Marked",UNMARKED:"Unmarked"};s.AnnotationMarkedState=w;const D={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};s.AnnotationReviewState=D;const S={GROUP:"Group",REPLY:"R"};s.AnnotationReplyType=S;const r={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};s.AnnotationFlag=r;const p={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};s.AnnotationFieldFlag=p;const P={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};s.AnnotationBorderStyleType=P;const B={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};s.AnnotationActionEventType=B;const O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};s.DocumentActionEventType=O;const H={O:"PageOpen",C:"PageClose"};s.PageActionEventType=H;const q={ERRORS:0,WARNINGS:1,INFOS:5};s.VerbosityLevel=q;const K={NONE:0,BINARY:1};s.CMapCompressionType=K;const it={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};s.OPS=it;const J={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};s.PasswordResponses=J;let Z=q.WARNINGS;function V(Q){Number.isInteger(Q)&&(Z=Q)}function I(){return Z}function N(Q){Z>=q.INFOS&&console.log(`Info: ${Q}`)}function E(Q){Z>=q.WARNINGS&&console.log(`Warning: ${Q}`)}function l(Q){throw new Error(Q)}function o(Q,X){Q||l(X)}function A(Q){if(!Q)return!1;switch(Q.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function T(Q,X=null,G=null){if(!Q)return null;try{if(G&&typeof Q=="string"){if(G.addDefaultProtocol&&Q.startsWith("www.")){const ct=Q.match(/\./g);ct&&ct.length>=2&&(Q=`http://${Q}`)}if(G.tryConvertEncoding)try{Q=mt(Q)}catch{}}const rt=X?new URL(Q,X):new URL(Q);if(A(rt))return rt}catch{}return null}function e(Q,X,G,rt=!1){return Object.defineProperty(Q,X,{value:G,enumerable:!rt,configurable:!0,writable:!1}),G}const i=function(){function X(G,rt){this.constructor===X&&l("Cannot initialize BaseException."),this.message=G,this.name=rt}return X.prototype=new Error,X.constructor=X,X}();s.BaseException=i;class h extends i{constructor(X,G){super(X,"PasswordException"),this.code=G}}s.PasswordException=h;class y extends i{constructor(X,G){super(X,"UnknownErrorException"),this.details=G}}s.UnknownErrorException=y;class C extends i{constructor(X){super(X,"InvalidPDFException")}}s.InvalidPDFException=C;class k extends i{constructor(X){super(X,"MissingPDFException")}}s.MissingPDFException=k;class R extends i{constructor(X,G){super(X,"UnexpectedResponseException"),this.status=G}}s.UnexpectedResponseException=R;class W extends i{constructor(X){super(X,"FormatError")}}s.FormatError=W;class z extends i{constructor(X){super(X,"AbortException")}}s.AbortException=z;function U(Q){(typeof Q!="object"||Q===null||Q.length===void 0)&&l("Invalid argument for bytesToString");const X=Q.length,G=8192;if(X<G)return String.fromCharCode.apply(null,Q);const rt=[];for(let ct=0;ct<X;ct+=G){const ft=Math.min(ct+G,X),pt=Q.subarray(ct,ft);rt.push(String.fromCharCode.apply(null,pt))}return rt.join("")}function $(Q){typeof Q!="string"&&l("Invalid argument for stringToBytes");const X=Q.length,G=new Uint8Array(X);for(let rt=0;rt<X;++rt)G[rt]=Q.charCodeAt(rt)&255;return G}function tt(Q){return String.fromCharCode(Q>>24&255,Q>>16&255,Q>>8&255,Q&255)}function Y(Q){return Object.keys(Q).length}function et(Q){const X=Object.create(null);for(const[G,rt]of Q)X[G]=rt;return X}function st(){const Q=new Uint8Array(4);return Q[0]=1,new Uint32Array(Q.buffer,0,1)[0]===1}function nt(){try{return new Function(""),!0}catch{return!1}}class at{static get isLittleEndian(){return e(this,"isLittleEndian",st())}static get isEvalSupported(){return e(this,"isEvalSupported",nt())}static get isOffscreenCanvasSupported(){return e(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?e(this,"platform",{isWin:!1,isMac:!1}):e(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}s.FeatureTest=at;const ot=[...Array(256).keys()].map(Q=>Q.toString(16).padStart(2,"0"));class ht{static makeHexColor(X,G,rt){return`#${ot[X]}${ot[G]}${ot[rt]}`}static scaleMinMax(X,G){let rt;X[0]?(X[0]<0&&(rt=G[0],G[0]=G[1],G[1]=rt),G[0]*=X[0],G[1]*=X[0],X[3]<0&&(rt=G[2],G[2]=G[3],G[3]=rt),G[2]*=X[3],G[3]*=X[3]):(rt=G[0],G[0]=G[2],G[2]=rt,rt=G[1],G[1]=G[3],G[3]=rt,X[1]<0&&(rt=G[2],G[2]=G[3],G[3]=rt),G[2]*=X[1],G[3]*=X[1],X[2]<0&&(rt=G[0],G[0]=G[1],G[1]=rt),G[0]*=X[2],G[1]*=X[2]),G[0]+=X[4],G[1]+=X[4],G[2]+=X[5],G[3]+=X[5]}static transform(X,G){return[X[0]*G[0]+X[2]*G[1],X[1]*G[0]+X[3]*G[1],X[0]*G[2]+X[2]*G[3],X[1]*G[2]+X[3]*G[3],X[0]*G[4]+X[2]*G[5]+X[4],X[1]*G[4]+X[3]*G[5]+X[5]]}static applyTransform(X,G){const rt=X[0]*G[0]+X[1]*G[2]+G[4],ct=X[0]*G[1]+X[1]*G[3]+G[5];return[rt,ct]}static applyInverseTransform(X,G){const rt=G[0]*G[3]-G[1]*G[2],ct=(X[0]*G[3]-X[1]*G[2]+G[2]*G[5]-G[4]*G[3])/rt,ft=(-X[0]*G[1]+X[1]*G[0]+G[4]*G[1]-G[5]*G[0])/rt;return[ct,ft]}static getAxialAlignedBoundingBox(X,G){const rt=ht.applyTransform(X,G),ct=ht.applyTransform(X.slice(2,4),G),ft=ht.applyTransform([X[0],X[3]],G),pt=ht.applyTransform([X[2],X[1]],G);return[Math.min(rt[0],ct[0],ft[0],pt[0]),Math.min(rt[1],ct[1],ft[1],pt[1]),Math.max(rt[0],ct[0],ft[0],pt[0]),Math.max(rt[1],ct[1],ft[1],pt[1])]}static inverseTransform(X){const G=X[0]*X[3]-X[1]*X[2];return[X[3]/G,-X[1]/G,-X[2]/G,X[0]/G,(X[2]*X[5]-X[4]*X[3])/G,(X[4]*X[1]-X[5]*X[0])/G]}static singularValueDecompose2dScale(X){const G=[X[0],X[2],X[1],X[3]],rt=X[0]*G[0]+X[1]*G[2],ct=X[0]*G[1]+X[1]*G[3],ft=X[2]*G[0]+X[3]*G[2],pt=X[2]*G[1]+X[3]*G[3],Ct=(rt+pt)/2,Tt=Math.sqrt((rt+pt)**2-4*(rt*pt-ft*ct))/2,Et=Ct+Tt||1,bt=Ct-Tt||1;return[Math.sqrt(Et),Math.sqrt(bt)]}static normalizeRect(X){const G=X.slice(0);return X[0]>X[2]&&(G[0]=X[2],G[2]=X[0]),X[1]>X[3]&&(G[1]=X[3],G[3]=X[1]),G}static intersect(X,G){const rt=Math.max(Math.min(X[0],X[2]),Math.min(G[0],G[2])),ct=Math.min(Math.max(X[0],X[2]),Math.max(G[0],G[2]));if(rt>ct)return null;const ft=Math.max(Math.min(X[1],X[3]),Math.min(G[1],G[3])),pt=Math.min(Math.max(X[1],X[3]),Math.max(G[1],G[3]));return ft>pt?null:[rt,ft,ct,pt]}static bezierBoundingBox(X,G,rt,ct,ft,pt,Ct,Tt){const Et=[],bt=[[],[]];let xt,vt,Ft,ut,Rt,Mt,Dt,Ot;for(let It=0;It<2;++It){if(It===0?(vt=6*X-12*rt+6*ft,xt=-3*X+9*rt-9*ft+3*Ct,Ft=3*rt-3*X):(vt=6*G-12*ct+6*pt,xt=-3*G+9*ct-9*pt+3*Tt,Ft=3*ct-3*G),Math.abs(xt)<1e-12){if(Math.abs(vt)<1e-12)continue;ut=-Ft/vt,0<ut&&ut<1&&Et.push(ut);continue}Dt=vt*vt-4*Ft*xt,Ot=Math.sqrt(Dt),!(Dt<0)&&(Rt=(-vt+Ot)/(2*xt),0<Rt&&Rt<1&&Et.push(Rt),Mt=(-vt-Ot)/(2*xt),0<Mt&&Mt<1&&Et.push(Mt))}let wt=Et.length,At;const kt=wt;for(;wt--;)ut=Et[wt],At=1-ut,bt[0][wt]=At*At*At*X+3*At*At*ut*rt+3*At*ut*ut*ft+ut*ut*ut*Ct,bt[1][wt]=At*At*At*G+3*At*At*ut*ct+3*At*ut*ut*pt+ut*ut*ut*Tt;return bt[0][kt]=X,bt[1][kt]=G,bt[0][kt+1]=Ct,bt[1][kt+1]=Tt,bt[0].length=bt[1].length=kt+2,[Math.min(...bt[0]),Math.min(...bt[1]),Math.max(...bt[0]),Math.max(...bt[1])]}}s.Util=ht;const lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(Q){if(Q[0]>="ï"){let G;if(Q[0]==="þ"&&Q[1]==="ÿ"?G="utf-16be":Q[0]==="ÿ"&&Q[1]==="þ"?G="utf-16le":Q[0]==="ï"&&Q[1]==="»"&&Q[2]==="¿"&&(G="utf-8"),G)try{const rt=new TextDecoder(G,{fatal:!0}),ct=$(Q);return rt.decode(ct)}catch(rt){E(`stringToPDFString: "${rt}".`)}}const X=[];for(let G=0,rt=Q.length;G<rt;G++){const ct=lt[Q.charCodeAt(G)];X.push(ct?String.fromCharCode(ct):Q.charAt(G))}return X.join("")}function mt(Q){return decodeURIComponent(escape(Q))}function dt(Q){return unescape(encodeURIComponent(Q))}function St(Q){return typeof Q=="object"&&Q!==null&&Q.byteLength!==void 0}function yt(Q,X){if(Q.length!==X.length)return!1;for(let G=0,rt=Q.length;G<rt;G++)if(Q[G]!==X[G])return!1;return!0}function Pt(Q=new Date){return[Q.getUTCFullYear().toString(),(Q.getUTCMonth()+1).toString().padStart(2,"0"),Q.getUTCDate().toString().padStart(2,"0"),Q.getUTCHours().toString().padStart(2,"0"),Q.getUTCMinutes().toString().padStart(2,"0"),Q.getUTCSeconds().toString().padStart(2,"0")].join("")}function _t(){const Q=Object.create(null);let X=!1;return Object.defineProperty(Q,"settled",{get(){return X}}),Q.promise=new Promise(function(G,rt){Q.resolve=function(ct){X=!0,G(ct)},Q.reject=function(ct){X=!0,rt(ct)}}),Q}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:L,NodeCMapReaderFactory:s,NodeFilterFactory:x,NodeStandardFontDataFactory:a}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=L,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=x,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=a}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:L}=__w_pdfjs_require__(21);createPDFNetworkStream=s=>new L(s)}else{const{PDFNetworkStream:L}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=x=>(0,_display_utils.isValidFetchUrl)(x.url)?new s(x):new L(x)}function getDocument(L){if(typeof L=="string"||L instanceof URL?L={url:L}:(0,_util.isArrayBuffer)(L)&&(L={data:L}),typeof L!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!L.url&&!L.data&&!L.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:x}=s,a=L.url?getUrlProp(L.url):null,b=L.data?getDataProp(L.data):null,M=L.httpHeaders||null,F=L.withCredentials===!0,j=L.password??null,v=L.range instanceof PDFDataRangeTransport?L.range:null,m=Number.isInteger(L.rangeChunkSize)&&L.rangeChunkSize>0?L.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=L.worker instanceof _PDFWorker?L.worker:null;const c=L.verbosity,f=typeof L.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(L.docBaseUrl)?L.docBaseUrl:null,n=typeof L.cMapUrl=="string"?L.cMapUrl:null,u=L.cMapPacked!==!1,_=L.CMapReaderFactory||DefaultCMapReaderFactory,g=typeof L.standardFontDataUrl=="string"?L.standardFontDataUrl:null,d=L.StandardFontDataFactory||DefaultStandardFontDataFactory,w=L.stopAtErrors!==!0,D=Number.isInteger(L.maxImageSize)&&L.maxImageSize>-1?L.maxImageSize:-1,S=L.isEvalSupported!==!1,r=typeof L.isOffscreenCanvasSupported=="boolean"?L.isOffscreenCanvasSupported:!_is_node.isNodeJS,p=Number.isInteger(L.canvasMaxAreaInBytes)?L.canvasMaxAreaInBytes:-1,P=typeof L.disableFontFace=="boolean"?L.disableFontFace:_is_node.isNodeJS,B=L.fontExtraProperties===!0,O=L.enableXfa===!0,H=L.ownerDocument||globalThis.document,q=L.disableRange===!0,K=L.disableStream===!0,it=L.disableAutoFetch===!0,J=L.pdfBug===!0,Z=v?v.length:L.length??NaN,V=typeof L.useSystemFonts=="boolean"?L.useSystemFonts:!_is_node.isNodeJS&&!P,I=typeof L.useWorkerFetch=="boolean"?L.useWorkerFetch:_===_display_utils.DOMCMapReaderFactory&&d===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(g,document.baseURI),N=L.canvasFactory||new DefaultCanvasFactory({ownerDocument:H}),E=L.filterFactory||new DefaultFilterFactory({docId:x,ownerDocument:H}),l=null;(0,_util.setVerbosityLevel)(c);const o={canvasFactory:N,filterFactory:E};if(I||(o.cMapReaderFactory=new _({baseUrl:n,isCompressed:u}),o.standardFontDataFactory=new d({baseUrl:g})),!t){const e={verbosity:c,port:_worker_options.GlobalWorkerOptions.workerPort};t=e.port?_PDFWorker.fromPort(e):new _PDFWorker(e),s._worker=t}const A={docId:x,apiVersion:"3.5.141",data:b,password:j,disableAutoFetch:it,rangeChunkSize:m,length:Z,docBaseUrl:f,enableXfa:O,evaluatorOptions:{maxImageSize:D,disableFontFace:P,ignoreErrors:w,isEvalSupported:S,isOffscreenCanvasSupported:r,canvasMaxAreaInBytes:p,fontExtraProperties:B,useSystemFonts:V,cMapUrl:I?n:null,standardFontDataUrl:I?g:null}},T={ignoreErrors:w,isEvalSupported:S,disableFontFace:P,fontExtraProperties:B,enableXfa:O,ownerDocument:H,disableAutoFetch:it,pdfBug:J,styleElement:l};return t.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(t,A),i=new Promise(function(h){let y;v?y=new _transport_stream.PDFDataTransportStream({length:Z,initialData:v.initialData,progressiveDone:v.progressiveDone,contentDispositionFilename:v.contentDispositionFilename,disableRange:q,disableStream:K},v):b||(y=createPDFNetworkStream({url:a,length:Z,httpHeaders:M,withCredentials:F,rangeChunkSize:m,disableRange:q,disableStream:K})),h(y)});return Promise.all([e,i]).then(function([h,y]){if(s.destroyed)throw new Error("Loading aborted");const C=new _message_handler.MessageHandler(x,h,t.port),k=new WorkerTransport(C,s,y,T,o);s._transport=k,C.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(L,s){if(L.destroyed)throw new Error("Worker was destroyed");const x=await L.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(L.destroyed)throw new Error("Worker was destroyed");return x}function getUrlProp(L){if(L instanceof URL)return L.href;try{return new URL(L,window.location).href}catch{if(_is_node.isNodeJS&&typeof L=="string")return L}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(L){if(_is_node.isNodeJS&&typeof Buffer<"u"&&L instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(L);if(L instanceof Uint8Array&&L.byteLength===L.buffer.byteLength)return L;if(typeof L=="string")return(0,_util.stringToBytes)(L);if(typeof L=="object"&&!isNaN(L?.length)||(0,_util.isArrayBuffer)(L))return new Uint8Array(L);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,x,a=!1,b=null){this.length=s,this.initialData=x,this.progressiveDone=a,this.contentDispositionFilename=b,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,x){for(const a of this._rangeListeners)a(s,x)}onDataProgress(s,x){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(s,x)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const x of this._progressiveReadListeners)x(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,x){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,x){this._pdfInfo=s,this._transport=x}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(s,x,a,b=!1){this._pageIndex=s,this._pageInfo=x,this._transport=a,this._stats=b?new _display_utils.StatTimer:null,this._pdfBug=b,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:x=this.rotate,offsetX:a=0,offsetY:b=0,dontFlip:M=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:x,offsetX:a,offsetY:b,dontFlip:M})}getAnnotations({intent:s="display"}={}){const x=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,x.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:s,viewport:x,intent:a="display",annotationMode:b=_util.AnnotationMode.ENABLE,transform:M=null,background:F=null,optionalContentConfigPromise:j=null,annotationCanvasMap:v=null,pageColors:m=null,printAnnotationStorage:t=null}){if(arguments[0]?.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");const c=this._transport.getRenderingIntent(a,b,t);this.#e=!1,this.#s(),j||(j=this._transport.getOptionalContentConfig());let f=this._intentStates.get(c.cacheKey);f||(f=Object.create(null),this._intentStates.set(c.cacheKey,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const n=!!(c.renderingIntent&_util.RenderingIntentFlag.PRINT);f.displayReadyCapability||(f.displayReadyCapability=(0,_util.createPromiseCapability)(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c));const u=d=>{f.renderTasks.delete(_),(this._maybeCleanupAfterRender||n)&&(this.#e=!0),this.#i(!n),d?(_.capability.reject(d),this._abortOperatorList({intentState:f,reason:d instanceof Error?d:new Error(d)})):_.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},_=new InternalRenderTask({callback:u,params:{canvasContext:s,viewport:x,transform:M,background:F},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:v,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!n,pdfBug:this._pdfBug,pageColors:m});(f.renderTasks||=new Set).add(_);const g=_.task;return Promise.all([f.displayReadyCapability.promise,j]).then(([d,w])=>{if(this.#e){u();return}this._stats?.time("Rendering"),_.initializeGraphics({transparency:d,optionalContentConfig:w}),_.operatorListChanged()}).catch(u),g}getOperatorList({intent:s="display",annotationMode:x=_util.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function b(){F.operatorList.lastChunk&&(F.opListReadCapability.resolve(F.operatorList),F.renderTasks.delete(j))}const M=this._transport.getRenderingIntent(s,x,a,!0);let F=this._intentStates.get(M.cacheKey);F||(F=Object.create(null),this._intentStates.set(M.cacheKey,F));let j;return F.opListReadCapability||(j=Object.create(null),j.operatorListChanged=b,F.opListReadCapability=(0,_util.createPromiseCapability)(),(F.renderTasks||=new Set).add(j),F.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(M)),F.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));const x=this.streamTextContent(s);return new Promise(function(a,b){function M(){F.read().then(function({value:v,done:m}){if(m){a(j);return}Object.assign(j.styles,v.styles),j.items.push(...v.items),M()},b)}const F=x.getReader(),j={items:[],styles:Object.create(null)};M()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const x of this._intentStates.values())if(this._abortOperatorList({intentState:x,reason:new Error("Page was destroyed."),force:!0}),!x.opListReadCapability)for(const a of x.renderTasks)s.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(s)}cleanup(s=!1){this.#e=!0;const x=this.#i(!1);return s&&x&&(this._stats&&=new _display_utils.StatTimer),x}#i(s=!1){if(this.#s(),!this.#e)return!1;if(s)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:x,operatorList:a}of this._intentStates.values())if(x.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(s,x){const a=this._intentStates.get(x);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(s))}_renderPageChunk(s,x){for(let a=0,b=s.length;a<b;a++)x.operatorList.fnArray.push(s.fnArray[a]),x.operatorList.argsArray.push(s.argsArray[a]);x.operatorList.lastChunk=s.lastChunk,x.operatorList.separateAnnots=s.separateAnnots;for(const a of x.renderTasks)a.operatorListChanged();s.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:s,cacheKey:x,annotationStorageMap:a}){const M=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:x,annotationStorage:a}).getReader(),F=this._intentStates.get(x);F.streamReader=M;const j=()=>{M.read().then(({value:v,done:m})=>{if(m){F.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,F),j())},v=>{if(F.streamReader=null,!this._transport.destroyed){if(F.operatorList){F.operatorList.lastChunk=!0;for(const m of F.renderTasks)m.operatorListChanged();this.#i(!0)}if(F.displayReadyCapability)F.displayReadyCapability.reject(v);else if(F.opListReadCapability)F.opListReadCapability.reject(v);else throw v}})};j()}_abortOperatorList({intentState:s,reason:x,force:a=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!a){if(s.renderTasks.size>0)return;if(x instanceof _display_utils.RenderingCancelledException){let b=RENDERING_CANCELLED_TIMEOUT;x.extraDelay>0&&x.extraDelay<1e3&&(b+=x.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:x,force:!0})},b);return}}if(s.streamReader.cancel(new _util.AbortException(x.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[b,M]of this._intentStates)if(M===s){this._intentStates.delete(b);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(s,x){const a={data:structuredClone(s,x?{transfer:x}:null)};this.#e.then(()=>{for(const b of this.#t)b.call(this,a)})}addEventListener(s,x){this.#t.add(x)}removeEventListener(s,x){this.#t.delete(x)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const L=document?.currentScript?.src;L&&(PDFWorkerUtil.fallbackWorkerSrc=L.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(L,s){let x;try{if(x=new URL(L),!x.origin||x.origin==="null")return!1}catch{return!1}const a=new URL(s,x);return x.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(L){const s=`importScripts("${L}");`;return URL.createObjectURL(new Blob([s]))}}class _PDFWorker{static#workerPorts=new WeakMap;constructor({name:L=null,port:s=null,verbosity:x=(0,_util.getVerbosityLevel)()}={}){if(s&&_PDFWorker.#workerPorts.has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=L,this.destroyed=!1,this.verbosity=x,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,s){_PDFWorker.#workerPorts.set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(L){this._port=L,this._messageHandler=new _message_handler.MessageHandler("main","worker",L),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:L}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,L)||(L=PDFWorkerUtil.createCDNWrapper(new URL(L,window.location).href));const s=new Worker(L),x=new _message_handler.MessageHandler("main","worker",s),a=()=>{s.removeEventListener("error",b),x.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},b=()=>{this._webWorker||a()};s.addEventListener("error",b),x.on("test",F=>{if(s.removeEventListener("error",b),this.destroyed){a();return}F?(this._messageHandler=x,this._port=s,this._webWorker=s,this._readyCapability.resolve(),x.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),x.destroy(),s.terminate())}),x.on("ready",F=>{if(s.removeEventListener("error",b),this.destroyed){a();return}try{M()}catch{this._setupFakeWorker()}});const M=()=>{const F=new Uint8Array;x.send("test",F,[F.buffer])};M();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(L=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const x=`fake${PDFWorkerUtil.fakeWorkerId++}`,a=new _message_handler.MessageHandler(x+"_worker",x,s);L.setup(a,s);const b=new _message_handler.MessageHandler(x,x+"_worker",s);this._messageHandler=b,this._readyCapability.resolve(),b.send("configure",{verbosity:this.verbosity})}).catch(L=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${L.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(L){if(!L?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(L.port)?this.#workerPorts.get(L.port):new _PDFWorker(L)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=_PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#i=new Map;constructor(s,x,a,b,M){this.messageHandler=s,this.loadingTask=x,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:b.ownerDocument,styleElement:b.styleElement}),this._params=b,this.canvasFactory=M.canvasFactory,this.filterFactory=M.filterFactory,this.cMapReaderFactory=M.cMapReaderFactory,this.standardFontDataFactory=M.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}#s(s,x=null){const a=this.#t.get(s);if(a)return a;const b=this.messageHandler.sendWithPromise(s,x);return this.#t.set(s,b),b}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,x=_util.AnnotationMode.ENABLE,a=null,b=!1){let M=_util.RenderingIntentFlag.DISPLAY,F=null;switch(s){case"any":M=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":M=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(x){case _util.AnnotationMode.DISABLE:M+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:M+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:M+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,F=(M&_util.RenderingIntentFlag.PRINT&&a instanceof _annotation_storage.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${x}`)}return b&&(M+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:M,cacheKey:`${M}_${_annotation_storage.AnnotationStorage.getHash(F)}`,annotationStorageMap:F}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const a of this.#e.values())s.push(a._destroy());this.#e.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const x=this.messageHandler.sendWithPromise("Terminate",null);return s.push(x),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:x}=this;s.on("GetReader",(a,b)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=M=>{this._lastProgress={loaded:M.loaded,total:M.total}},b.onPull=()=>{this._fullReader.read().then(function({value:M,done:F}){if(F){b.close();return}(0,_util.assert)(M instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(M),1,[M])}).catch(M=>{b.error(M)})},b.onCancel=M=>{this._fullReader.cancel(M),b.ready.catch(F=>{if(!this.destroyed)throw F})}}),s.on("ReaderHeadersReady",a=>{const b=(0,_util.createPromiseCapability)(),M=this._fullReader;return M.headersReady.then(()=>{(!M.isStreamingSupported||!M.isRangeSupported)&&(this._lastProgress&&x.onProgress?.(this._lastProgress),M.onProgress=F=>{x.onProgress?.({loaded:F.loaded,total:F.total})}),b.resolve({isStreamingSupported:M.isStreamingSupported,isRangeSupported:M.isRangeSupported,contentLength:M.contentLength})},b.reject),b.promise}),s.on("GetRangeReader",(a,b)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const M=this._networkStream.getRangeReader(a.begin,a.end);if(!M){b.close();return}b.onPull=()=>{M.read().then(function({value:F,done:j}){if(j){b.close();return}(0,_util.assert)(F instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{b.error(F)})},b.onCancel=F=>{M.cancel(F),b.ready.catch(j=>{if(!this.destroyed)throw j})}}),s.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,x._capability.resolve(new PDFDocumentProxy(a,this))}),s.on("DocException",function(a){let b;switch(a.name){case"PasswordException":b=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":b=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":b=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":b=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":b=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}x._capability.reject(b)}),s.on("PasswordRequest",a=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),x.onPassword){const b=M=>{M instanceof Error?this._passwordCapability.reject(M):this._passwordCapability.resolve({password:M})};try{x.onPassword(b,a.code)}catch(M){this._passwordCapability.reject(M)}}else this._passwordCapability.reject(new _util.PasswordException(a.message,a.code));return this._passwordCapability.promise}),s.on("DataLoaded",a=>{x.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),s.on("StartRenderPage",a=>{if(this.destroyed)return;this.#e.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),s.on("commonobj",([a,b,M])=>{if(!this.destroyed&&!this.commonObjs.has(a))switch(b){case"Font":const F=this._params;if("error"in M){const m=M.error;(0,_util.warn)(`Error during font loading: ${m}`),this.commonObjs.resolve(a,m);break}const j=F.pdfBug&&globalThis.FontInspector?.enabled?(m,t)=>globalThis.FontInspector.fontAdded(m,t):null,v=new _font_loader.FontFaceObject(M,{isEvalSupported:F.isEvalSupported,disableFontFace:F.disableFontFace,ignoreErrors:F.ignoreErrors,inspectFont:j});this.fontLoader.bind(v).catch(m=>s.sendWithPromise("FontFallback",{id:a})).finally(()=>{!F.fontExtraProperties&&v.data&&(v.data=null),this.commonObjs.resolve(a,v)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,M);break;default:throw new Error(`Got unknown common object type ${b}`)}}),s.on("obj",([a,b,M,F])=>{if(this.destroyed)return;const j=this.#e.get(b);if(!j.objs.has(a))switch(M){case"Image":if(j.objs.resolve(a,F),F){let v;if(F.bitmap){const{width:m,height:t}=F;v=m*t*4}else v=F.data?.length||0;v>_util.MAX_IMAGE_SIZE_TO_CACHE&&(j._maybeCleanupAfterRender=!0)}break;case"Pattern":j.objs.resolve(a,F);break;default:throw new Error(`Got unknown object type ${M}`)}}),s.on("DocProgress",a=>{this.destroyed||x.onProgress?.({loaded:a.loaded,total:a.total})}),s.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const x=s-1,a=this.#i.get(x);if(a)return a;const b=this.messageHandler.sendWithPromise("GetPage",{pageIndex:x}).then(M=>{if(this.destroyed)throw new Error("Transport destroyed");const F=new PDFPageProxy(x,M,this,this._params.pdfBug);return this.#e.set(x,F),F});return this.#i.set(x,b),b}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,x){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:x})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",x=this.#t.get(s);if(x)return x;const a=this.messageHandler.sendWithPromise(s,null).then(b=>({info:b[0],metadata:b[1]?new _metadata.Metadata(b[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(s,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const x of this.#e.values())if(!x.cleanup())throw new Error(`startCleanup: Page ${x.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:x}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:x})}}class PDFObjects{#t=Object.create(null);#e(s){const x=this.#t[s];return x||(this.#t[s]={capability:(0,_util.createPromiseCapability)(),data:null})}get(s,x=null){if(x){const b=this.#e(s);return b.capability.promise.then(()=>x(b.data)),null}const a=this.#t[s];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${s}.`);return a.data}has(s){return this.#t[s]?.capability.settled||!1}resolve(s,x=null){const a=this.#e(s);a.data=x,a.capability.resolve()}clear(){for(const s in this.#t){const{data:x}=this.#t[s];x?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(s){this.#t=s,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(s=0){this.#t.cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=this.#t.operatorList;if(!s)return!1;const{annotationCanvasMap:x}=this.#t;return s.form||s.canvas&&x?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:s,params:x,objs:a,commonObjs:b,annotationCanvasMap:M,operatorList:F,pageIndex:j,canvasFactory:v,filterFactory:m,useRequestAnimationFrame:t=!1,pdfBug:c=!1,pageColors:f=null}){this.callback=s,this.params=x,this.objs=a,this.commonObjs=b,this.annotationCanvasMap=M,this.operatorListIdx=null,this.operatorList=F,this._pageIndex=j,this.canvasFactory=v,this.filterFactory=m,this._pdfBug=c,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=x.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:x}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:b,transform:M,background:F}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:x},this.annotationCanvasMap),this.gfx.beginDrawing({transform:M,viewport:b,transparency:s,background:F}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(s=null,x=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",x))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PrintAnnotationStorage=s.AnnotationStorage=void 0;var a=x(1),b=x(4),M=x(8);class F{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(m,t){const c=this.#e.get(m);return c===void 0?t:Object.assign(t,c)}getRawValue(m){return this.#e.get(m)}remove(m){if(this.#e.delete(m),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#e.values())if(t instanceof b.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(m,t){const c=this.#e.get(m);let f=!1;if(c!==void 0)for(const[n,u]of Object.entries(t))c[n]!==u&&(f=!0,c[n]=u);else f=!0,this.#e.set(m,t);f&&this.#i(),t instanceof b.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(m){return this.#e.has(m)}getAll(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}setAll(m){for(const[t,c]of Object.entries(m))this.setValue(t,c)}get size(){return this.#e.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new j(this)}get serializable(){if(this.#e.size===0)return null;const m=new Map;for(const[t,c]of this.#e){const f=c instanceof b.AnnotationEditor?c.serialize():c;f&&m.set(t,f)}return m}static getHash(m){if(!m)return"";const t=new M.MurmurHash3_64;for(const[c,f]of m)t.update(`${c}:${JSON.stringify(f)}`);return t.hexdigest()}}s.AnnotationStorage=F;class j extends F{#t=null;constructor(m){super(),this.#t=structuredClone(m.serializable)}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}s.PrintAnnotationStorage=j},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditor=void 0;var a=x(5),b=x(1);class M{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#i=!1;#s=!1;#r=!1;_uiManager=null;#h=M._zIndex++;static _colorManager=new a.ColorManager;static _zIndex=1;constructor(j){this.constructor===M&&(0,b.unreachable)("Cannot initialize AnnotationEditor."),this.parent=j.parent,this.id=j.id,this.width=this.height=null,this.pageIndex=j.parent.pageIndex,this.name=j.name,this.div=null,this._uiManager=j.uiManager;const{rotation:v,rawDims:{pageWidth:m,pageHeight:t,pageX:c,pageY:f}}=this.parent.viewport;this.rotation=v,this.pageDimensions=[m,t],this.pageTranslation=[c,f];const[n,u]=this.parentDimensions;this.x=j.x/n,this.y=j.y/u,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,b.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(j){this._uiManager.addCommands(j)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#h}setParent(j){j!==null&&(this.pageIndex=j.pageIndex,this.pageDimensions=j.pageDimensions),this.parent=j}focusin(j){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(j){!this.isAttachedToDOM||j.relatedTarget?.closest(`#${this.id}`)||(j.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(j){const v=this.parent.div.getBoundingClientRect();this.startX=j.clientX-v.x,this.startY=j.clientY-v.y,j.dataTransfer.setData("text/plain",this.id),j.dataTransfer.effectAllowed="move"}setAt(j,v,m,t){const[c,f]=this.parentDimensions;[m,t]=this.screenToPageTranslation(m,t),this.x=(j+m)/c,this.y=(v+t)/f,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(j,v){const[m,t]=this.parentDimensions;[j,v]=this.screenToPageTranslation(j,v),this.x+=j/m,this.y+=v/t,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(j,v){switch(this.parentRotation){case 90:return[v,-j];case 180:return[-j,-v];case 270:return[-v,j];default:return[j,v]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:j}=this._uiManager.viewParameters,[v,m]=this.pageDimensions;return[v*j,m*j]}setDims(j,v){const[m,t]=this.parentDimensions;this.div.style.width=`${100*j/m}%`,this.div.style.height=`${100*v/t}%`}fixDims(){const{style:j}=this.div,{height:v,width:m}=j,t=m.endsWith("%"),c=v.endsWith("%");if(t&&c)return;const[f,n]=this.parentDimensions;t||(j.width=`${100*parseFloat(m)/f}%`),c||(j.height=`${100*parseFloat(v)/n}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);const[j,v]=this.getInitialTranslation();return this.translate(j,v),(0,a.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(j){const{isMac:v}=b.FeatureTest.platform;if(j.button!==0||j.ctrlKey&&v){j.preventDefault();return}j.ctrlKey&&!v||j.shiftKey||j.metaKey&&v?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0}getRect(j,v){const m=this.parentScale,[t,c]=this.pageDimensions,[f,n]=this.pageTranslation,u=j/m,_=v/m,g=this.x*t,d=this.y*c,w=this.width*t,D=this.height*c;switch(this.rotation){case 0:return[g+u+f,c-d-_-D+n,g+u+w+f,c-d-_+n];case 90:return[g+_+f,c-d+u+n,g+_+D+f,c-d+u+w+n];case 180:return[g-u-w+f,c-d+_+n,g-u+f,c-d+_+D+n];case 270:return[g-_-D+f,c-d-u-w+n,g-_+f,c-d-u+n];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(j,v){const[m,t,c,f]=j,n=c-m,u=f-t;switch(this.rotation){case 0:return[m,v-f,n,u];case 90:return[m,v-t,u,n];case 180:return[c,v-t,n,u];case 270:return[c,v-f,u,n];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,b.unreachable)("An editor must be serializable")}static deserialize(j,v,m){const t=new this.prototype.constructor({parent:v,id:v.getNextId(),uiManager:m});t.rotation=j.rotation;const[c,f]=t.pageDimensions,[n,u,_,g]=t.getRectInCurrentCoords(j.rect,f);return t.x=n/c,t.y=u/f,t.width=_/c,t.height=g/f,t}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(j,v){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#s}set isEditing(j){this.#s=j,j?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}s.AnnotationEditor=M},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.KeyboardManager=s.CommandManager=s.ColorManager=s.AnnotationEditorUIManager=void 0,s.bindEvents=M,s.opacityToHex=F;var a=x(1),b=x(6);function M(f,n,u){for(const _ of u)n.addEventListener(_,f[_].bind(f))}function F(f){return Math.round(Math.min(255,Math.max(1,255*f))).toString(16).padStart(2,"0")}class j{#t=0;getId(){return`${a.AnnotationEditorPrefix}${this.#t++}`}}class v{#t=[];#e=!1;#i;#s=-1;constructor(n=128){this.#i=n}add({cmd:n,undo:u,mustExec:_,type:g=NaN,overwriteIfSameType:d=!1,keepUndo:w=!1}){if(_&&n(),this.#e)return;const D={cmd:n,undo:u,type:g};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(D);return}if(d&&this.#t[this.#s].type===g){w&&(D.undo=this.#t[this.#s].undo),this.#t[this.#s]=D;return}const S=this.#s+1;S===this.#i?this.#t.splice(0,1):(this.#s=S,S<this.#t.length&&this.#t.splice(S)),this.#t.push(D)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}s.CommandManager=v;class m{constructor(n){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:u}=a.FeatureTest.platform;for(const[_,g]of n)for(const d of _){const w=d.startsWith("mac+");u&&w?(this.callbacks.set(d.slice(4),g),this.allKeys.add(d.split("+").at(-1))):!u&&!w&&(this.callbacks.set(d,g),this.allKeys.add(d.split("+").at(-1)))}}#t(n){n.altKey&&this.buffer.push("alt"),n.ctrlKey&&this.buffer.push("ctrl"),n.metaKey&&this.buffer.push("meta"),n.shiftKey&&this.buffer.push("shift"),this.buffer.push(n.key);const u=this.buffer.join("+");return this.buffer.length=0,u}exec(n,u){if(!this.allKeys.has(u.key))return;const _=this.callbacks.get(this.#t(u));_&&(_.bind(n)(),u.stopPropagation(),u.preventDefault())}}s.KeyboardManager=m;class t{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const n=new Map([["CanvasText",null],["Canvas",null]]);return(0,b.getColorValues)(n),(0,a.shadow)(this,"_colors",n)}convert(n){const u=(0,b.getRGB)(n);if(!window.matchMedia("(forced-colors: active)").matches)return u;for(const[_,g]of this._colors)if(g.every((d,w)=>d===u[w]))return t._colorsMapping.get(_);return u}getHexCode(n){const u=this._colors.get(n);return u?a.Util.makeHexColor(...u):n}}s.ColorManager=t;class c{#t=null;#e=new Map;#i=new Map;#s=null;#r=new v;#h=0;#c=null;#n=new Set;#a=null;#d=new j;#l=!1;#u=a.AnnotationEditorType.NONE;#o=new Set;#g=this.copy.bind(this);#C=this.cut.bind(this);#T=this.paste.bind(this);#x=this.keydown.bind(this);#P=this.onEditingAction.bind(this);#y=this.onPageChanging.bind(this);#w=this.onScaleChanging.bind(this);#k=this.onRotationChanging.bind(this);#F={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#f=null;static _keyboardManager=new m([[["ctrl+a","mac+meta+a"],c.prototype.selectAll],[["ctrl+z","mac+meta+z"],c.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],c.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],c.prototype.delete],[["Escape","mac+Escape"],c.prototype.unselectAll]]);constructor(n,u,_){this.#f=n,this.#a=u,this.#a._on("editingaction",this.#P),this.#a._on("pagechanging",this.#y),this.#a._on("scalechanging",this.#w),this.#a._on("rotationchanging",this.#k),this.#s=_,this.viewParameters={realScale:b.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#_(),this.#a._off("editingaction",this.#P),this.#a._off("pagechanging",this.#y),this.#a._off("scalechanging",this.#w),this.#a._off("rotationchanging",this.#k);for(const n of this.#i.values())n.destroy();this.#i.clear(),this.#e.clear(),this.#n.clear(),this.#t=null,this.#o.clear(),this.#r.destroy()}onPageChanging({pageNumber:n}){this.#h=n-1}focusMainContainer(){this.#f.focus()}addShouldRescale(n){this.#n.add(n)}removeShouldRescale(n){this.#n.delete(n)}onScaleChanging({scale:n}){this.commitOrRemove(),this.viewParameters.realScale=n*b.PixelsPerInch.PDF_TO_CSS_UNITS;for(const u of this.#n)u.onScaleChanging()}onRotationChanging({pagesRotation:n}){this.commitOrRemove(),this.viewParameters.rotation=n}addToAnnotationStorage(n){!n.isEmpty()&&this.#s&&!this.#s.has(n.id)&&this.#s.setValue(n.id,n)}#R(){this.#f.addEventListener("keydown",this.#x)}#_(){this.#f.removeEventListener("keydown",this.#x)}#v(){document.addEventListener("copy",this.#g),document.addEventListener("cut",this.#C),document.addEventListener("paste",this.#T)}#b(){document.removeEventListener("copy",this.#g),document.removeEventListener("cut",this.#C),document.removeEventListener("paste",this.#T)}copy(n){if(n.preventDefault(),this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;const u=[];for(const _ of this.#o)_.isEmpty()||u.push(_.serialize());u.length!==0&&n.clipboardData.setData("application/pdfjs",JSON.stringify(u))}cut(n){this.copy(n),this.delete()}paste(n){n.preventDefault();let u=n.clipboardData.getData("application/pdfjs");if(!u)return;try{u=JSON.parse(u)}catch(g){(0,a.warn)(`paste: "${g.message}".`);return}if(!Array.isArray(u))return;this.unselectAll();const _=this.#i.get(this.#h);try{const g=[];for(const D of u){const S=_.deserialize(D);if(!S)return;g.push(S)}const d=()=>{for(const D of g)this.#D(D);this.#S(g)},w=()=>{for(const D of g)D.remove()};this.addCommands({cmd:d,undo:w,mustExec:!0})}catch(g){(0,a.warn)(`paste: "${g.message}".`)}}keydown(n){this.getActive()?.shouldGetKeyboardEvents()||c._keyboardManager.exec(this,n)}onEditingAction(n){["undo","redo","delete","selectAll"].includes(n.name)&&this[n.name]()}#p(n){Object.entries(n).some(([_,g])=>this.#F[_]!==g)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#F,n)})}#m(n){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:n})}setEditingState(n){n?(this.#R(),this.#v(),this.#p({isEditing:this.#u!==a.AnnotationEditorType.NONE,isEmpty:this.#A(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#_(),this.#b(),this.#p({isEditing:!1}))}registerEditorTypes(n){if(!this.#c){this.#c=n;for(const u of this.#c)this.#m(u.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#i.get(this.#h)}get currentPageIndex(){return this.#h}addLayer(n){this.#i.set(n.pageIndex,n),this.#l?n.enable():n.disable()}removeLayer(n){this.#i.delete(n.pageIndex)}updateMode(n){if(this.#u=n,n===a.AnnotationEditorType.NONE)this.setEditingState(!1),this.#O();else{this.setEditingState(!0),this.#M();for(const u of this.#i.values())u.updateMode(n)}}updateToolbar(n){n!==this.#u&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:n})}updateParams(n,u){if(this.#c){for(const _ of this.#o)_.updateParams(n,u);for(const _ of this.#c)_.updateDefaultParams(n,u)}}#M(){if(!this.#l){this.#l=!0;for(const n of this.#i.values())n.enable()}}#O(){if(this.unselectAll(),this.#l){this.#l=!1;for(const n of this.#i.values())n.disable()}}getEditors(n){const u=[];for(const _ of this.#e.values())_.pageIndex===n&&u.push(_);return u}getEditor(n){return this.#e.get(n)}addEditor(n){this.#e.set(n.id,n)}removeEditor(n){this.#e.delete(n.id),this.unselect(n),this.#s?.remove(n.id)}#D(n){const u=this.#i.get(n.pageIndex);u?u.addOrRebuild(n):this.addEditor(n)}setActiveEditor(n){this.#t!==n&&(this.#t=n,n&&this.#m(n.propertiesToUpdate))}toggleSelected(n){if(this.#o.has(n)){this.#o.delete(n),n.unselect(),this.#p({hasSelectedEditor:this.hasSelection});return}this.#o.add(n),n.select(),this.#m(n.propertiesToUpdate),this.#p({hasSelectedEditor:!0})}setSelected(n){for(const u of this.#o)u!==n&&u.unselect();this.#o.clear(),this.#o.add(n),n.select(),this.#m(n.propertiesToUpdate),this.#p({hasSelectedEditor:!0})}isSelected(n){return this.#o.has(n)}unselect(n){n.unselect(),this.#o.delete(n),this.#p({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#r.undo(),this.#p({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#A()})}redo(){this.#r.redo(),this.#p({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#A()})}addCommands(n){this.#r.add(n),this.#p({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#A()})}#A(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const n of this.#e.values())return n.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const n=[...this.#o],u=()=>{for(const g of n)g.remove()},_=()=>{for(const g of n)this.#D(g)};this.addCommands({cmd:u,undo:_,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}#S(n){this.#o.clear();for(const u of n)u.isEmpty()||(this.#o.add(u),u.select());this.#p({hasSelectedEditor:!0})}selectAll(){for(const n of this.#o)n.commit();this.#S(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.#o.size!==0){for(const n of this.#o)n.unselect();this.#o.clear(),this.#p({hasSelectedEditor:!1})}}isActive(n){return this.#t===n}getActive(){return this.#t}getMode(){return this.#u}}s.AnnotationEditorUIManager=c},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.StatTimer=s.RenderingCancelledException=s.PixelsPerInch=s.PageViewport=s.PDFDateString=s.DOMStandardFontDataFactory=s.DOMSVGFactory=s.DOMFilterFactory=s.DOMCanvasFactory=s.DOMCMapReaderFactory=s.AnnotationPrefix=void 0,s.deprecated=P,s.getColorValues=K,s.getCurrentTransform=it,s.getCurrentTransformInverse=J,s.getFilenameFromUrl=w,s.getPdfFilenameFromUrl=D,s.getRGB=q,s.getXfaPageViewport=H,s.isDataScheme=g,s.isPdfFile=d,s.isValidFetchUrl=r,s.loadScript=p,s.setLayerDimensions=Z;var a=x(7),b=x(1);const M="http://www.w3.org/2000/svg",F="pdfjs_internal_id_";s.AnnotationPrefix=F;class j{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}s.PixelsPerInch=j;class v extends a.BaseFilterFactory{#t;#e;#i;#s;#r;#h;#c;#n=0;constructor({docId:I,ownerDocument:N=globalThis.document}={}){super(),this.#i=I,this.#s=N}get#a(){return this.#t||=new Map}get#d(){if(!this.#e){const I=this.#s.createElement("div"),{style:N}=I;N.visibility="hidden",N.contain="strict",N.width=N.height=0,N.position="absolute",N.top=N.left=0,N.zIndex=-1;const E=this.#s.createElementNS(M,"svg");E.setAttribute("width",0),E.setAttribute("height",0),this.#e=this.#s.createElementNS(M,"defs"),I.append(E),E.append(this.#e),this.#s.body.append(I)}return this.#e}#l(I,N,E){const l=this.#s.createElementNS(M,N);l.setAttribute("type","discrete"),l.setAttribute("tableValues",E),I.append(l)}addFilter(I){if(!I)return"none";let N=this.#a.get(I);if(N)return N;let E,l,o,A;if(I.length===1){const y=I[0],C=new Array(256);for(let k=0;k<256;k++)C[k]=y[k]/255;A=E=l=o=C.join(",")}else{const[y,C,k]=I,R=new Array(256),W=new Array(256),z=new Array(256);for(let U=0;U<256;U++)R[U]=y[U]/255,W[U]=C[U]/255,z[U]=k[U]/255;E=R.join(","),l=W.join(","),o=z.join(","),A=`${E}${l}${o}`}if(N=this.#a.get(A),N)return this.#a.set(I,N),N;const T=`g_${this.#i}_transfer_map_${this.#n++}`,e=`url(#${T})`;this.#a.set(I,e),this.#a.set(A,e);const i=this.#s.createElementNS(M,"filter",M);i.setAttribute("id",T),i.setAttribute("color-interpolation-filters","sRGB");const h=this.#s.createElementNS(M,"feComponentTransfer");return i.append(h),this.#l(h,"feFuncR",E),this.#l(h,"feFuncG",l),this.#l(h,"feFuncB",o),this.#d.append(i),e}addHCMFilter(I,N){const E=`${I}-${N}`;if(this.#h===E)return this.#c;if(this.#h=E,this.#c="none",this.#r?.remove(),!I||!N)return this.#c;this.#d.style.color=I,I=getComputedStyle(this.#d).getPropertyValue("color");const l=q(I);I=b.Util.makeHexColor(...l),this.#d.style.color=N,N=getComputedStyle(this.#d).getPropertyValue("color");const o=q(N);if(N=b.Util.makeHexColor(...o),this.#d.style.color="",I==="#000000"&&N==="#ffffff"||I===N)return this.#c;const A=new Array(256);for(let k=0;k<=255;k++){const R=k/255;A[k]=R<=.03928?R/12.92:((R+.055)/1.055)**2.4}const T=A.join(","),e=`g_${this.#i}_hcm_filter`,i=this.#r=this.#s.createElementNS(M,"filter",M);i.setAttribute("id",e),i.setAttribute("color-interpolation-filters","sRGB");let h=this.#s.createElementNS(M,"feComponentTransfer");i.append(h),this.#l(h,"feFuncR",T),this.#l(h,"feFuncG",T),this.#l(h,"feFuncB",T);const y=this.#s.createElementNS(M,"feColorMatrix");y.setAttribute("type","matrix"),y.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),i.append(y),h=this.#s.createElementNS(M,"feComponentTransfer"),i.append(h);const C=(k,R)=>{const W=l[k]/255,z=o[k]/255,U=new Array(R+1);for(let $=0;$<=R;$++)U[$]=W+$/R*(z-W);return U.join(",")};return this.#l(h,"feFuncR",C(0,5)),this.#l(h,"feFuncG",C(1,5)),this.#l(h,"feFuncB",C(2,5)),this.#d.append(i),this.#c=`url(#${e})`,this.#c}destroy(I=!1){I&&this.#c||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#n=0)}}s.DOMFilterFactory=v;class m extends a.BaseCanvasFactory{constructor({ownerDocument:I=globalThis.document}={}){super(),this._document=I}_createCanvas(I,N){const E=this._document.createElement("canvas");return E.width=I,E.height=N,E}}s.DOMCanvasFactory=m;async function t(V,I=!1){if(r(V,document.baseURI)){const N=await fetch(V);if(!N.ok)throw new Error(N.statusText);return I?new Uint8Array(await N.arrayBuffer()):(0,b.stringToBytes)(await N.text())}return new Promise((N,E)=>{const l=new XMLHttpRequest;l.open("GET",V,!0),I&&(l.responseType="arraybuffer"),l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let o;if(I&&l.response?o=new Uint8Array(l.response):!I&&l.responseText&&(o=(0,b.stringToBytes)(l.responseText)),o){N(o);return}}E(new Error(l.statusText))}},l.send(null)})}class c extends a.BaseCMapReaderFactory{_fetchData(I,N){return t(I,this.isCompressed).then(E=>({cMapData:E,compressionType:N}))}}s.DOMCMapReaderFactory=c;class f extends a.BaseStandardFontDataFactory{_fetchData(I){return t(I,!0)}}s.DOMStandardFontDataFactory=f;class n extends a.BaseSVGFactory{_createSVG(I){return document.createElementNS(M,I)}}s.DOMSVGFactory=n;class u{constructor({viewBox:I,scale:N,rotation:E,offsetX:l=0,offsetY:o=0,dontFlip:A=!1}){this.viewBox=I,this.scale=N,this.rotation=E,this.offsetX=l,this.offsetY=o;const T=(I[2]+I[0])/2,e=(I[3]+I[1])/2;let i,h,y,C;switch(E%=360,E<0&&(E+=360),E){case 180:i=-1,h=0,y=0,C=1;break;case 90:i=0,h=1,y=1,C=0;break;case 270:i=0,h=-1,y=-1,C=0;break;case 0:i=1,h=0,y=0,C=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}A&&(y=-y,C=-C);let k,R,W,z;i===0?(k=Math.abs(e-I[1])*N+l,R=Math.abs(T-I[0])*N+o,W=(I[3]-I[1])*N,z=(I[2]-I[0])*N):(k=Math.abs(T-I[0])*N+l,R=Math.abs(e-I[1])*N+o,W=(I[2]-I[0])*N,z=(I[3]-I[1])*N),this.transform=[i*N,h*N,y*N,C*N,k-i*N*T-y*N*e,R-h*N*T-C*N*e],this.width=W,this.height=z}get rawDims(){const{viewBox:I}=this;return(0,b.shadow)(this,"rawDims",{pageWidth:I[2]-I[0],pageHeight:I[3]-I[1],pageX:I[0],pageY:I[1]})}clone({scale:I=this.scale,rotation:N=this.rotation,offsetX:E=this.offsetX,offsetY:l=this.offsetY,dontFlip:o=!1}={}){return new u({viewBox:this.viewBox.slice(),scale:I,rotation:N,offsetX:E,offsetY:l,dontFlip:o})}convertToViewportPoint(I,N){return b.Util.applyTransform([I,N],this.transform)}convertToViewportRectangle(I){const N=b.Util.applyTransform([I[0],I[1]],this.transform),E=b.Util.applyTransform([I[2],I[3]],this.transform);return[N[0],N[1],E[0],E[1]]}convertToPdfPoint(I,N){return b.Util.applyInverseTransform([I,N],this.transform)}}s.PageViewport=u;class _ extends b.BaseException{constructor(I,N,E=0){super(I,"RenderingCancelledException"),this.type=N,this.extraDelay=E}}s.RenderingCancelledException=_;function g(V){const I=V.length;let N=0;for(;N<I&&V[N].trim()==="";)N++;return V.substring(N,N+5).toLowerCase()==="data:"}function d(V){return typeof V=="string"&&/\.pdf$/i.test(V)}function w(V,I=!1){return I||([V]=V.split(/[#?]/,1)),V.substring(V.lastIndexOf("/")+1)}function D(V,I="document.pdf"){if(typeof V!="string")return I;if(g(V))return(0,b.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),I;const N=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,E=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=N.exec(V);let o=E.exec(l[1])||E.exec(l[2])||E.exec(l[3]);if(o&&(o=o[0],o.includes("%")))try{o=E.exec(decodeURIComponent(o))[0]}catch{}return o||I}class S{started=Object.create(null);times=[];time(I){I in this.started&&(0,b.warn)(`Timer is already running for ${I}`),this.started[I]=Date.now()}timeEnd(I){I in this.started||(0,b.warn)(`Timer has not been started for ${I}`),this.times.push({name:I,start:this.started[I],end:Date.now()}),delete this.started[I]}toString(){const I=[];let N=0;for(const{name:E}of this.times)N=Math.max(E.length,N);for(const{name:E,start:l,end:o}of this.times)I.push(`${E.padEnd(N)} ${o-l}ms
`);return I.join("")}}s.StatTimer=S;function r(V,I){try{const{protocol:N}=I?new URL(V,I):new URL(V);return N==="http:"||N==="https:"}catch{return!1}}function p(V,I=!1){return new Promise((N,E)=>{const l=document.createElement("script");l.src=V,l.onload=function(o){I&&l.remove(),N(o)},l.onerror=function(){E(new Error(`Cannot load script at: ${l.src}`))},(document.head||document.documentElement).append(l)})}function P(V){console.log("Deprecated API usage: "+V)}let B;class O{static toDateObject(I){if(!I||typeof I!="string")return null;B||(B=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const N=B.exec(I);if(!N)return null;const E=parseInt(N[1],10);let l=parseInt(N[2],10);l=l>=1&&l<=12?l-1:0;let o=parseInt(N[3],10);o=o>=1&&o<=31?o:1;let A=parseInt(N[4],10);A=A>=0&&A<=23?A:0;let T=parseInt(N[5],10);T=T>=0&&T<=59?T:0;let e=parseInt(N[6],10);e=e>=0&&e<=59?e:0;const i=N[7]||"Z";let h=parseInt(N[8],10);h=h>=0&&h<=23?h:0;let y=parseInt(N[9],10)||0;return y=y>=0&&y<=59?y:0,i==="-"?(A+=h,T+=y):i==="+"&&(A-=h,T-=y),new Date(Date.UTC(E,l,o,A,T,e))}}s.PDFDateString=O;function H(V,{scale:I=1,rotation:N=0}){const{width:E,height:l}=V.attributes.style,o=[0,0,parseInt(E),parseInt(l)];return new u({viewBox:o,scale:I,rotation:N})}function q(V){if(V.startsWith("#")){const I=parseInt(V.slice(1),16);return[(I&16711680)>>16,(I&65280)>>8,I&255]}return V.startsWith("rgb(")?V.slice(4,-1).split(",").map(I=>parseInt(I)):V.startsWith("rgba(")?V.slice(5,-1).split(",").map(I=>parseInt(I)).slice(0,3):((0,b.warn)(`Not a valid color format: "${V}"`),[0,0,0])}function K(V){const I=document.createElement("span");I.style.visibility="hidden",document.body.append(I);for(const N of V.keys()){I.style.color=N;const E=window.getComputedStyle(I).color;V.set(N,q(E))}I.remove()}function it(V){const{a:I,b:N,c:E,d:l,e:o,f:A}=V.getTransform();return[I,N,E,l,o,A]}function J(V){const{a:I,b:N,c:E,d:l,e:o,f:A}=V.getTransform().invertSelf();return[I,N,E,l,o,A]}function Z(V,I,N=!1,E=!0){if(I instanceof u){const{pageWidth:l,pageHeight:o}=I.rawDims,{style:A}=V,T=`calc(var(--scale-factor) * ${l}px)`,e=`calc(var(--scale-factor) * ${o}px)`;!N||I.rotation%180===0?(A.width=T,A.height=e):(A.width=e,A.height=T)}E&&V.setAttribute("data-main-rotation",I.rotation)}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BaseStandardFontDataFactory=s.BaseSVGFactory=s.BaseFilterFactory=s.BaseCanvasFactory=s.BaseCMapReaderFactory=void 0;var a=x(1);class b{constructor(){this.constructor===b&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,c){return"none"}destroy(t=!1){}}s.BaseFilterFactory=b;class M{constructor(){this.constructor===M&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,c){if(t<=0||c<=0)throw new Error("Invalid canvas size");const f=this._createCanvas(t,c);return{canvas:f,context:f.getContext("2d")}}reset(t,c,f){if(!t.canvas)throw new Error("Canvas is not specified");if(c<=0||f<=0)throw new Error("Invalid canvas size");t.canvas.width=c,t.canvas.height=f}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,c){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}s.BaseCanvasFactory=M;class F{constructor({baseUrl:t=null,isCompressed:c=!0}){this.constructor===F&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=c}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const c=this.baseUrl+t+(this.isCompressed?".bcmap":""),f=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(c,f).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${c}`)})}_fetchData(t,c){(0,a.unreachable)("Abstract method `_fetchData` called.")}}s.BaseCMapReaderFactory=F;class j{constructor({baseUrl:t=null}){this.constructor===j&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const c=`${this.baseUrl}${t}`;return this._fetchData(c).catch(f=>{throw new Error(`Unable to load font data at: ${c}`)})}_fetchData(t){(0,a.unreachable)("Abstract method `_fetchData` called.")}}s.BaseStandardFontDataFactory=j;class v{constructor(){this.constructor===v&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,c,f=!1){if(t<=0||c<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),f||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${c}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${c}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,a.unreachable)("Abstract method `_createSVG` called.")}}s.BaseSVGFactory=v},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MurmurHash3_64=void 0;var a=x(1);const b=3285377520,M=4294901760,F=65535;class j{constructor(m){this.h1=m?m&4294967295:b,this.h2=m?m&4294967295:b}update(m){let t,c;if(typeof m=="string"){t=new Uint8Array(m.length*2),c=0;for(let P=0,B=m.length;P<B;P++){const O=m.charCodeAt(P);O<=255?t[c++]=O:(t[c++]=O>>>8,t[c++]=O&255)}}else if((0,a.isArrayBuffer)(m))t=m.slice(),c=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const f=c>>2,n=c-f*4,u=new Uint32Array(t.buffer,0,f);let _=0,g=0,d=this.h1,w=this.h2;const D=3432918353,S=461845907,r=D&F,p=S&F;for(let P=0;P<f;P++)P&1?(_=u[P],_=_*D&M|_*r&F,_=_<<15|_>>>17,_=_*S&M|_*p&F,d^=_,d=d<<13|d>>>19,d=d*5+3864292196):(g=u[P],g=g*D&M|g*r&F,g=g<<15|g>>>17,g=g*S&M|g*p&F,w^=g,w=w<<13|w>>>19,w=w*5+3864292196);switch(_=0,n){case 3:_^=t[f*4+2]<<16;case 2:_^=t[f*4+1]<<8;case 1:_^=t[f*4],_=_*D&M|_*r&F,_=_<<15|_>>>17,_=_*S&M|_*p&F,f&1?d^=_:w^=_}this.h1=d,this.h2=w}hexdigest(){let m=this.h1,t=this.h2;return m^=t>>>1,m=m*3981806797&M|m*36045&F,t=t*4283543511&M|((t<<16|m>>>16)*2950163797&M)>>>16,m^=t>>>1,m=m*444984403&M|m*60499&F,t=t*3301882366&M|((t<<16|m>>>16)*3120437893&M)>>>16,m^=t>>>1,(m>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}s.MurmurHash3_64=j},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FontLoader=s.FontFaceObject=void 0;var a=x(1),b=x(10);class M{constructor({ownerDocument:v=globalThis.document,styleElement:m=null}){this._document=v,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(v){this.nativeFontFaces.push(v),this._document.fonts.add(v)}insertRule(v){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const m=this.styleElement.sheet;m.insertRule(v,m.cssRules.length)}clear(){for(const v of this.nativeFontFaces)this._document.fonts.delete(v);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(v){if(v.attached||v.missingFile)return;if(v.attached=!0,this.isFontLoadingAPISupported){const t=v.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(c){throw(0,a.warn)(`Failed to load font '${t.family}': '${c}'.`),v.disableFontFace=!0,c}}return}const m=v.createFontFaceRule();if(m){if(this.insertRule(m),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const c=this._queueLoadingCallback(t);this._prepareFontLoadEvent(v,c)})}}get isFontLoadingAPISupported(){const v=!!this._document?.fonts;return(0,a.shadow)(this,"isFontLoadingAPISupported",v)}get isSyncFontLoadingSupported(){let v=!1;return(b.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(v=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",v)}_queueLoadingCallback(v){function m(){for((0,a.assert)(!c.done,"completeRequest() cannot be called twice."),c.done=!0;t.length>0&&t[0].done;){const f=t.shift();setTimeout(f.callback,0)}}const{loadingRequests:t}=this,c={done:!1,complete:m,callback:v};return t.push(c),c}get _loadTestFont(){const v=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",v)}_prepareFontLoadEvent(v,m){function t(q,K){return q.charCodeAt(K)<<24|q.charCodeAt(K+1)<<16|q.charCodeAt(K+2)<<8|q.charCodeAt(K+3)&255}function c(q,K,it,J){const Z=q.substring(0,K),V=q.substring(K+it);return Z+J+V}let f,n;const u=this._document.createElement("canvas");u.width=1,u.height=1;const _=u.getContext("2d");let g=0;function d(q,K){if(++g>30){(0,a.warn)("Load test font never loaded."),K();return}if(_.font="30px "+q,_.fillText(".",0,20),_.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(d.bind(null,q,K))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let D=this._loadTestFont;D=c(D,976,w.length,w);const r=16,p=1482184792;let P=t(D,r);for(f=0,n=w.length-3;f<n;f+=4)P=P-p+t(w,f)|0;f<w.length&&(P=P-p+t(w+"XXX",f)|0),D=c(D,r,4,(0,a.string32)(P));const B=`url(data:font/opentype;base64,${btoa(D)});`,O=`@font-face {font-family:"${w}";src:${B}}`;this.insertRule(O);const H=this._document.createElement("div");H.style.visibility="hidden",H.style.width=H.style.height="10px",H.style.position="absolute",H.style.top=H.style.left="0px";for(const q of[v.loadedName,w]){const K=this._document.createElement("span");K.textContent="Hi",K.style.fontFamily=q,H.append(K)}this._document.body.append(H),d(w,()=>{H.remove(),m.complete()})}}s.FontLoader=M;class F{constructor(v,{isEvalSupported:m=!0,disableFontFace:t=!1,ignoreErrors:c=!1,inspectFont:f=null}){this.compiledGlyphs=Object.create(null);for(const n in v)this[n]=v[n];this.isEvalSupported=m!==!1,this.disableFontFace=t===!0,this.ignoreErrors=c===!0,this._inspectFont=f}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let v;if(!this.cssFontInfo)v=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),v=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return this._inspectFont?.(this),v}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const v=(0,a.bytesToString)(this.data),m=`url(data:${this.mimetype};base64,${btoa(v)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${m}}`;else{let c=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(c+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${c}src:${m}}`}return this._inspectFont?.(this,m),t}getPathGenerator(v,m){if(this.compiledGlyphs[m]!==void 0)return this.compiledGlyphs[m];let t;try{t=v.get(this.loadedName+"_path_"+m)}catch(c){if(!this.ignoreErrors)throw c;return(0,a.warn)(`getPathGenerator - ignoring character: "${c}".`),this.compiledGlyphs[m]=function(f,n){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const c=[];for(const f of t){const n=f.args!==void 0?f.args.join(","):"";c.push("c.",f.cmd,"(",n,`);
`)}return this.compiledGlyphs[m]=new Function("c","size",c.join(""))}return this.compiledGlyphs[m]=function(c,f){for(const n of t)n.cmd==="scale"&&(n.args=[f,-f]),c[n.cmd].apply(c,n.args)}}}s.FontFaceObject=F},(L,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isNodeJS=void 0;const x=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");s.isNodeJS=x},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CanvasGraphics=void 0;var a=x(1),b=x(6),M=x(12),F=x(13),j=x(10);const v=16,m=100,t=4096,c=15,f=10,n=1e3,u=16;function _(E,l){if(E._removeMirroring)throw new Error("Context is already forwarding operations.");E.__originalSave=E.save,E.__originalRestore=E.restore,E.__originalRotate=E.rotate,E.__originalScale=E.scale,E.__originalTranslate=E.translate,E.__originalTransform=E.transform,E.__originalSetTransform=E.setTransform,E.__originalResetTransform=E.resetTransform,E.__originalClip=E.clip,E.__originalMoveTo=E.moveTo,E.__originalLineTo=E.lineTo,E.__originalBezierCurveTo=E.bezierCurveTo,E.__originalRect=E.rect,E.__originalClosePath=E.closePath,E.__originalBeginPath=E.beginPath,E._removeMirroring=()=>{E.save=E.__originalSave,E.restore=E.__originalRestore,E.rotate=E.__originalRotate,E.scale=E.__originalScale,E.translate=E.__originalTranslate,E.transform=E.__originalTransform,E.setTransform=E.__originalSetTransform,E.resetTransform=E.__originalResetTransform,E.clip=E.__originalClip,E.moveTo=E.__originalMoveTo,E.lineTo=E.__originalLineTo,E.bezierCurveTo=E.__originalBezierCurveTo,E.rect=E.__originalRect,E.closePath=E.__originalClosePath,E.beginPath=E.__originalBeginPath,delete E._removeMirroring},E.save=function(){l.save(),this.__originalSave()},E.restore=function(){l.restore(),this.__originalRestore()},E.translate=function(A,T){l.translate(A,T),this.__originalTranslate(A,T)},E.scale=function(A,T){l.scale(A,T),this.__originalScale(A,T)},E.transform=function(A,T,e,i,h,y){l.transform(A,T,e,i,h,y),this.__originalTransform(A,T,e,i,h,y)},E.setTransform=function(A,T,e,i,h,y){l.setTransform(A,T,e,i,h,y),this.__originalSetTransform(A,T,e,i,h,y)},E.resetTransform=function(){l.resetTransform(),this.__originalResetTransform()},E.rotate=function(A){l.rotate(A),this.__originalRotate(A)},E.clip=function(A){l.clip(A),this.__originalClip(A)},E.moveTo=function(o,A){l.moveTo(o,A),this.__originalMoveTo(o,A)},E.lineTo=function(o,A){l.lineTo(o,A),this.__originalLineTo(o,A)},E.bezierCurveTo=function(o,A,T,e,i,h){l.bezierCurveTo(o,A,T,e,i,h),this.__originalBezierCurveTo(o,A,T,e,i,h)},E.rect=function(o,A,T,e){l.rect(o,A,T,e),this.__originalRect(o,A,T,e)},E.closePath=function(){l.closePath(),this.__originalClosePath()},E.beginPath=function(){l.beginPath(),this.__originalBeginPath()}}class g{constructor(l){this.canvasFactory=l,this.cache=Object.create(null)}getCanvas(l,o,A){let T;return this.cache[l]!==void 0?(T=this.cache[l],this.canvasFactory.reset(T,o,A)):(T=this.canvasFactory.create(o,A),this.cache[l]=T),T}delete(l){delete this.cache[l]}clear(){for(const l in this.cache){const o=this.cache[l];this.canvasFactory.destroy(o),delete this.cache[l]}}}function d(E,l,o,A,T,e,i,h,y,C){const[k,R,W,z,U,$]=(0,b.getCurrentTransform)(E);if(R===0&&W===0){const et=i*k+U,st=Math.round(et),nt=h*z+$,at=Math.round(nt),ot=(i+y)*k+U,ht=Math.abs(Math.round(ot)-st)||1,lt=(h+C)*z+$,gt=Math.abs(Math.round(lt)-at)||1;return E.setTransform(Math.sign(k),0,0,Math.sign(z),st,at),E.drawImage(l,o,A,T,e,0,0,ht,gt),E.setTransform(k,R,W,z,U,$),[ht,gt]}if(k===0&&z===0){const et=h*W+U,st=Math.round(et),nt=i*R+$,at=Math.round(nt),ot=(h+C)*W+U,ht=Math.abs(Math.round(ot)-st)||1,lt=(i+y)*R+$,gt=Math.abs(Math.round(lt)-at)||1;return E.setTransform(0,Math.sign(R),Math.sign(W),0,st,at),E.drawImage(l,o,A,T,e,0,0,gt,ht),E.setTransform(k,R,W,z,U,$),[gt,ht]}E.drawImage(l,o,A,T,e,i,h,y,C);const tt=Math.hypot(k,R),Y=Math.hypot(W,z);return[tt*y,Y*C]}function w(E){const{width:l,height:o}=E;if(l>n||o>n)return null;const A=1e3,T=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),e=l+1;let i=new Uint8Array(e*(o+1)),h,y,C;const k=l+7&-8;let R=new Uint8Array(k*o),W=0;for(const Y of E.data){let et=128;for(;et>0;)R[W++]=Y&et?0:255,et>>=1}let z=0;for(W=0,R[W]!==0&&(i[0]=1,++z),y=1;y<l;y++)R[W]!==R[W+1]&&(i[y]=R[W]?2:1,++z),W++;for(R[W]!==0&&(i[y]=2,++z),h=1;h<o;h++){W=h*k,C=h*e,R[W-k]!==R[W]&&(i[C]=R[W]?1:8,++z);let Y=(R[W]?4:0)+(R[W-k]?8:0);for(y=1;y<l;y++)Y=(Y>>2)+(R[W+1]?4:0)+(R[W-k+1]?8:0),T[Y]&&(i[C+y]=T[Y],++z),W++;if(R[W-k]!==R[W]&&(i[C+y]=R[W]?2:4,++z),z>A)return null}for(W=k*(o-1),C=h*e,R[W]!==0&&(i[C]=8,++z),y=1;y<l;y++)R[W]!==R[W+1]&&(i[C+y]=R[W]?4:8,++z),W++;if(R[W]!==0&&(i[C+y]=4,++z),z>A)return null;const U=new Int32Array([0,e,-1,0,-e,0,0,0,1]),$=new Path2D;for(h=0;z&&h<=o;h++){let Y=h*e;const et=Y+l;for(;Y<et&&!i[Y];)Y++;if(Y===et)continue;$.moveTo(Y%e,h);const st=Y;let nt=i[Y];do{const at=U[nt];do Y+=at;while(!i[Y]);const ot=i[Y];ot!==5&&ot!==10?(nt=ot,i[Y]=0):(nt=ot&51*nt>>4,i[Y]&=nt>>2|nt<<2),$.lineTo(Y%e,Y/e|0),i[Y]||--z}while(st!==Y);--h}return R=null,i=null,function(Y){Y.save(),Y.scale(1/l,-1/o),Y.translate(0,-o),Y.fill($),Y.beginPath(),Y.restore()}}class D{constructor(l,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,l,o])}clone(){const l=Object.create(this);return l.clipBox=this.clipBox.slice(),l}setCurrentPoint(l,o){this.x=l,this.y=o}updatePathMinMax(l,o,A){[o,A]=a.Util.applyTransform([o,A],l),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,A),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,A)}updateRectMinMax(l,o){const A=a.Util.applyTransform(o,l),T=a.Util.applyTransform(o.slice(2),l);this.minX=Math.min(this.minX,A[0],T[0]),this.minY=Math.min(this.minY,A[1],T[1]),this.maxX=Math.max(this.maxX,A[0],T[0]),this.maxY=Math.max(this.maxY,A[1],T[1])}updateScalingPathMinMax(l,o){a.Util.scaleMinMax(l,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(l,o,A,T,e,i,h,y,C,k){const R=a.Util.bezierBoundingBox(o,A,T,e,i,h,y,C);if(k){k[0]=Math.min(k[0],R[0],R[2]),k[1]=Math.max(k[1],R[0],R[2]),k[2]=Math.min(k[2],R[1],R[3]),k[3]=Math.max(k[3],R[1],R[3]);return}this.updateRectMinMax(l,R)}getPathBoundingBox(l=M.PathType.FILL,o=null){const A=[this.minX,this.minY,this.maxX,this.maxY];if(l===M.PathType.STROKE){o||(0,a.unreachable)("Stroke bounding box must include transform.");const T=a.Util.singularValueDecompose2dScale(o),e=T[0]*this.lineWidth/2,i=T[1]*this.lineWidth/2;A[0]-=e,A[1]-=i,A[2]+=e,A[3]+=i}return A}updateClipFromPath(){const l=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(l||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(l){this.clipBox=l,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(l=M.PathType.FILL,o=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(l,o))}}function S(E,l){if(typeof ImageData<"u"&&l instanceof ImageData){E.putImageData(l,0,0);return}const o=l.height,A=l.width,T=o%u,e=(o-T)/u,i=T===0?e:e+1,h=E.createImageData(A,u);let y=0,C;const k=l.data,R=h.data;let W,z,U,$;if(l.kind===a.ImageKind.GRAYSCALE_1BPP){const tt=k.byteLength,Y=new Uint32Array(R.buffer,0,R.byteLength>>2),et=Y.length,st=A+7>>3,nt=4294967295,at=a.FeatureTest.isLittleEndian?4278190080:255;for(W=0;W<i;W++){for(U=W<e?u:T,C=0,z=0;z<U;z++){const ot=tt-y;let ht=0;const lt=ot>st?A:ot*8-7,gt=lt&-8;let mt=0,dt=0;for(;ht<gt;ht+=8)dt=k[y++],Y[C++]=dt&128?nt:at,Y[C++]=dt&64?nt:at,Y[C++]=dt&32?nt:at,Y[C++]=dt&16?nt:at,Y[C++]=dt&8?nt:at,Y[C++]=dt&4?nt:at,Y[C++]=dt&2?nt:at,Y[C++]=dt&1?nt:at;for(;ht<lt;ht++)mt===0&&(dt=k[y++],mt=128),Y[C++]=dt&mt?nt:at,mt>>=1}for(;C<et;)Y[C++]=0;E.putImageData(h,0,W*u)}}else if(l.kind===a.ImageKind.RGBA_32BPP){for(z=0,$=A*u*4,W=0;W<e;W++)R.set(k.subarray(y,y+$)),y+=$,E.putImageData(h,0,z),z+=u;W<i&&($=A*T*4,R.set(k.subarray(y,y+$)),E.putImageData(h,0,z))}else if(l.kind===a.ImageKind.RGB_24BPP)for(U=u,$=A*U,W=0;W<i;W++){for(W>=e&&(U=T,$=A*U),C=0,z=$;z--;)R[C++]=k[y++],R[C++]=k[y++],R[C++]=k[y++],R[C++]=255;E.putImageData(h,0,W*u)}else throw new Error(`bad image kind: ${l.kind}`)}function r(E,l){if(l.bitmap){E.drawImage(l.bitmap,0,0);return}const o=l.height,A=l.width,T=o%u,e=(o-T)/u,i=T===0?e:e+1,h=E.createImageData(A,u);let y=0;const C=l.data,k=h.data;for(let R=0;R<i;R++){const W=R<e?u:T;({srcPos:y}=(0,F.convertBlackAndWhiteToRGBA)({src:C,srcPos:y,dest:k,width:A,height:W,nonBlackColor:0})),E.putImageData(h,0,R*u)}}function p(E,l){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const A of o)E[A]!==void 0&&(l[A]=E[A]);E.setLineDash!==void 0&&(l.setLineDash(E.getLineDash()),l.lineDashOffset=E.lineDashOffset)}function P(E){E.strokeStyle=E.fillStyle="#000000",E.fillRule="nonzero",E.globalAlpha=1,E.lineWidth=1,E.lineCap="butt",E.lineJoin="miter",E.miterLimit=10,E.globalCompositeOperation="source-over",E.font="10px sans-serif",E.setLineDash!==void 0&&(E.setLineDash([]),E.lineDashOffset=0),j.isNodeJS||(E.filter="none")}function B(E,l,o,A){const T=E.length;for(let e=3;e<T;e+=4){const i=E[e];if(i===0)E[e-3]=l,E[e-2]=o,E[e-1]=A;else if(i<255){const h=255-i;E[e-3]=E[e-3]*i+l*h>>8,E[e-2]=E[e-2]*i+o*h>>8,E[e-1]=E[e-1]*i+A*h>>8}}}function O(E,l,o){const A=E.length,T=1/255;for(let e=3;e<A;e+=4){const i=o?o[E[e]]:E[e];l[e]=l[e]*i*T|0}}function H(E,l,o){const A=E.length;for(let T=3;T<A;T+=4){const e=E[T-3]*77+E[T-2]*152+E[T-1]*28;l[T]=o?l[T]*o[e>>8]>>8:l[T]*e>>16}}function q(E,l,o,A,T,e,i,h,y,C,k){const R=!!e,W=R?e[0]:0,z=R?e[1]:0,U=R?e[2]:0;let $;T==="Luminosity"?$=H:$=O;const Y=Math.min(A,Math.ceil(1048576/o));for(let et=0;et<A;et+=Y){const st=Math.min(Y,A-et),nt=E.getImageData(h-C,et+(y-k),o,st),at=l.getImageData(h,et+y,o,st);R&&B(nt.data,W,z,U),$(nt.data,at.data,i),l.putImageData(at,h,et+y)}}function K(E,l,o,A){const T=A[0],e=A[1],i=A[2]-T,h=A[3]-e;i===0||h===0||(q(l.context,o,i,h,l.subtype,l.backdrop,l.transferMap,T,e,l.offsetX,l.offsetY),E.save(),E.globalAlpha=1,E.globalCompositeOperation="source-over",E.setTransform(1,0,0,1,0,0),E.drawImage(o.canvas,0,0),E.restore())}function it(E,l){const o=a.Util.singularValueDecompose2dScale(E);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const A=Math.fround((globalThis.devicePixelRatio||1)*b.PixelsPerInch.PDF_TO_CSS_UNITS);return l!==void 0?l:o[0]<=A||o[1]<=A}const J=["butt","round","square"],Z=["miter","round","bevel"],V={},I={};class N{constructor(l,o,A,T,e,{optionalContentConfig:i,markedContentStack:h=null},y){this.ctx=l,this.current=new D(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=A,this.canvasFactory=T,this.filterFactory=e,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=h||[],this.optionalContentConfig=i,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=y,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(l,o=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):o}beginDrawing({transform:l,viewport:o,transparency:A=!1,background:T=null}){const e=this.ctx.canvas.width,i=this.ctx.canvas.height,h=this.ctx.fillStyle;if(this.ctx.fillStyle=T||"#ffffff",this.ctx.fillRect(0,0,e,i),this.ctx.fillStyle=h,A){const y=this.cachedCanvases.getCanvas("transparent",e,i);this.compositeCtx=this.ctx,this.transparentCanvas=y.canvas,this.ctx=y.context,this.ctx.save(),this.ctx.transform(...(0,b.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),P(this.ctx),l&&(this.ctx.transform(...l),this.outputScaleX=l[0],this.outputScaleY=l[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,b.getCurrentTransform)(this.ctx)}executeOperatorList(l,o,A,T){const e=l.argsArray,i=l.fnArray;let h=o||0;const y=e.length;if(y===h)return h;const C=y-h>f&&typeof A=="function",k=C?Date.now()+c:0;let R=0;const W=this.commonObjs,z=this.objs;let U;for(;;){if(T!==void 0&&h===T.nextBreakPoint)return T.breakIt(h,A),h;if(U=i[h],U!==a.OPS.dependency)this[U].apply(this,e[h]);else for(const $ of e[h]){const tt=$.startsWith("g_")?W:z;if(!tt.has($))return tt.get($,A),h}if(h++,h===y)return h;if(C&&++R>f){if(Date.now()>k)return A(),h;R=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(l=null){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const o of this._cachedBitmapsMap.values()){for(const A of o.values())typeof HTMLCanvasElement<"u"&&A instanceof HTMLCanvasElement&&(A.width=A.height=0);o.clear()}if(this._cachedBitmapsMap.clear(),l){const o=this.filterFactory.addHCMFilter(l.foreground,l.background);if(o!=="none"){const A=this.ctx.filter;this.ctx.filter=o,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=A}}}_scaleImage(l,o){const A=l.width,T=l.height;let e=Math.max(Math.hypot(o[0],o[1]),1),i=Math.max(Math.hypot(o[2],o[3]),1),h=A,y=T,C="prescale1",k,R;for(;e>2&&h>1||i>2&&y>1;){let W=h,z=y;e>2&&h>1&&(W=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h/2),e/=h/W),i>2&&y>1&&(z=y>=16384?Math.floor(y/2)-1||1:Math.ceil(y)/2,i/=y/z),k=this.cachedCanvases.getCanvas(C,W,z),R=k.context,R.clearRect(0,0,W,z),R.drawImage(l,0,0,h,y,0,0,W,z),l=k.canvas,h=W,y=z,C=C==="prescale1"?"prescale2":"prescale1"}return{img:l,paintWidth:h,paintHeight:y}}_createMaskCanvas(l){const o=this.ctx,{width:A,height:T}=l,e=this.current.fillColor,i=this.current.patternFill,h=(0,b.getCurrentTransform)(o);let y,C,k,R;if((l.bitmap||l.data)&&l.count>1){const ht=l.bitmap||l.data.buffer;C=JSON.stringify(i?h:[h.slice(0,4),e]),y=this._cachedBitmapsMap.get(ht),y||(y=new Map,this._cachedBitmapsMap.set(ht,y));const lt=y.get(C);if(lt&&!i){const gt=Math.round(Math.min(h[0],h[2])+h[4]),mt=Math.round(Math.min(h[1],h[3])+h[5]);return{canvas:lt,offsetX:gt,offsetY:mt}}k=lt}k||(R=this.cachedCanvases.getCanvas("maskCanvas",A,T),r(R.context,l));let W=a.Util.transform(h,[1/A,0,0,-1/T,0,0]);W=a.Util.transform(W,[1,0,0,1,0,-T]);const z=a.Util.applyTransform([0,0],W),U=a.Util.applyTransform([A,T],W),$=a.Util.normalizeRect([z[0],z[1],U[0],U[1]]),tt=Math.round($[2]-$[0])||1,Y=Math.round($[3]-$[1])||1,et=this.cachedCanvases.getCanvas("fillCanvas",tt,Y),st=et.context,nt=Math.min(z[0],U[0]),at=Math.min(z[1],U[1]);st.translate(-nt,-at),st.transform(...W),k||(k=this._scaleImage(R.canvas,(0,b.getCurrentTransformInverse)(st)),k=k.img,y&&i&&y.set(C,k)),st.imageSmoothingEnabled=it((0,b.getCurrentTransform)(st),l.interpolate),d(st,k,0,0,k.width,k.height,0,0,A,T),st.globalCompositeOperation="source-in";const ot=a.Util.transform((0,b.getCurrentTransformInverse)(st),[1,0,0,1,-nt,-at]);return st.fillStyle=i?e.getPattern(o,this,ot,M.PathType.FILL):e,st.fillRect(0,0,A,T),y&&!i&&(this.cachedCanvases.delete("fillCanvas"),y.set(C,et.canvas)),{canvas:et.canvas,offsetX:Math.round(nt),offsetY:Math.round(at)}}setLineWidth(l){l!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=l,this.ctx.lineWidth=l}setLineCap(l){this.ctx.lineCap=J[l]}setLineJoin(l){this.ctx.lineJoin=Z[l]}setMiterLimit(l){this.ctx.miterLimit=l}setDash(l,o){const A=this.ctx;A.setLineDash!==void 0&&(A.setLineDash(l),A.lineDashOffset=o)}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[o,A]of l)switch(o){case"LW":this.setLineWidth(A);break;case"LC":this.setLineCap(A);break;case"LJ":this.setLineJoin(A);break;case"ML":this.setMiterLimit(A);break;case"D":this.setDash(A[0],A[1]);break;case"RI":this.setRenderingIntent(A);break;case"FL":this.setFlatness(A);break;case"Font":this.setFont(A[0],A[1]);break;case"CA":this.current.strokeAlpha=A;break;case"ca":this.current.fillAlpha=A,this.ctx.globalAlpha=A;break;case"BM":this.ctx.globalCompositeOperation=A;break;case"SMask":this.current.activeSMask=A?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(A);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const l=this.inSMaskMode;this.current.activeSMask&&!l?this.beginSMaskMode():!this.current.activeSMask&&l&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const l=this.ctx.canvas.width,o=this.ctx.canvas.height,A="smaskGroupAt"+this.groupLevel,T=this.cachedCanvases.getCanvas(A,l,o);this.suspendedCtx=this.ctx,this.ctx=T.context;const e=this.ctx;e.setTransform(...(0,b.getCurrentTransform)(this.suspendedCtx)),p(this.suspendedCtx,e),_(e,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),p(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(l){if(!this.current.activeSMask)return;l?(l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l[2]=Math.ceil(l[2]),l[3]=Math.ceil(l[3])):l=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,A=this.suspendedCtx;K(A,o,this.ctx,l),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(p(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const l=this.current;this.stateStack.push(l),this.current=l.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),p(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(l,o,A,T,e,i){this.ctx.transform(l,o,A,T,e,i),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(l,o,A){const T=this.ctx,e=this.current;let i=e.x,h=e.y,y,C;const k=(0,b.getCurrentTransform)(T),R=k[0]===0&&k[3]===0||k[1]===0&&k[2]===0,W=R?A.slice(0):null;for(let z=0,U=0,$=l.length;z<$;z++)switch(l[z]|0){case a.OPS.rectangle:i=o[U++],h=o[U++];const tt=o[U++],Y=o[U++],et=i+tt,st=h+Y;T.moveTo(i,h),tt===0||Y===0?T.lineTo(et,st):(T.lineTo(et,h),T.lineTo(et,st),T.lineTo(i,st)),R||e.updateRectMinMax(k,[i,h,et,st]),T.closePath();break;case a.OPS.moveTo:i=o[U++],h=o[U++],T.moveTo(i,h),R||e.updatePathMinMax(k,i,h);break;case a.OPS.lineTo:i=o[U++],h=o[U++],T.lineTo(i,h),R||e.updatePathMinMax(k,i,h);break;case a.OPS.curveTo:y=i,C=h,i=o[U+4],h=o[U+5],T.bezierCurveTo(o[U],o[U+1],o[U+2],o[U+3],i,h),e.updateCurvePathMinMax(k,y,C,o[U],o[U+1],o[U+2],o[U+3],i,h,W),U+=6;break;case a.OPS.curveTo2:y=i,C=h,T.bezierCurveTo(i,h,o[U],o[U+1],o[U+2],o[U+3]),e.updateCurvePathMinMax(k,y,C,i,h,o[U],o[U+1],o[U+2],o[U+3],W),i=o[U+2],h=o[U+3],U+=4;break;case a.OPS.curveTo3:y=i,C=h,i=o[U+2],h=o[U+3],T.bezierCurveTo(o[U],o[U+1],i,h,i,h),e.updateCurvePathMinMax(k,y,C,o[U],o[U+1],i,h,i,h,W),U+=4;break;case a.OPS.closePath:T.closePath();break}R&&e.updateScalingPathMinMax(k,W),e.setCurrentPoint(i,h)}closePath(){this.ctx.closePath()}stroke(l=!0){const o=this.ctx,A=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof A=="object"&&A?.getPattern?(o.save(),o.strokeStyle=A.getPattern(o,this,(0,b.getCurrentTransformInverse)(o),M.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),l&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(l=!0){const o=this.ctx,A=this.current.fillColor,T=this.current.patternFill;let e=!1;T&&(o.save(),o.fillStyle=A.getPattern(o,this,(0,b.getCurrentTransformInverse)(o),M.PathType.FILL),e=!0);const i=this.current.getClippedPathBoundingBox();this.contentVisible&&i!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),e&&o.restore(),l&&this.consumePath(i)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=I}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const l=this.pendingTextPaths,o=this.ctx;if(l===void 0){o.beginPath();return}o.save(),o.beginPath();for(const A of l)o.setTransform(...A.transform),o.translate(A.x,A.y),A.addToPath(o,A.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(l){this.current.charSpacing=l}setWordSpacing(l){this.current.wordSpacing=l}setHScale(l){this.current.textHScale=l/100}setLeading(l){this.current.leading=-l}setFont(l,o){const A=this.commonObjs.get(l),T=this.current;if(!A)throw new Error(`Can't find font for ${l}`);if(T.fontMatrix=A.fontMatrix||a.FONT_IDENTITY_MATRIX,(T.fontMatrix[0]===0||T.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+l),o<0?(o=-o,T.fontDirection=-1):T.fontDirection=1,this.current.font=A,this.current.fontSize=o,A.isType3Font)return;const e=A.loadedName||"sans-serif";let i="normal";A.black?i="900":A.bold&&(i="bold");const h=A.italic?"italic":"normal",y=`"${e}", ${A.fallbackName}`;let C=o;o<v?C=v:o>m&&(C=m),this.current.fontSizeScale=o/C,this.ctx.font=`${h} ${i} ${C}px ${y}`}setTextRenderingMode(l){this.current.textRenderingMode=l}setTextRise(l){this.current.textRise=l}moveText(l,o){this.current.x=this.current.lineX+=l,this.current.y=this.current.lineY+=o}setLeadingMoveText(l,o){this.setLeading(-o),this.moveText(l,o)}setTextMatrix(l,o,A,T,e,i){this.current.textMatrix=[l,o,A,T,e,i],this.current.textMatrixScale=Math.hypot(l,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(l,o,A,T){const e=this.ctx,i=this.current,h=i.font,y=i.textRenderingMode,C=i.fontSize/i.fontSizeScale,k=y&a.TextRenderingMode.FILL_STROKE_MASK,R=!!(y&a.TextRenderingMode.ADD_TO_PATH_FLAG),W=i.patternFill&&!h.missingFile;let z;(h.disableFontFace||R||W)&&(z=h.getPathGenerator(this.commonObjs,l)),h.disableFontFace||W?(e.save(),e.translate(o,A),e.beginPath(),z(e,C),T&&e.setTransform(...T),(k===a.TextRenderingMode.FILL||k===a.TextRenderingMode.FILL_STROKE)&&e.fill(),(k===a.TextRenderingMode.STROKE||k===a.TextRenderingMode.FILL_STROKE)&&e.stroke(),e.restore()):((k===a.TextRenderingMode.FILL||k===a.TextRenderingMode.FILL_STROKE)&&e.fillText(l,o,A),(k===a.TextRenderingMode.STROKE||k===a.TextRenderingMode.FILL_STROKE)&&e.strokeText(l,o,A)),R&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,b.getCurrentTransform)(e),x:o,y:A,fontSize:C,addToPath:z})}get isFontSubpixelAAEnabled(){const{context:l}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);l.scale(1.5,1),l.fillText("I",0,10);const o=l.getImageData(0,0,10,10).data;let A=!1;for(let T=3;T<o.length;T+=4)if(o[T]>0&&o[T]<255){A=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",A)}showText(l){const o=this.current,A=o.font;if(A.isType3Font)return this.showType3Text(l);const T=o.fontSize;if(T===0)return;const e=this.ctx,i=o.fontSizeScale,h=o.charSpacing,y=o.wordSpacing,C=o.fontDirection,k=o.textHScale*C,R=l.length,W=A.vertical,z=W?1:-1,U=A.defaultVMetrics,$=T*o.fontMatrix[0],tt=o.textRenderingMode===a.TextRenderingMode.FILL&&!A.disableFontFace&&!o.patternFill;e.save(),e.transform(...o.textMatrix),e.translate(o.x,o.y+o.textRise),C>0?e.scale(k,-1):e.scale(k,1);let Y;if(o.patternFill){e.save();const ot=o.fillColor.getPattern(e,this,(0,b.getCurrentTransformInverse)(e),M.PathType.FILL);Y=(0,b.getCurrentTransform)(e),e.restore(),e.fillStyle=ot}let et=o.lineWidth;const st=o.textMatrixScale;if(st===0||et===0){const ot=o.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(ot===a.TextRenderingMode.STROKE||ot===a.TextRenderingMode.FILL_STROKE)&&(et=this.getSinglePixelWidth())}else et/=st;if(i!==1&&(e.scale(i,i),et/=i),e.lineWidth=et,A.isInvalidPDFjsFont){const ot=[];let ht=0;for(const lt of l)ot.push(lt.unicode),ht+=lt.width;e.fillText(ot.join(""),0,0),o.x+=ht*$*k,e.restore(),this.compose();return}let nt=0,at;for(at=0;at<R;++at){const ot=l[at];if(typeof ot=="number"){nt+=z*ot*T/1e3;continue}let ht=!1;const lt=(ot.isSpace?y:0)+h,gt=ot.fontChar,mt=ot.accent;let dt,St,yt=ot.width;if(W){const _t=ot.vmetric||U,Q=-(ot.vmetric?_t[1]:yt*.5)*$,X=_t[2]*$;yt=_t?-_t[0]:yt,dt=Q/i,St=(nt+X)/i}else dt=nt/i,St=0;if(A.remeasure&&yt>0){const _t=e.measureText(gt).width*1e3/T*i;if(yt<_t&&this.isFontSubpixelAAEnabled){const Q=yt/_t;ht=!0,e.save(),e.scale(Q,1),dt/=Q}else yt!==_t&&(dt+=(yt-_t)/2e3*T/i)}if(this.contentVisible&&(ot.isInFont||A.missingFile)){if(tt&&!mt)e.fillText(gt,dt,St);else if(this.paintChar(gt,dt,St,Y),mt){const _t=dt+T*mt.offset.x/i,Q=St-T*mt.offset.y/i;this.paintChar(mt.fontChar,_t,Q,Y)}}let Pt;W?Pt=yt*$-lt*C:Pt=yt*$+lt*C,nt+=Pt,ht&&e.restore()}W?o.y-=nt:o.x+=nt*k,e.restore(),this.compose()}showType3Text(l){const o=this.ctx,A=this.current,T=A.font,e=A.fontSize,i=A.fontDirection,h=T.vertical?1:-1,y=A.charSpacing,C=A.wordSpacing,k=A.textHScale*i,R=A.fontMatrix||a.FONT_IDENTITY_MATRIX,W=l.length,z=A.textRenderingMode===a.TextRenderingMode.INVISIBLE;let U,$,tt,Y;if(!(z||e===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...A.textMatrix),o.translate(A.x,A.y),o.scale(k,i),U=0;U<W;++U){if($=l[U],typeof $=="number"){Y=h*$*e/1e3,this.ctx.translate(Y,0),A.x+=Y*k;continue}const et=($.isSpace?C:0)+y,st=T.charProcOperatorList[$.operatorListId];if(!st){(0,a.warn)(`Type3 character "${$.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=$,this.save(),o.scale(e,e),o.transform(...R),this.executeOperatorList(st),this.restore()),tt=a.Util.applyTransform([$.width,0],R)[0]*e+et,o.translate(tt,0),A.x+=tt*k}o.restore(),this.processingType3=null}}setCharWidth(l,o){}setCharWidthAndBounds(l,o,A,T,e,i){this.ctx.rect(A,T,e-A,i-T),this.ctx.clip(),this.endPath()}getColorN_Pattern(l){let o;if(l[0]==="TilingPattern"){const A=l[1],T=this.baseTransform||(0,b.getCurrentTransform)(this.ctx),e={createCanvasGraphics:i=>new N(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new M.TilingPattern(l,A,this.ctx,e,T)}else o=this._getPattern(l[1],l[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(l,o,A){const T=a.Util.makeHexColor(l,o,A);this.ctx.strokeStyle=T,this.current.strokeColor=T}setFillRGBColor(l,o,A){const T=a.Util.makeHexColor(l,o,A);this.ctx.fillStyle=T,this.current.fillColor=T,this.current.patternFill=!1}_getPattern(l,o=null){let A;return this.cachedPatterns.has(l)?A=this.cachedPatterns.get(l):(A=(0,M.getShadingPattern)(this.getObject(l)),this.cachedPatterns.set(l,A)),o&&(A.matrix=o),A}shadingFill(l){if(!this.contentVisible)return;const o=this.ctx;this.save();const A=this._getPattern(l);o.fillStyle=A.getPattern(o,this,(0,b.getCurrentTransformInverse)(o),M.PathType.SHADING);const T=(0,b.getCurrentTransformInverse)(o);if(T){const e=o.canvas,i=e.width,h=e.height,y=a.Util.applyTransform([0,0],T),C=a.Util.applyTransform([0,h],T),k=a.Util.applyTransform([i,0],T),R=a.Util.applyTransform([i,h],T),W=Math.min(y[0],C[0],k[0],R[0]),z=Math.min(y[1],C[1],k[1],R[1]),U=Math.max(y[0],C[0],k[0],R[0]),$=Math.max(y[1],C[1],k[1],R[1]);this.ctx.fillRect(W,z,U-W,$-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(l,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(l)&&l.length===6&&this.transform(...l),this.baseTransform=(0,b.getCurrentTransform)(this.ctx),o)){const A=o[2]-o[0],T=o[3]-o[1];this.ctx.rect(o[0],o[1],A,T),this.current.updateRectMinMax((0,b.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(l){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;l.isolated||(0,a.info)("TODO: Support non-isolated groups."),l.knockout&&(0,a.warn)("Knockout groups not supported.");const A=(0,b.getCurrentTransform)(o);if(l.matrix&&o.transform(...l.matrix),!l.bbox)throw new Error("Bounding box is required.");let T=a.Util.getAxialAlignedBoundingBox(l.bbox,(0,b.getCurrentTransform)(o));const e=[0,0,o.canvas.width,o.canvas.height];T=a.Util.intersect(T,e)||[0,0,0,0];const i=Math.floor(T[0]),h=Math.floor(T[1]);let y=Math.max(Math.ceil(T[2])-i,1),C=Math.max(Math.ceil(T[3])-h,1),k=1,R=1;y>t&&(k=y/t,y=t),C>t&&(R=C/t,C=t),this.current.startNewPathAndClipBox([0,0,y,C]);let W="groupAt"+this.groupLevel;l.smask&&(W+="_smask_"+this.smaskCounter++%2);const z=this.cachedCanvases.getCanvas(W,y,C),U=z.context;U.scale(1/k,1/R),U.translate(-i,-h),U.transform(...A),l.smask?this.smaskStack.push({canvas:z.canvas,context:U,offsetX:i,offsetY:h,scaleX:k,scaleY:R,subtype:l.smask.subtype,backdrop:l.smask.backdrop,transferMap:l.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(i,h),o.scale(k,R),o.save()),p(o,U),this.ctx=U,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(l){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,A=this.groupStack.pop();if(this.ctx=A,this.ctx.imageSmoothingEnabled=!1,l.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const T=(0,b.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...T);const e=a.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],T);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(e)}}beginAnnotation(l,o,A,T,e){if(this.#t(),P(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const i=o[2]-o[0],h=o[3]-o[1];if(e&&this.annotationCanvasMap){A=A.slice(),A[4]-=o[0],A[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=i,o[3]=h;const[y,C]=a.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(this.ctx)),{viewportScale:k}=this,R=Math.ceil(i*this.outputScaleX*k),W=Math.ceil(h*this.outputScaleY*k);this.annotationCanvas=this.canvasFactory.create(R,W);const{canvas:z,context:U}=this.annotationCanvas;this.annotationCanvasMap.set(l,z),this.annotationCanvas.savedCtx=this.ctx,this.ctx=U,this.ctx.setTransform(y,0,0,-C,0,h*C),P(this.ctx)}else P(this.ctx),this.ctx.rect(o[0],o[1],i,h),this.ctx.clip(),this.endPath()}this.current=new D(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...A),this.transform(...T)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(l){if(!this.contentVisible)return;const o=l.count;l=this.getObject(l.data,l),l.count=o;const A=this.ctx,T=this.processingType3;if(T&&(T.compiled===void 0&&(T.compiled=w(l)),T.compiled)){T.compiled(A);return}const e=this._createMaskCanvas(l),i=e.canvas;A.save(),A.setTransform(1,0,0,1,0,0),A.drawImage(i,e.offsetX,e.offsetY),A.restore(),this.compose()}paintImageMaskXObjectRepeat(l,o,A=0,T=0,e,i){if(!this.contentVisible)return;l=this.getObject(l.data,l);const h=this.ctx;h.save();const y=(0,b.getCurrentTransform)(h);h.transform(o,A,T,e,0,0);const C=this._createMaskCanvas(l);h.setTransform(1,0,0,1,C.offsetX-y[4],C.offsetY-y[5]);for(let k=0,R=i.length;k<R;k+=2){const W=a.Util.transform(y,[o,A,T,e,i[k],i[k+1]]),[z,U]=a.Util.applyTransform([0,0],W);h.drawImage(C.canvas,z,U)}h.restore(),this.compose()}paintImageMaskXObjectGroup(l){if(!this.contentVisible)return;const o=this.ctx,A=this.current.fillColor,T=this.current.patternFill;for(const e of l){const{data:i,width:h,height:y,transform:C}=e,k=this.cachedCanvases.getCanvas("maskCanvas",h,y),R=k.context;R.save();const W=this.getObject(i,e);r(R,W),R.globalCompositeOperation="source-in",R.fillStyle=T?A.getPattern(R,this,(0,b.getCurrentTransformInverse)(o),M.PathType.FILL):A,R.fillRect(0,0,h,y),R.restore(),o.save(),o.transform(...C),o.scale(1,-1),d(o,k.canvas,0,0,h,y,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(l){if(!this.contentVisible)return;const o=this.getObject(l);if(!o){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(l,o,A,T){if(!this.contentVisible)return;const e=this.getObject(l);if(!e){(0,a.warn)("Dependent image isn't ready yet");return}const i=e.width,h=e.height,y=[];for(let C=0,k=T.length;C<k;C+=2)y.push({transform:[o,0,0,A,T[C],T[C+1]],x:0,y:0,w:i,h});this.paintInlineImageXObjectGroup(e,y)}applyTransferMapsToCanvas(l){return this.current.transferMaps!=="none"&&(l.filter=this.current.transferMaps,l.drawImage(l.canvas,0,0),l.filter="none"),l.canvas}applyTransferMapsToBitmap(l){if(this.current.transferMaps==="none")return l.bitmap;const{bitmap:o,width:A,height:T}=l,e=this.cachedCanvases.getCanvas("inlineImage",A,T),i=e.context;return i.filter=this.current.transferMaps,i.drawImage(o,0,0),i.filter="none",e.canvas}paintInlineImageXObject(l){if(!this.contentVisible)return;const o=l.width,A=l.height,T=this.ctx;this.save(),j.isNodeJS||(T.filter="none"),T.scale(1/o,-1/A);let e;if(l.bitmap)e=this.applyTransferMapsToBitmap(l);else if(typeof HTMLElement=="function"&&l instanceof HTMLElement||!l.data)e=l;else{const y=this.cachedCanvases.getCanvas("inlineImage",o,A).context;S(y,l),e=this.applyTransferMapsToCanvas(y)}const i=this._scaleImage(e,(0,b.getCurrentTransformInverse)(T));T.imageSmoothingEnabled=it((0,b.getCurrentTransform)(T),l.interpolate),d(T,i.img,0,0,i.paintWidth,i.paintHeight,0,-A,o,A),this.compose(),this.restore()}paintInlineImageXObjectGroup(l,o){if(!this.contentVisible)return;const A=this.ctx;let T;if(l.bitmap)T=l.bitmap;else{const e=l.width,i=l.height,y=this.cachedCanvases.getCanvas("inlineImage",e,i).context;S(y,l),T=this.applyTransferMapsToCanvas(y)}for(const e of o)A.save(),A.transform(...e.transform),A.scale(1,-1),d(A,T,e.x,e.y,e.w,e.h,0,-1,1,1),A.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(l){}markPointProps(l,o){}beginMarkedContent(l){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(l,o){l==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(l){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(l);const A=this.ctx;this.pendingClip&&(o||(this.pendingClip===I?A.clip("evenodd"):A.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),A.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const l=(0,b.getCurrentTransform)(this.ctx);if(l[1]===0&&l[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(l[0]),Math.abs(l[3]));else{const o=Math.abs(l[0]*l[3]-l[2]*l[1]),A=Math.hypot(l[0],l[2]),T=Math.hypot(l[1],l[3]);this._cachedGetSinglePixelWidth=Math.max(A,T)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:l}=this.current,o=(0,b.getCurrentTransform)(this.ctx);let A,T;if(o[1]===0&&o[2]===0){const e=Math.abs(o[0]),i=Math.abs(o[3]);if(l===0)A=1/e,T=1/i;else{const h=e*l,y=i*l;A=h<1?1/h:1,T=y<1?1/y:1}}else{const e=Math.abs(o[0]*o[3]-o[2]*o[1]),i=Math.hypot(o[0],o[1]),h=Math.hypot(o[2],o[3]);if(l===0)A=h/e,T=i/e;else{const y=l*e;A=h>y?h/y:1,T=i>y?i/y:1}}this._cachedScaleForStroking=[A,T]}return this._cachedScaleForStroking}rescaleAndStroke(l){const{ctx:o}=this,{lineWidth:A}=this.current,[T,e]=this.getScaleForStroking();if(o.lineWidth=A||1,T===1&&e===1){o.stroke();return}let i,h,y;l&&(i=(0,b.getCurrentTransform)(o),h=o.getLineDash().slice(),y=o.lineDashOffset),o.scale(T,e);const C=Math.max(T,e);o.setLineDash(o.getLineDash().map(k=>k/C)),o.lineDashOffset/=C,o.stroke(),l&&(o.setTransform(...i),o.setLineDash(h),o.lineDashOffset=y)}isContentVisible(){for(let l=this.markedContentStack.length-1;l>=0;l--)if(!this.markedContentStack[l].visible)return!1;return!0}}s.CanvasGraphics=N;for(const E in a.OPS)N.prototype[E]!==void 0&&(N.prototype[a.OPS[E]]=N.prototype[E])},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TilingPattern=s.PathType=void 0,s.getShadingPattern=n;var a=x(1),b=x(6);const M={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};s.PathType=M;function F(g,d){if(!d)return;const w=d[2]-d[0],D=d[3]-d[1],S=new Path2D;S.rect(d[0],d[1],w,D),g.clip(S)}class j{constructor(){this.constructor===j&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class v extends j{constructor(d){super(),this._type=d[1],this._bbox=d[2],this._colorStops=d[3],this._p0=d[4],this._p1=d[5],this._r0=d[6],this._r1=d[7],this.matrix=null}_createGradient(d){let w;this._type==="axial"?w=d.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=d.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const D of this._colorStops)w.addColorStop(D[0],D[1]);return w}getPattern(d,w,D,S){let r;if(S===M.STROKE||S===M.FILL){const p=w.current.getClippedPathBoundingBox(S,(0,b.getCurrentTransform)(d))||[0,0,0,0],P=Math.ceil(p[2]-p[0])||1,B=Math.ceil(p[3]-p[1])||1,O=w.cachedCanvases.getCanvas("pattern",P,B,!0),H=O.context;H.clearRect(0,0,H.canvas.width,H.canvas.height),H.beginPath(),H.rect(0,0,H.canvas.width,H.canvas.height),H.translate(-p[0],-p[1]),D=a.Util.transform(D,[1,0,0,1,p[0],p[1]]),H.transform(...w.baseTransform),this.matrix&&H.transform(...this.matrix),F(H,this._bbox),H.fillStyle=this._createGradient(H),H.fill(),r=d.createPattern(O.canvas,"no-repeat");const q=new DOMMatrix(D);r.setTransform(q)}else F(d,this._bbox),r=this._createGradient(d);return r}}function m(g,d,w,D,S,r,p,P){const B=d.coords,O=d.colors,H=g.data,q=g.width*4;let K;B[w+1]>B[D+1]&&(K=w,w=D,D=K,K=r,r=p,p=K),B[D+1]>B[S+1]&&(K=D,D=S,S=K,K=p,p=P,P=K),B[w+1]>B[D+1]&&(K=w,w=D,D=K,K=r,r=p,p=K);const it=(B[w]+d.offsetX)*d.scaleX,J=(B[w+1]+d.offsetY)*d.scaleY,Z=(B[D]+d.offsetX)*d.scaleX,V=(B[D+1]+d.offsetY)*d.scaleY,I=(B[S]+d.offsetX)*d.scaleX,N=(B[S+1]+d.offsetY)*d.scaleY;if(J>=N)return;const E=O[r],l=O[r+1],o=O[r+2],A=O[p],T=O[p+1],e=O[p+2],i=O[P],h=O[P+1],y=O[P+2],C=Math.round(J),k=Math.round(N);let R,W,z,U,$,tt,Y,et;for(let st=C;st<=k;st++){if(st<V){let lt;st<J?lt=0:lt=(J-st)/(J-V),R=it-(it-Z)*lt,W=E-(E-A)*lt,z=l-(l-T)*lt,U=o-(o-e)*lt}else{let lt;st>N?lt=1:V===N?lt=0:lt=(V-st)/(V-N),R=Z-(Z-I)*lt,W=A-(A-i)*lt,z=T-(T-h)*lt,U=e-(e-y)*lt}let nt;st<J?nt=0:st>N?nt=1:nt=(J-st)/(J-N),$=it-(it-I)*nt,tt=E-(E-i)*nt,Y=l-(l-h)*nt,et=o-(o-y)*nt;const at=Math.round(Math.min(R,$)),ot=Math.round(Math.max(R,$));let ht=q*st+at*4;for(let lt=at;lt<=ot;lt++)nt=(R-lt)/(R-$),nt<0?nt=0:nt>1&&(nt=1),H[ht++]=W-(W-tt)*nt|0,H[ht++]=z-(z-Y)*nt|0,H[ht++]=U-(U-et)*nt|0,H[ht++]=255}}function t(g,d,w){const D=d.coords,S=d.colors;let r,p;switch(d.type){case"lattice":const P=d.verticesPerRow,B=Math.floor(D.length/P)-1,O=P-1;for(r=0;r<B;r++){let H=r*P;for(let q=0;q<O;q++,H++)m(g,w,D[H],D[H+1],D[H+P],S[H],S[H+1],S[H+P]),m(g,w,D[H+P+1],D[H+1],D[H+P],S[H+P+1],S[H+1],S[H+P])}break;case"triangles":for(r=0,p=D.length;r<p;r+=3)m(g,w,D[r],D[r+1],D[r+2],S[r],S[r+1],S[r+2]);break;default:throw new Error("illegal figure")}}class c extends j{constructor(d){super(),this._coords=d[2],this._colors=d[3],this._figures=d[4],this._bounds=d[5],this._bbox=d[7],this._background=d[8],this.matrix=null}_createMeshCanvas(d,w,D){const P=Math.floor(this._bounds[0]),B=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-P,H=Math.ceil(this._bounds[3])-B,q=Math.min(Math.ceil(Math.abs(O*d[0]*1.1)),3e3),K=Math.min(Math.ceil(Math.abs(H*d[1]*1.1)),3e3),it=O/q,J=H/K,Z={coords:this._coords,colors:this._colors,offsetX:-P,offsetY:-B,scaleX:1/it,scaleY:1/J},V=q+2*2,I=K+2*2,N=D.getCanvas("mesh",V,I,!1),E=N.context,l=E.createImageData(q,K);if(w){const A=l.data;for(let T=0,e=A.length;T<e;T+=4)A[T]=w[0],A[T+1]=w[1],A[T+2]=w[2],A[T+3]=255}for(const A of this._figures)t(l,A,Z);return E.putImageData(l,2,2),{canvas:N.canvas,offsetX:P-2*it,offsetY:B-2*J,scaleX:it,scaleY:J}}getPattern(d,w,D,S){F(d,this._bbox);let r;if(S===M.SHADING)r=a.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(d));else if(r=a.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const P=a.Util.singularValueDecompose2dScale(this.matrix);r=[r[0]*P[0],r[1]*P[1]]}const p=this._createMeshCanvas(r,S===M.SHADING?null:this._background,w.cachedCanvases);return S!==M.SHADING&&(d.setTransform(...w.baseTransform),this.matrix&&d.transform(...this.matrix)),d.translate(p.offsetX,p.offsetY),d.scale(p.scaleX,p.scaleY),d.createPattern(p.canvas,"no-repeat")}}class f extends j{getPattern(){return"hotpink"}}function n(g){switch(g[0]){case"RadialAxial":return new v(g);case"Mesh":return new c(g);case"Dummy":return new f}throw new Error(`Unknown IR type: ${g[0]}`)}const u={COLORED:1,UNCOLORED:2};class _{static get MAX_PATTERN_SIZE(){return(0,a.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(d,w,D,S,r){this.operatorList=d[2],this.matrix=d[3]||[1,0,0,1,0,0],this.bbox=d[4],this.xstep=d[5],this.ystep=d[6],this.paintType=d[7],this.tilingType=d[8],this.color=w,this.ctx=D,this.canvasGraphicsFactory=S,this.baseTransform=r}createPatternCanvas(d){const w=this.operatorList,D=this.bbox,S=this.xstep,r=this.ystep,p=this.paintType,P=this.tilingType,B=this.color,O=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+P);const H=D[0],q=D[1],K=D[2],it=D[3],J=a.Util.singularValueDecompose2dScale(this.matrix),Z=a.Util.singularValueDecompose2dScale(this.baseTransform),V=[J[0]*Z[0],J[1]*Z[1]],I=this.getSizeAndScale(S,this.ctx.canvas.width,V[0]),N=this.getSizeAndScale(r,this.ctx.canvas.height,V[1]),E=d.cachedCanvases.getCanvas("pattern",I.size,N.size,!0),l=E.context,o=O.createCanvasGraphics(l);o.groupLevel=d.groupLevel,this.setFillAndStrokeStyleToContext(o,p,B);let A=H,T=q,e=K,i=it;return H<0&&(A=0,e+=Math.abs(H)),q<0&&(T=0,i+=Math.abs(q)),l.translate(-(I.scale*A),-(N.scale*T)),o.transform(I.scale,0,0,N.scale,0,0),l.save(),this.clipBbox(o,A,T,e,i),o.baseTransform=(0,b.getCurrentTransform)(o.ctx),o.executeOperatorList(w),o.endDrawing(),{canvas:E.canvas,scaleX:I.scale,scaleY:N.scale,offsetX:A,offsetY:T}}getSizeAndScale(d,w,D){d=Math.abs(d);const S=Math.max(_.MAX_PATTERN_SIZE,w);let r=Math.ceil(d*D);return r>=S?r=S:D=r/d,{scale:D,size:r}}clipBbox(d,w,D,S,r){const p=S-w,P=r-D;d.ctx.rect(w,D,p,P),d.current.updateRectMinMax((0,b.getCurrentTransform)(d.ctx),[w,D,S,r]),d.clip(),d.endPath()}setFillAndStrokeStyleToContext(d,w,D){const S=d.ctx,r=d.current;switch(w){case u.COLORED:const p=this.ctx;S.fillStyle=p.fillStyle,S.strokeStyle=p.strokeStyle,r.fillColor=p.fillStyle,r.strokeColor=p.strokeStyle;break;case u.UNCOLORED:const P=a.Util.makeHexColor(D[0],D[1],D[2]);S.fillStyle=P,S.strokeStyle=P,r.fillColor=P,r.strokeColor=P;break;default:throw new a.FormatError(`Unsupported paint type: ${w}`)}}getPattern(d,w,D,S){let r=D;S!==M.SHADING&&(r=a.Util.transform(r,w.baseTransform),this.matrix&&(r=a.Util.transform(r,this.matrix)));const p=this.createPatternCanvas(w);let P=new DOMMatrix(r);P=P.translate(p.offsetX,p.offsetY),P=P.scale(1/p.scaleX,1/p.scaleY);const B=d.createPattern(p.canvas,"repeat");return B.setTransform(P),B}}s.TilingPattern=_},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.convertBlackAndWhiteToRGBA=M,s.convertToRGBA=b,s.grayToRGBA=j;var a=x(1);function b(v){switch(v.kind){case a.ImageKind.GRAYSCALE_1BPP:return M(v);case a.ImageKind.RGB_24BPP:return F(v)}return null}function M({src:v,srcPos:m=0,dest:t,width:c,height:f,nonBlackColor:n=4294967295,inverseDecode:u=!1}){const _=a.FeatureTest.isLittleEndian?4278190080:255,[g,d]=u?[n,_]:[_,n],w=c>>3,D=c&7,S=v.length;t=new Uint32Array(t.buffer);let r=0;for(let p=0;p<f;p++){for(const B=m+w;m<B;m++){const O=m<S?v[m]:255;t[r++]=O&128?d:g,t[r++]=O&64?d:g,t[r++]=O&32?d:g,t[r++]=O&16?d:g,t[r++]=O&8?d:g,t[r++]=O&4?d:g,t[r++]=O&2?d:g,t[r++]=O&1?d:g}if(D===0)continue;const P=m<S?v[m++]:255;for(let B=0;B<D;B++)t[r++]=P&1<<7-B?d:g}return{srcPos:m,destPos:r}}function F({src:v,srcPos:m=0,dest:t,destPos:c=0,width:f,height:n}){let u=0;const _=v.length>>2,g=new Uint32Array(v.buffer,m,_);if(a.FeatureTest.isLittleEndian){for(;u<_-2;u+=3,c+=4){const d=g[u],w=g[u+1],D=g[u+2];t[c]=d|4278190080,t[c+1]=d>>>24|w<<8|4278190080,t[c+2]=w>>>16|D<<16|4278190080,t[c+3]=D>>>8|4278190080}for(let d=u*4,w=v.length;d<w;d+=3)t[c++]=v[d]|v[d+1]<<8|v[d+2]<<16|4278190080}else{for(;u<_-2;u+=3,c+=4){const d=g[u],w=g[u+1],D=g[u+2];t[c]=d|255,t[c+1]=d<<24|w>>>8|255,t[c+2]=w<<16|D>>>16|255,t[c+3]=D<<8|255}for(let d=u*4,w=v.length;d<w;d+=3)t[c++]=v[d]<<24|v[d+1]<<16|v[d+2]<<8|255}return{srcPos:m,destPos:c}}function j(v,m){if(a.FeatureTest.isLittleEndian)for(let t=0,c=v.length;t<c;t++)m[t]=v[t]*65793|4278190080;else for(let t=0,c=v.length;t<c;t++)m[t]=v[t]*16843008|255}},(L,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.GlobalWorkerOptions=void 0;const x=Object.create(null);s.GlobalWorkerOptions=x,x.workerPort=null,x.workerSrc=""},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MessageHandler=void 0;var a=x(1);const b={UNKNOWN:0,DATA:1,ERROR:2},M={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function F(v){switch(v instanceof Error||typeof v=="object"&&v!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),v.name){case"AbortException":return new a.AbortException(v.message);case"MissingPDFException":return new a.MissingPDFException(v.message);case"PasswordException":return new a.PasswordException(v.message,v.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(v.message,v.status);case"UnknownErrorException":return new a.UnknownErrorException(v.message,v.details);default:return new a.UnknownErrorException(v.message,v.toString())}}class j{constructor(m,t,c){this.sourceName=m,this.targetName=t,this.comObj=c,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const n=f.data;if(n.targetName!==this.sourceName)return;if(n.stream){this._processStreamMessage(n);return}if(n.callback){const _=n.callbackId,g=this.callbackCapabilities[_];if(!g)throw new Error(`Cannot resolve callback ${_}`);if(delete this.callbackCapabilities[_],n.callback===b.DATA)g.resolve(n.data);else if(n.callback===b.ERROR)g.reject(F(n.reason));else throw new Error("Unexpected callback case");return}const u=this.actionHandler[n.action];if(!u)throw new Error(`Unknown action from worker: ${n.action}`);if(n.callbackId){const _=this.sourceName,g=n.sourceName;new Promise(function(d){d(u(n.data))}).then(function(d){c.postMessage({sourceName:_,targetName:g,callback:b.DATA,callbackId:n.callbackId,data:d})},function(d){c.postMessage({sourceName:_,targetName:g,callback:b.ERROR,callbackId:n.callbackId,reason:F(d)})});return}if(n.streamId){this._createStreamSink(n);return}u(n.data)},c.addEventListener("message",this._onComObjOnMessage)}on(m,t){const c=this.actionHandler;if(c[m])throw new Error(`There is already an actionName called "${m}"`);c[m]=t}send(m,t,c){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,data:t},c)}sendWithPromise(m,t,c){const f=this.callbackId++,n=(0,a.createPromiseCapability)();this.callbackCapabilities[f]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,callbackId:f,data:t},c)}catch(u){n.reject(u)}return n.promise}sendWithStream(m,t,c,f){const n=this.streamId++,u=this.sourceName,_=this.targetName,g=this.comObj;return new ReadableStream({start:d=>{const w=(0,a.createPromiseCapability)();return this.streamControllers[n]={controller:d,startCall:w,pullCall:null,cancelCall:null,isClosed:!1},g.postMessage({sourceName:u,targetName:_,action:m,streamId:n,data:t,desiredSize:d.desiredSize},f),w.promise},pull:d=>{const w=(0,a.createPromiseCapability)();return this.streamControllers[n].pullCall=w,g.postMessage({sourceName:u,targetName:_,stream:M.PULL,streamId:n,desiredSize:d.desiredSize}),w.promise},cancel:d=>{(0,a.assert)(d instanceof Error,"cancel must have a valid reason");const w=(0,a.createPromiseCapability)();return this.streamControllers[n].cancelCall=w,this.streamControllers[n].isClosed=!0,g.postMessage({sourceName:u,targetName:_,stream:M.CANCEL,streamId:n,reason:F(d)}),w.promise}},c)}_createStreamSink(m){const t=m.streamId,c=this.sourceName,f=m.sourceName,n=this.comObj,u=this,_=this.actionHandler[m.action],g={enqueue(d,w=1,D){if(this.isCancelled)return;const S=this.desiredSize;this.desiredSize-=w,S>0&&this.desiredSize<=0&&(this.sinkCapability=(0,a.createPromiseCapability)(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:c,targetName:f,stream:M.ENQUEUE,streamId:t,chunk:d},D)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:c,targetName:f,stream:M.CLOSE,streamId:t}),delete u.streamSinks[t])},error(d){(0,a.assert)(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:c,targetName:f,stream:M.ERROR,streamId:t,reason:F(d)}))},sinkCapability:(0,a.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:m.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[t]=g,new Promise(function(d){d(_(m.data,g))}).then(function(){n.postMessage({sourceName:c,targetName:f,stream:M.START_COMPLETE,streamId:t,success:!0})},function(d){n.postMessage({sourceName:c,targetName:f,stream:M.START_COMPLETE,streamId:t,reason:F(d)})})}_processStreamMessage(m){const t=m.streamId,c=this.sourceName,f=m.sourceName,n=this.comObj,u=this.streamControllers[t],_=this.streamSinks[t];switch(m.stream){case M.START_COMPLETE:m.success?u.startCall.resolve():u.startCall.reject(F(m.reason));break;case M.PULL_COMPLETE:m.success?u.pullCall.resolve():u.pullCall.reject(F(m.reason));break;case M.PULL:if(!_){n.postMessage({sourceName:c,targetName:f,stream:M.PULL_COMPLETE,streamId:t,success:!0});break}_.desiredSize<=0&&m.desiredSize>0&&_.sinkCapability.resolve(),_.desiredSize=m.desiredSize,new Promise(function(g){g(_.onPull&&_.onPull())}).then(function(){n.postMessage({sourceName:c,targetName:f,stream:M.PULL_COMPLETE,streamId:t,success:!0})},function(g){n.postMessage({sourceName:c,targetName:f,stream:M.PULL_COMPLETE,streamId:t,reason:F(g)})});break;case M.ENQUEUE:if((0,a.assert)(u,"enqueue should have stream controller"),u.isClosed)break;u.controller.enqueue(m.chunk);break;case M.CLOSE:if((0,a.assert)(u,"close should have stream controller"),u.isClosed)break;u.isClosed=!0,u.controller.close(),this._deleteStreamController(u,t);break;case M.ERROR:(0,a.assert)(u,"error should have stream controller"),u.controller.error(F(m.reason)),this._deleteStreamController(u,t);break;case M.CANCEL_COMPLETE:m.success?u.cancelCall.resolve():u.cancelCall.reject(F(m.reason)),this._deleteStreamController(u,t);break;case M.CANCEL:if(!_)break;new Promise(function(g){g(_.onCancel&&_.onCancel(F(m.reason)))}).then(function(){n.postMessage({sourceName:c,targetName:f,stream:M.CANCEL_COMPLETE,streamId:t,success:!0})},function(g){n.postMessage({sourceName:c,targetName:f,stream:M.CANCEL_COMPLETE,streamId:t,reason:F(g)})}),_.sinkCapability.reject(F(m.reason)),_.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(m,t){await Promise.allSettled([m.startCall&&m.startCall.promise,m.pullCall&&m.pullCall.promise,m.cancelCall&&m.cancelCall.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}s.MessageHandler=j},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Metadata=void 0;var a=x(1);class b{#t;#e;constructor({parsedData:F,rawData:j}){this.#t=F,this.#e=j}getRaw(){return this.#e}get(F){return this.#t.get(F)??null}getAll(){return(0,a.objectFromMap)(this.#t)}has(F){return this.#t.has(F)}}s.Metadata=b},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionalContentConfig=void 0;var a=x(1),b=x(8);const M=Symbol("INTERNAL");class F{#t=!0;constructor(m,t){this.name=m,this.intent=t}get visible(){return this.#t}_setVisible(m,t){m!==M&&(0,a.unreachable)("Internal method `_setVisible` called."),this.#t=t}}class j{#t=null;#e=new Map;#i=null;#s=null;constructor(m){if(this.name=null,this.creator=null,m!==null){this.name=m.name,this.creator=m.creator,this.#s=m.order;for(const t of m.groups)this.#e.set(t.id,new F(t.name,t.intent));if(m.baseState==="OFF")for(const t of this.#e.values())t._setVisible(M,!1);for(const t of m.on)this.#e.get(t)._setVisible(M,!0);for(const t of m.off)this.#e.get(t)._setVisible(M,!1);this.#i=this.getHash()}}#r(m){const t=m.length;if(t<2)return!0;const c=m[0];for(let f=1;f<t;f++){const n=m[f];let u;if(Array.isArray(n))u=this.#r(n);else if(this.#e.has(n))u=this.#e.get(n).visible;else return(0,a.warn)(`Optional content group not found: ${n}`),!0;switch(c){case"And":if(!u)return!1;break;case"Or":if(u)return!0;break;case"Not":return!u;default:return!0}}return c==="And"}isVisible(m){if(this.#e.size===0)return!0;if(!m)return(0,a.warn)("Optional content group not defined."),!0;if(m.type==="OCG")return this.#e.has(m.id)?this.#e.get(m.id).visible:((0,a.warn)(`Optional content group not found: ${m.id}`),!0);if(m.type==="OCMD"){if(m.expression)return this.#r(m.expression);if(!m.policy||m.policy==="AnyOn"){for(const t of m.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(m.policy==="AllOn"){for(const t of m.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(m.policy==="AnyOff"){for(const t of m.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(m.policy==="AllOff"){for(const t of m.ids){if(!this.#e.has(t))return(0,a.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${m.policy}.`),!0}return(0,a.warn)(`Unknown group type ${m.type}.`),!0}setVisibility(m,t=!0){if(!this.#e.has(m)){(0,a.warn)(`Optional content group not found: ${m}`);return}this.#e.get(m)._setVisible(M,!!t),this.#t=null}get hasInitialVisibility(){return this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}getGroup(m){return this.#e.get(m)||null}getHash(){if(this.#t!==null)return this.#t;const m=new b.MurmurHash3_64;for(const[t,c]of this.#e)m.update(`${t}:${c.visible}`);return this.#t=m.hexdigest()}}s.OptionalContentConfig=j},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFDataTransportStream=void 0;var a=x(1),b=x(6);class M{constructor({length:m,initialData:t,progressiveDone:c=!1,contentDispositionFilename:f=null,disableRange:n=!1,disableStream:u=!1},_){if((0,a.assert)(_,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=f,t?.length>0){const g=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=_,this._isStreamingSupported=!u,this._isRangeSupported=!n,this._contentLength=m,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,d)=>{this._onReceiveData({begin:g,chunk:d})}),this._pdfDataRangeTransport.addProgressListener((g,d)=>{this._onProgress({loaded:g,total:d})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:m,chunk:t}){const c=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(m===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(c):this._queuedChunks.push(c);else{const f=this._rangeReaders.some(function(n){return n._begin!==m?!1:(n._enqueue(c),!0)});(0,a.assert)(f,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(m){m.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:m.loaded}):this._fullRequestReader?.onProgress?.({loaded:m.loaded,total:m.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(m){const t=this._rangeReaders.indexOf(m);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const m=this._queuedChunks;return this._queuedChunks=null,new F(this,m,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(m,t){if(t<=this._progressiveDataLength)return null;const c=new j(this,m,t);return this._pdfDataRangeTransport.requestDataRange(m,t),this._rangeReaders.push(c),c}cancelAllRequests(m){this._fullRequestReader?.cancel(m);for(const t of this._rangeReaders.slice(0))t.cancel(m);this._pdfDataRangeTransport.abort()}}s.PDFDataTransportStream=M;class F{constructor(m,t,c=!1,f=null){this._stream=m,this._done=c||!1,this._filename=(0,b.isPdfFile)(f)?f:null,this._queuedChunks=t||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),m._fullRequestReader=this,this.onProgress=null}_enqueue(m){this._done||(this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunks.push(m),this._loaded+=m.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=(0,a.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class j{constructor(m,t,c){this._stream=m,this._begin=t,this._end=c,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(m){if(!this._done){if(this._requests.length===0)this._queuedChunk=m;else{this._requests.shift().resolve({value:m,done:!1});for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const m=(0,a.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(L,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaText=void 0;class x{static textContent(b){const M=[],F={items:M,styles:Object.create(null)};function j(v){if(!v)return;let m=null;const t=v.name;if(t==="#text")m=v.value;else if(x.shouldBuildText(t))v?.attributes?.textContent?m=v.attributes.textContent:v.value&&(m=v.value);else return;if(m!==null&&M.push({str:m}),!!v.children)for(const c of v.children)j(c)}return j(b),F}static shouldBuildText(b){return!(b==="textarea"||b==="input"||b==="option"||b==="select")}}s.XfaText=x},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NodeStandardFontDataFactory=s.NodeFilterFactory=s.NodeCanvasFactory=s.NodeCMapReaderFactory=void 0;var a=x(7);const b=function(m){return new Promise((t,c)=>{require$$5.readFile(m,(n,u)=>{if(n||!u){c(new Error(n));return}t(new Uint8Array(u))})})};class M extends a.BaseFilterFactory{}s.NodeFilterFactory=M;class F extends a.BaseCanvasFactory{_createCanvas(t,c){return require$$5.createCanvas(t,c)}}s.NodeCanvasFactory=F;class j extends a.BaseCMapReaderFactory{_fetchData(t,c){return b(t).then(f=>({cMapData:f,compressionType:c}))}}s.NodeCMapReaderFactory=j;class v extends a.BaseStandardFontDataFactory{_fetchData(t){return b(t)}}s.NodeStandardFontDataFactory=v},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNodeStream=void 0;var a=x(1),b=x(22);const M=require$$5,F=require$$5,j=require$$5,v=require$$5,m=/^file:\/\/\/[a-zA-Z]:\//;function t(D){const S=v.parse(D);return S.protocol==="file:"||S.host?S:/^[a-z]:[/\\]/i.test(D)?v.parse(`file:///${D}`):(S.host||(S.protocol="file:"),S)}class c{constructor(S){this.source=S,this.url=t(S.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&S.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new _(this),this._fullRequestReader}getRangeReader(S,r){if(r<=this._progressiveDataLength)return null;const p=this.isFsUrl?new w(this,S,r):new g(this,S,r);return this._rangeRequestReaders.push(p),p}cancelAllRequests(S){this._fullRequestReader?.cancel(S);for(const r of this._rangeRequestReaders.slice(0))r.cancel(S)}}s.PDFNodeStream=c;class f{constructor(S){this._url=S.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=S.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)(),this._headersCapability=(0,a.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const S=this._readableStream.read();return S===null?(this._readCapability=(0,a.createPromiseCapability)(),this.read()):(this._loaded+=S.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(S).buffer,done:!1})}cancel(S){if(!this._readableStream){this._error(S);return}this._readableStream.destroy(S)}_error(S){this._storedError=S,this._readCapability.resolve()}_setReadableStream(S){this._readableStream=S,S.on("readable",()=>{this._readCapability.resolve()}),S.on("end",()=>{S.destroy(),this._done=!0,this._readCapability.resolve()}),S.on("error",r=>{this._error(r)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class n{constructor(S){this._url=S.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)();const r=S.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const S=this._readableStream.read();return S===null?(this._readCapability=(0,a.createPromiseCapability)(),this.read()):(this._loaded+=S.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(S).buffer,done:!1})}cancel(S){if(!this._readableStream){this._error(S);return}this._readableStream.destroy(S)}_error(S){this._storedError=S,this._readCapability.resolve()}_setReadableStream(S){this._readableStream=S,S.on("readable",()=>{this._readCapability.resolve()}),S.on("end",()=>{S.destroy(),this._done=!0,this._readCapability.resolve()}),S.on("error",r=>{this._error(r)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(D,S){return{protocol:D.protocol,auth:D.auth,host:D.hostname,port:D.port,path:D.path,method:"GET",headers:S}}class _ extends f{constructor(S){super(S);const r=p=>{if(p.statusCode===404){const H=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=H,this._headersCapability.reject(H);return}this._headersCapability.resolve(),this._setReadableStream(p);const P=H=>this._readableStream.headers[H.toLowerCase()],{allowRangeRequests:B,suggestedLength:O}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:P,isHttp:S.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=B,this._contentLength=O||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(P)};this._request=null,this._url.protocol==="http:"?this._request=F.request(u(this._url,S.httpHeaders),r):this._request=j.request(u(this._url,S.httpHeaders),r),this._request.on("error",p=>{this._storedError=p,this._headersCapability.reject(p)}),this._request.end()}}class g extends n{constructor(S,r,p){super(S),this._httpHeaders={};for(const B in S.httpHeaders){const O=S.httpHeaders[B];O!==void 0&&(this._httpHeaders[B]=O)}this._httpHeaders.Range=`bytes=${r}-${p-1}`;const P=B=>{if(B.statusCode===404){const O=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=O;return}this._setReadableStream(B)};this._request=null,this._url.protocol==="http:"?this._request=F.request(u(this._url,this._httpHeaders),P):this._request=j.request(u(this._url,this._httpHeaders),P),this._request.on("error",B=>{this._storedError=B}),this._request.end()}}class d extends f{constructor(S){super(S);let r=decodeURIComponent(this._url.path);m.test(this._url.href)&&(r=r.replace(/^\//,"")),M.lstat(r,(p,P)=>{if(p){p.code==="ENOENT"&&(p=new a.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=p,this._headersCapability.reject(p);return}this._contentLength=P.size,this._setReadableStream(M.createReadStream(r)),this._headersCapability.resolve()})}}class w extends n{constructor(S,r,p){super(S);let P=decodeURIComponent(this._url.path);m.test(this._url.href)&&(P=P.replace(/^\//,"")),this._setReadableStream(M.createReadStream(P,{start:r,end:p-1}))}}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createResponseStatusError=v,s.extractFilenameFromHeader=j,s.validateRangeRequestCapabilities=F,s.validateResponseStatus=m;var a=x(1),b=x(23),M=x(6);function F({getResponseHeader:t,isHttp:c,rangeChunkSize:f,disableRange:n}){const u={allowRangeRequests:!1,suggestedLength:void 0},_=parseInt(t("Content-Length"),10);return!Number.isInteger(_)||(u.suggestedLength=_,_<=2*f)||n||!c||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function j(t){const c=t("Content-Disposition");if(c){let f=(0,b.getFilenameFromContentDispositionHeader)(c);if(f.includes("%"))try{f=decodeURIComponent(f)}catch{}if((0,M.isPdfFile)(f))return f}return null}function v(t,c){return t===404||t===0&&c.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+c+'".'):new a.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${c}".`,t)}function m(t){return t===200||t===206}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getFilenameFromContentDispositionHeader=b;var a=x(1);function b(M){let F=!0,j=v("filename\\*","i").exec(M);if(j){j=j[1];let _=f(j);return _=unescape(_),_=n(_),_=u(_),t(_)}if(j=c(M),j){const _=u(j);return t(_)}if(j=v("filename","i").exec(M),j){j=j[1];let _=f(j);return _=u(_),t(_)}function v(_,g){return new RegExp("(?:^|;)\\s*"+_+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function m(_,g){if(_){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const d=new TextDecoder(_,{fatal:!0}),w=(0,a.stringToBytes)(g);g=d.decode(w),F=!1}catch{}}return g}function t(_){return F&&/[\x80-\xff]/.test(_)&&(_=m("utf-8",_),F&&(_=m("iso-8859-1",_))),_}function c(_){const g=[];let d;const w=v("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=w.exec(_))!==null;){let[,S,r,p]=d;if(S=parseInt(S,10),S in g){if(S===0)break;continue}g[S]=[r,p]}const D=[];for(let S=0;S<g.length&&S in g;++S){let[r,p]=g[S];p=f(p),r&&(p=unescape(p),S===0&&(p=n(p))),D.push(p)}return D.join("")}function f(_){if(_.startsWith('"')){const g=_.slice(1).split('\\"');for(let d=0;d<g.length;++d){const w=g[d].indexOf('"');w!==-1&&(g[d]=g[d].slice(0,w),g.length=d+1),g[d]=g[d].replaceAll(/\\(.)/g,"$1")}_=g.join('"')}return _}function n(_){const g=_.indexOf("'");if(g===-1)return _;const d=_.slice(0,g),D=_.slice(g+1).replace(/^[^']*'/,"");return m(d,D)}function u(_){return!_.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(_)?_:_.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,d,w,D){if(w==="q"||w==="Q")return D=D.replaceAll("_"," "),D=D.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,r){return String.fromCharCode(parseInt(r,16))}),m(d,D);try{D=atob(D)}catch{}return m(d,D)})}return""}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNetworkStream=void 0;var a=x(1),b=x(22);const M=200,F=206;function j(f){const n=f.response;return typeof n!="string"?n:(0,a.stringToBytes)(n).buffer}class v{constructor(n,u={}){this.url=n,this.isHttp=/^https?:/i.test(n),this.httpHeaders=this.isHttp&&u.httpHeaders||Object.create(null),this.withCredentials=u.withCredentials||!1,this.getXhr=u.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(n,u,_){const g={begin:n,end:u};for(const d in _)g[d]=_[d];return this.request(g)}requestFull(n){return this.request(n)}request(n){const u=this.getXhr(),_=this.currXhrId++,g=this.pendingRequests[_]={xhr:u};u.open("GET",this.url),u.withCredentials=this.withCredentials;for(const d in this.httpHeaders){const w=this.httpHeaders[d];w!==void 0&&u.setRequestHeader(d,w)}return this.isHttp&&"begin"in n&&"end"in n?(u.setRequestHeader("Range",`bytes=${n.begin}-${n.end-1}`),g.expectedStatus=F):g.expectedStatus=M,u.responseType="arraybuffer",n.onError&&(u.onerror=function(d){n.onError(u.status)}),u.onreadystatechange=this.onStateChange.bind(this,_),u.onprogress=this.onProgress.bind(this,_),g.onHeadersReceived=n.onHeadersReceived,g.onDone=n.onDone,g.onError=n.onError,g.onProgress=n.onProgress,u.send(null),_}onProgress(n,u){const _=this.pendingRequests[n];_&&_.onProgress?.(u)}onStateChange(n,u){const _=this.pendingRequests[n];if(!_)return;const g=_.xhr;if(g.readyState>=2&&_.onHeadersReceived&&(_.onHeadersReceived(),delete _.onHeadersReceived),g.readyState!==4||!(n in this.pendingRequests))return;if(delete this.pendingRequests[n],g.status===0&&this.isHttp){_.onError?.(g.status);return}const d=g.status||M;if(!(d===M&&_.expectedStatus===F)&&d!==_.expectedStatus){_.onError?.(g.status);return}const D=j(g);if(d===F){const S=g.getResponseHeader("Content-Range"),r=/bytes (\d+)-(\d+)\/(\d+)/.exec(S);_.onDone({begin:parseInt(r[1],10),chunk:D})}else D?_.onDone({begin:0,chunk:D}):_.onError?.(g.status)}getRequestXhr(n){return this.pendingRequests[n].xhr}isPendingRequest(n){return n in this.pendingRequests}abortRequest(n){const u=this.pendingRequests[n].xhr;delete this.pendingRequests[n],u.abort()}}class m{constructor(n){this._source=n,this._manager=new v(n.url,{httpHeaders:n.httpHeaders,withCredentials:n.withCredentials}),this._rangeChunkSize=n.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(n){const u=this._rangeRequestReaders.indexOf(n);u>=0&&this._rangeRequestReaders.splice(u,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(n,u){const _=new c(this._manager,n,u);return _.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(_),_}cancelAllRequests(n){this._fullRequestReader?.cancel(n);for(const u of this._rangeRequestReaders.slice(0))u.cancel(n)}}s.PDFNetworkStream=m;class t{constructor(n,u){this._manager=n;const _={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=u.url,this._fullRequestId=n.requestFull(_),this._headersReceivedCapability=(0,a.createPromiseCapability)(),this._disableRange=u.disableRange||!1,this._contentLength=u.length,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const n=this._fullRequestId,u=this._manager.getRequestXhr(n),_=w=>u.getResponseHeader(w),{allowRangeRequests:g,suggestedLength:d}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(_),this._isRangeSupported&&this._manager.abortRequest(n),this._headersReceivedCapability.resolve()}_onDone(n){if(n&&(this._requests.length>0?this._requests.shift().resolve({value:n.chunk,done:!1}):this._cachedChunks.push(n.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(n){this._storedError=(0,b.createResponseStatusError)(n,this._url),this._headersReceivedCapability.reject(this._storedError);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(n){this.onProgress?.({loaded:n.loaded,total:n.lengthComputable?n.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const n=(0,a.createPromiseCapability)();return this._requests.push(n),n.promise}cancel(n){this._done=!0,this._headersReceivedCapability.reject(n);for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class c{constructor(n,u,_){this._manager=n;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=n.url,this._requestId=n.requestRange(u,_,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(n){const u=n.chunk;this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunk=u,this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(n){this._storedError=(0,b.createResponseStatusError)(n,this._url);for(const u of this._requests)u.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(n){this.isStreamingSupported||this.onProgress?.({loaded:n.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const n=(0,a.createPromiseCapability)();return this._requests.push(n),n.promise}cancel(n){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFFetchStream=void 0;var a=x(1),b=x(22);function M(c,f,n){return{method:"GET",headers:c,signal:n.signal,mode:"cors",credentials:f?"include":"same-origin",redirect:"follow"}}function F(c){const f=new Headers;for(const n in c){const u=c[n];u!==void 0&&f.append(n,u)}return f}function j(c){return c instanceof Uint8Array?c.buffer:c instanceof ArrayBuffer?c:((0,a.warn)(`getArrayBuffer - unexpected data format: ${c}`),new Uint8Array(c).buffer)}class v{constructor(f){this.source=f,this.isHttp=/^https?:/i.test(f.url),this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new m(this),this._fullRequestReader}getRangeReader(f,n){if(n<=this._progressiveDataLength)return null;const u=new t(this,f,n);return this._rangeRequestReaders.push(u),u}cancelAllRequests(f){this._fullRequestReader?.cancel(f);for(const n of this._rangeRequestReaders.slice(0))n.cancel(f)}}s.PDFFetchStream=v;class m{constructor(f){this._stream=f,this._reader=null,this._loaded=0,this._filename=null;const n=f.source;this._withCredentials=n.withCredentials||!1,this._contentLength=n.length,this._headersCapability=(0,a.createPromiseCapability)(),this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._headers=F(this._stream.httpHeaders);const u=n.url;fetch(u,M(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,b.validateResponseStatus)(_.status))throw(0,b.createResponseStatusError)(_.status,u);this._reader=_.body.getReader(),this._headersCapability.resolve();const g=D=>_.headers.get(D),{allowRangeRequests:d,suggestedLength:w}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=d,this._contentLength=w||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:f,done:n}=await this._reader.read();return n?{value:f,done:n}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:j(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}class t{constructor(f,n,u){this._stream=f,this._reader=null,this._loaded=0;const _=f.source;this._withCredentials=_.withCredentials||!1,this._readCapability=(0,a.createPromiseCapability)(),this._isStreamingSupported=!_.disableStream,this._abortController=new AbortController,this._headers=F(this._stream.httpHeaders),this._headers.append("Range",`bytes=${n}-${u-1}`);const g=_.url;fetch(g,M(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,b.validateResponseStatus)(d.status))throw(0,b.createResponseStatusError)(d.status,g);this._readCapability.resolve(),this._reader=d.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:f,done:n}=await this._reader.read();return n?{value:f,done:n}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded}),{value:j(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TextLayerRenderTask=void 0,s.renderTextLayer=_,s.updateTextLayer=g;var a=x(1),b=x(6);const M=1e5,F=30,j=.8,v=new Map;function m(d,w){let D;if(w&&a.FeatureTest.isOffscreenCanvasSupported)D=new OffscreenCanvas(d,d).getContext("2d",{alpha:!1});else{const S=document.createElement("canvas");S.width=S.height=d,D=S.getContext("2d",{alpha:!1})}return D}function t(d,w){const D=v.get(d);if(D)return D;const S=m(F,w);S.font=`${F}px ${d}`;const r=S.measureText("");let p=r.fontBoundingBoxAscent,P=Math.abs(r.fontBoundingBoxDescent);if(p){const O=p/(p+P);return v.set(d,O),S.canvas.width=S.canvas.height=0,O}S.strokeStyle="red",S.clearRect(0,0,F,F),S.strokeText("g",0,0);let B=S.getImageData(0,0,F,F).data;P=0;for(let O=B.length-1-3;O>=0;O-=4)if(B[O]>0){P=Math.ceil(O/4/F);break}S.clearRect(0,0,F,F),S.strokeText("A",0,F),B=S.getImageData(0,0,F,F).data,p=0;for(let O=0,H=B.length;O<H;O+=4)if(B[O]>0){p=F-Math.floor(O/4/F);break}if(S.canvas.width=S.canvas.height=0,p){const O=p/(p+P);return v.set(d,O),O}return v.set(d,j),j}function c(d,w,D){const S=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};d._textDivs.push(S);const p=a.Util.transform(d._transform,w.transform);let P=Math.atan2(p[1],p[0]);const B=D[w.fontName];B.vertical&&(P+=Math.PI/2);const O=Math.hypot(p[2],p[3]),H=O*t(B.fontFamily,d._isOffscreenCanvasSupported);let q,K;P===0?(q=p[4],K=p[5]-H):(q=p[4]+H*Math.sin(P),K=p[5]-H*Math.cos(P));const it="calc(var(--scale-factor)*",J=S.style;d._container===d._rootContainer?(J.left=`${(100*q/d._pageWidth).toFixed(2)}%`,J.top=`${(100*K/d._pageHeight).toFixed(2)}%`):(J.left=`${it}${q.toFixed(2)}px)`,J.top=`${it}${K.toFixed(2)}px)`),J.fontSize=`${it}${O.toFixed(2)}px)`,J.fontFamily=B.fontFamily,r.fontSize=O,S.setAttribute("role","presentation"),S.textContent=w.str,S.dir=w.dir,d._fontInspectorEnabled&&(S.dataset.fontName=w.fontName),P!==0&&(r.angle=P*(180/Math.PI));let Z=!1;if(w.str.length>1)Z=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const V=Math.abs(w.transform[0]),I=Math.abs(w.transform[3]);V!==I&&Math.max(V,I)/Math.min(V,I)>1.5&&(Z=!0)}Z&&(r.canvasWidth=B.vertical?w.height:w.width),d._textDivProperties.set(S,r),d._isReadableStream&&d._layoutText(S)}function f(d){const{div:w,scale:D,properties:S,ctx:r,prevFontSize:p,prevFontFamily:P}=d,{style:B}=w;let O="";if(S.canvasWidth!==0&&S.hasText){const{fontFamily:H}=B,{canvasWidth:q,fontSize:K}=S;(p!==K||P!==H)&&(r.font=`${K*D}px ${H}`,d.prevFontSize=K,d.prevFontFamily=H);const{width:it}=r.measureText(w.textContent);it>0&&(O=`scaleX(${q*D/it})`)}S.angle!==0&&(O=`rotate(${S.angle}deg) ${O}`),O.length>0&&(B.transform=O)}function n(d){if(d._canceled)return;const w=d._textDivs,D=d._capability;if(w.length>M){D.resolve();return}if(!d._isReadableStream)for(const r of w)d._layoutText(r);D.resolve()}class u{constructor({textContentSource:w,container:D,viewport:S,textDivs:r,textDivProperties:p,textContentItemsStr:P,isOffscreenCanvasSupported:B}){this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=D,this._textDivs=r||[],this._textContentItemsStr=P||[],this._isOffscreenCanvasSupported=B,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=p||new WeakMap,this._canceled=!1,this._capability=(0,a.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:m(0,B)};const{pageWidth:O,pageHeight:H,pageX:q,pageY:K}=S.rawDims;this._transform=[1,0,0,-1,-q,K+H],this._pageWidth=O,this._pageHeight=H,(0,b.setLayerDimensions)(D,S),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(w,D){for(const S of w){if(S.str===void 0){if(S.type==="beginMarkedContentProps"||S.type==="beginMarkedContent"){const r=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),S.id!==null&&this._container.setAttribute("id",`${S.id}`),r.append(this._container)}else S.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(S.str),c(this,S,D)}}_layoutText(w){const D=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,f(this._layoutTextParams),D.hasText&&this._container.append(w),D.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this._container.append(S)}}_render(){const w=(0,a.createPromiseCapability)();let D=Object.create(null);if(this._isReadableStream){const S=()=>{this._reader.read().then(({value:r,done:p})=>{if(p){w.resolve();return}Object.assign(D,r.styles),this._processItems(r.items,D),S()},w.reject)};this._reader=this._textContentSource.getReader(),S()}else if(this._textContentSource){const{items:S,styles:r}=this._textContentSource;this._processItems(S,r),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{D=null,n(this)},this._capability.reject)}}s.TextLayerRenderTask=u;function _(d){!d.textContentSource&&(d.textContent||d.textContentStream)&&((0,b.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),d.textContentSource=d.textContent||d.textContentStream);const{container:w,viewport:D}=d,S=getComputedStyle(w),r=S.getPropertyValue("visibility"),p=parseFloat(S.getPropertyValue("--scale-factor"));r==="visible"&&(!p||Math.abs(p-D.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const P=new u(d);return P._render(),P}function g({container:d,viewport:w,textDivs:D,textDivProperties:S,isOffscreenCanvasSupported:r,mustRotate:p=!0,mustRescale:P=!0}){if(p&&(0,b.setLayerDimensions)(d,{rotation:w.rotation}),P){const B=m(0,r),H={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:B};for(const q of D)H.properties=S.get(q),H.div=q,f(H)}}},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditorLayer=void 0;var a=x(1),b=x(5),M=x(28),F=x(29),j=x(6);class v{#t;#e=!1;#i=this.pointerup.bind(this);#s=this.pointerdown.bind(this);#r=new Map;#h=!1;#c=!1;#n;static _initialized=!1;constructor(t){v._initialized||(v._initialized=!0,M.FreeTextEditor.initialize(t.l10n),F.InkEditor.initialize(t.l10n)),t.uiManager.registerEditorTypes([M.FreeTextEditor,F.InkEditor]),this.#n=t.uiManager,this.pageIndex=t.pageIndex,this.div=t.div,this.#t=t.accessibilityManager,this.#n.addLayer(this)}get isEmpty(){return this.#r.size===0}updateToolbar(t){this.#n.updateToolbar(t)}updateMode(t=this.#n.getMode()){this.#u(),t===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#n.unselectAll(),t!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",t===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",t===a.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(t){if(!t&&this.#n.getMode()!==a.AnnotationEditorType.INK)return;if(!t){for(const f of this.#r.values())if(f.isEmpty()){f.setInBackground();return}}this.#l({offsetX:0,offsetY:0}).setInBackground()}setEditingState(t){this.#n.setEditingState(t)}addCommands(t){this.#n.addCommands(t)}enable(){this.div.style.pointerEvents="auto";for(const t of this.#r.values())t.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const t of this.#r.values())t.disableEditing();this.#u(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(t){this.#n.getActive()!==t&&this.#n.setActiveEditor(t)}enableClick(){this.div.addEventListener("pointerdown",this.#s),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#s),this.div.removeEventListener("pointerup",this.#i)}attach(t){this.#r.set(t.id,t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv)}remove(t){this.#n.removeEditor(t),this.detach(t),t.div.style.display="none",setTimeout(()=>{t.div.style.display="",t.div.remove(),t.isAttachedToDOM=!1,document.activeElement===document.body&&this.#n.focusMainContainer()},0),this.#c||this.addInkEditorIfNeeded(!1)}#a(t){t.parent!==this&&(this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(this.#a(t),this.#n.addEditor(t),this.attach(t),!t.isAttachedToDOM){const c=t.render();this.div.append(c),t.isAttachedToDOM=!0}this.moveEditorInDOM(t),t.onceAdded(),this.#n.addToAnnotationStorage(t)}moveEditorInDOM(t){this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?t.rebuild():this.add(t)}addANewEditor(t){const c=()=>{this.addOrRebuild(t)},f=()=>{t.remove()};this.addCommands({cmd:c,undo:f,mustExec:!0})}addUndoableEditor(t){const c=()=>{this.addOrRebuild(t)},f=()=>{t.remove()};this.addCommands({cmd:c,undo:f,mustExec:!1})}getNextId(){return this.#n.getId()}#d(t){switch(this.#n.getMode()){case a.AnnotationEditorType.FREETEXT:return new M.FreeTextEditor(t);case a.AnnotationEditorType.INK:return new F.InkEditor(t)}return null}deserialize(t){switch(t.annotationType){case a.AnnotationEditorType.FREETEXT:return M.FreeTextEditor.deserialize(t,this,this.#n);case a.AnnotationEditorType.INK:return F.InkEditor.deserialize(t,this,this.#n)}return null}#l(t){const c=this.getNextId(),f=this.#d({parent:this,id:c,x:t.offsetX,y:t.offsetY,uiManager:this.#n});return f&&this.add(f),f}setSelected(t){this.#n.setSelected(t)}toggleSelected(t){this.#n.toggleSelected(t)}isSelected(t){return this.#n.isSelected(t)}unselect(t){this.#n.unselect(t)}pointerup(t){const{isMac:c}=a.FeatureTest.platform;if(!(t.button!==0||t.ctrlKey&&c)&&t.target===this.div&&this.#h){if(this.#h=!1,!this.#e){this.#e=!0;return}this.#l(t)}}pointerdown(t){const{isMac:c}=a.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&c||t.target!==this.div)return;this.#h=!0;const f=this.#n.getActive();this.#e=!f||f.isEmpty()}drop(t){const c=t.dataTransfer.getData("text/plain"),f=this.#n.getEditor(c);if(!f)return;t.preventDefault(),t.dataTransfer.dropEffect="move",this.#a(f);const n=this.div.getBoundingClientRect(),u=t.clientX-n.x,_=t.clientY-n.y;f.translate(u-f.startX,_-f.startY),this.moveEditorInDOM(f),f.div.focus()}dragover(t){t.preventDefault()}destroy(){this.#n.getActive()?.parent===this&&this.#n.setActiveEditor(null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#n.removeLayer(this)}#u(){this.#c=!0;for(const t of this.#r.values())t.isEmpty()&&t.remove();this.#c=!1}render({viewport:t}){this.viewport=t,(0,j.setLayerDimensions)(this.div,t),(0,b.bindEvents)(this,this.div,["dragover","drop"]);for(const c of this.#n.getEditors(this.pageIndex))this.add(c);this.updateMode()}update({viewport:t}){this.#n.commitOrRemove(),this.viewport=t,(0,j.setLayerDimensions)(this.div,{rotation:t.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:t,pageHeight:c}=this.viewport.rawDims;return[t,c]}}s.AnnotationEditorLayer=v},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FreeTextEditor=void 0;var a=x(1),b=x(5),M=x(4);class F extends M.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#r;#h="";#c=`${this.id}-editor`;#n=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new b.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],F.prototype.commitOrRemove]]);static _type="freetext";constructor(v){super({...v,name:"freeTextEditor"}),this.#r=v.color||F._defaultColor||M.AnnotationEditor._defaultLineColor,this.#a=v.fontSize||F._defaultFontSize}static initialize(v){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(t=>[t,v.get(t)]));const m=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(m.getPropertyValue("--freetext-padding"))}static updateDefaultParams(v,m){switch(v){case a.AnnotationEditorParamsType.FREETEXT_SIZE:F._defaultFontSize=m;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:F._defaultColor=m;break}}updateParams(v,m){switch(v){case a.AnnotationEditorParamsType.FREETEXT_SIZE:this.#d(m);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:this.#l(m);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,F._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,F._defaultColor||M.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[a.AnnotationEditorParamsType.FREETEXT_COLOR,this.#r]]}#d(v){const m=c=>{this.editorDiv.style.fontSize=`calc(${c}px * var(--scale-factor))`,this.translate(0,-(c-this.#a)*this.parentScale),this.#a=c,this.#o()},t=this.#a;this.addCommands({cmd:()=>{m(v)},undo:()=>{m(t)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(v){const m=this.#r;this.addCommands({cmd:()=>{this.#r=this.editorDiv.style.color=v},undo:()=>{this.#r=this.editorDiv.style.color=m},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const v=this.parentScale;return[-F._internalPadding*v,-(F._internalPadding+this.#a)*v]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#c),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(v){super.focusin(v),v.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#u(){const v=this.editorDiv.getElementsByTagName("div");if(v.length===0)return this.editorDiv.innerText;const m=[];for(const t of v)m.push(t.innerText.replace(/\r\n?|\n/,""));return m.join(`
`)}#o(){const[v,m]=this.parentDimensions;let t;if(this.isAttachedToDOM)t=this.div.getBoundingClientRect();else{const{currentLayer:c,div:f}=this,n=f.style.display;f.style.display="hidden",c.div.append(this.div),t=f.getBoundingClientRect(),f.remove(),f.style.display=n}this.width=t.width/v,this.height=t.height/m}commit(){this.isInEditMode()&&(super.commit(),this.#n||(this.#n=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#h=this.#u().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(v){this.enableEditMode(),this.editorDiv.focus()}keydown(v){v.target===this.div&&v.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(v){F._keyboardManager.exec(this,v)}editorDivFocus(v){this.isEditing=!0}editorDivBlur(v){this.isEditing=!1}editorDivInput(v){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let v,m;this.width&&(v=this.x,m=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#c),this.enableEditing(),F._l10nPromise.get("editor_free_text2_aria_label").then(c=>this.editorDiv?.setAttribute("aria-label",c)),F._l10nPromise.get("free_text2_default_content").then(c=>this.editorDiv?.setAttribute("default-content",c)),this.editorDiv.contentEditable=!0;const{style:t}=this.editorDiv;if(t.fontSize=`calc(${this.#a}px * var(--scale-factor))`,t.color=this.#r,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,b.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[c,f]=this.parentDimensions;this.setAt(v*c,m*f,this.width*c,this.height*f);for(const n of this.#h.split(`
`)){const u=document.createElement("div");u.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(u)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(v,m,t){const c=super.deserialize(v,m,t);return c.#a=v.fontSize,c.#r=a.Util.makeHexColor(...v.color),c.#h=v.value,c}serialize(){if(this.isEmpty())return null;const v=F._internalPadding*this.parentScale,m=this.getRect(v,v),t=M.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#r);return{annotationType:a.AnnotationEditorType.FREETEXT,color:t,fontSize:this.#a,value:this.#h,pageIndex:this.pageIndex,rect:m,rotation:this.rotation}}}s.FreeTextEditor=F},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InkEditor=void 0,Object.defineProperty(s,"fitCurve",{enumerable:!0,get:function(){return M.fitCurve}});var a=x(1),b=x(4),M=x(30),F=x(5);const j=16;class v extends b.AnnotationEditor{#t=0;#e=0;#i=0;#s=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#h=this.canvasPointerup.bind(this);#c=this.canvasPointerdown.bind(this);#n=!1;#a=!1;#d=null;#l=null;#u=0;#o=0;#g=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(t){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(c=>[c,t.get(c)]))}static updateDefaultParams(t,c){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:v._defaultThickness=c;break;case a.AnnotationEditorParamsType.INK_COLOR:v._defaultColor=c;break;case a.AnnotationEditorParamsType.INK_OPACITY:v._defaultOpacity=c/100;break}}updateParams(t,c){switch(t){case a.AnnotationEditorParamsType.INK_THICKNESS:this.#C(c);break;case a.AnnotationEditorParamsType.INK_COLOR:this.#T(c);break;case a.AnnotationEditorParamsType.INK_OPACITY:this.#x(c);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,v._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,v._defaultColor||b.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(v._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||v._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||v._defaultColor||b.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??v._defaultOpacity))]]}#C(t){const c=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#E()},undo:()=>{this.thickness=c,this.#E()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#T(t){const c=this.color;this.addCommands({cmd:()=>{this.color=t,this.#f()},undo:()=>{this.color=c,this.#f()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#x(t){t/=100;const c=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#f()},undo:()=>{this.opacity=c,this.#f()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#_(),this.#v()),this.isAttachedToDOM||(this.parent.add(this),this.#b()),this.#E())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#l.disconnect(),this.#l=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,c]=this.parentDimensions,f=this.width*t,n=this.height*c;this.setDimensions(f,n)}enableEditMode(){this.#n||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#c),this.canvas.addEventListener("pointerup",this.#h))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#c),this.canvas.removeEventListener("pointerup",this.#h))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#P(){const{parentRotation:t,parentDimensions:[c,f]}=this;switch(t){case 90:return[0,f,f,c];case 180:return[c,f,c,f];case 270:return[c,0,f,c];default:return[0,0,c,f]}}#y(){const{ctx:t,color:c,opacity:f,thickness:n,parentScale:u,scaleFactor:_}=this;t.lineWidth=n*u/_,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${c}${(0,F.opacityToHex)(f)}`}#w(t,c){this.isEditing=!0,this.#a||(this.#a=!0,this.#b(),this.thickness||=v._defaultThickness,this.color||=v._defaultColor||b.AnnotationEditor._defaultLineColor,this.opacity??=v._defaultOpacity),this.currentPath.push([t,c]),this.#d=null,this.#y(),this.ctx.beginPath(),this.ctx.moveTo(t,c),this.#g=()=>{this.#g&&(this.#d&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#f(),this.ctx.lineTo(...this.#d),this.#d=null,this.ctx.stroke()),window.requestAnimationFrame(this.#g))},window.requestAnimationFrame(this.#g)}#k(t,c){const[f,n]=this.currentPath.at(-1);t===f&&c===n||(this.currentPath.push([t,c]),this.#d=[t,c])}#F(t,c){this.ctx.closePath(),this.#g=null,t=Math.min(Math.max(t,0),this.canvas.width),c=Math.min(Math.max(c,0),this.canvas.height);const[f,n]=this.currentPath.at(-1);(t!==f||c!==n)&&this.currentPath.push([t,c]);let u;if(this.currentPath.length!==1)u=(0,M.fitCurve)(this.currentPath,30,null);else{const w=[t,c];u=[[w,w.slice(),w.slice(),w]]}const _=v.#M(u);this.currentPath.length=0;const g=()=>{this.paths.push(u),this.bezierPath2D.push(_),this.rebuild()},d=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#_(),this.#v()),this.#E())};this.addCommands({cmd:g,undo:d,mustExec:!0})}#f(){if(this.isEmpty()){this.#m();return}this.#y();const{canvas:t,ctx:c}=this;c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,t.width,t.height),this.#m();for(const f of this.bezierPath2D)c.stroke(f)}commit(){this.#n||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#n=!0,this.div.classList.add("disabled"),this.#E(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(t){super.focusin(t),this.enableEditMode()}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#n||(this.setInForeground(),t.type!=="mouse"&&this.div.focus(),t.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#s),this.#w(t.offsetX,t.offsetY))}canvasPointermove(t){t.stopPropagation(),this.#k(t.offsetX,t.offsetY)}canvasPointerup(t){t.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(t.stopPropagation(),this.#R(t),this.setInBackground())}canvasPointerleave(t){this.#R(t),this.setInBackground()}#R(t){this.#F(t.offsetX,t.offsetY),this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#s),this.addToAnnotationStorage()}#_(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",v._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#v(){this.#l=new ResizeObserver(t=>{const c=t[0].contentRect;c.width&&c.height&&this.setDimensions(c.width,c.height)}),this.#l.observe(this.div)}render(){if(this.div)return this.div;let t,c;this.width&&(t=this.x,c=this.y),super.render(),v._l10nPromise.get("editor_ink2_aria_label").then(g=>this.div?.setAttribute("aria-label",g));const[f,n,u,_]=this.#P();if(this.setAt(f,n,0,0),this.setDims(u,_),this.#_(),this.width){const[g,d]=this.parentDimensions;this.setAt(t*g,c*d,this.width*g,this.height*d),this.#a=!0,this.#b(),this.setDims(this.width*g,this.height*d),this.#f(),this.#L(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#v(),this.div}#b(){if(!this.#a)return;const[t,c]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*c),this.#m()}setDimensions(t,c){const f=Math.round(t),n=Math.round(c);if(this.#u===f&&this.#o===n)return;this.#u=f,this.#o=n,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-t/c)>.01&&(c=Math.ceil(t/this.#t),this.setDims(t,c));const[u,_]=this.parentDimensions;this.width=t/u,this.height=c/_,this.#n&&this.#p(t,c),this.#b(),this.#f(),this.canvas.style.visibility="visible",this.fixDims()}#p(t,c){const f=this.#I(),n=(t-f)/this.#i,u=(c-f)/this.#e;this.scaleFactor=Math.min(n,u)}#m(){const t=this.#I()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#M(t){const c=new Path2D;for(let f=0,n=t.length;f<n;f++){const[u,_,g,d]=t[f];f===0&&c.moveTo(...u),c.bezierCurveTo(_[0],_[1],g[0],g[1],d[0],d[1])}return c}#O(t,c,f,n){const _=[],g=this.thickness/2;let d,w;for(const D of this.paths){d=[],w=[];for(let S=0,r=D.length;S<r;S++){const[p,P,B,O]=D[S],H=t*(p[0]+c)+g,q=n-t*(p[1]+f)-g,K=t*(P[0]+c)+g,it=n-t*(P[1]+f)-g,J=t*(B[0]+c)+g,Z=n-t*(B[1]+f)-g,V=t*(O[0]+c)+g,I=n-t*(O[1]+f)-g;S===0&&(d.push(H,q),w.push(H,q)),d.push(K,it,J,Z,V,I),this.#D(H,q,K,it,J,Z,V,I,4,w)}_.push({bezier:d,points:w})}return _}#D(t,c,f,n,u,_,g,d,w,D){if(this.#A(t,c,f,n,u,_,g,d)){D.push(g,d);return}for(let S=1;S<w-1;S++){const r=S/w,p=1-r;let P=r*t+p*f,B=r*c+p*n,O=r*f+p*u,H=r*n+p*_;const q=r*u+p*g,K=r*_+p*d;P=r*P+p*O,B=r*B+p*H,O=r*O+p*q,H=r*H+p*K,P=r*P+p*O,B=r*B+p*H,D.push(P,B)}D.push(g,d)}#A(t,c,f,n,u,_,g,d){const D=(3*f-2*t-g)**2,S=(3*n-2*c-d)**2,r=(3*u-t-2*g)**2,p=(3*_-c-2*d)**2;return Math.max(D,r)+Math.max(S,p)<=10}#S(){let t=1/0,c=-1/0,f=1/0,n=-1/0;for(const u of this.paths)for(const[_,g,d,w]of u){const D=a.Util.bezierBoundingBox(..._,...g,...d,...w);t=Math.min(t,D[0]),f=Math.min(f,D[1]),c=Math.max(c,D[2]),n=Math.max(n,D[3])}return[t,f,c,n]}#I(){return this.#n?Math.ceil(this.thickness*this.parentScale):0}#E(t=!1){if(this.isEmpty())return;if(!this.#n){this.#f();return}const c=this.#S(),f=this.#I();this.#i=Math.max(j,c[2]-c[0]),this.#e=Math.max(j,c[3]-c[1]);const n=Math.ceil(f+this.#i*this.scaleFactor),u=Math.ceil(f+this.#e*this.scaleFactor),[_,g]=this.parentDimensions;this.width=n/_,this.height=u/g,this.#t=n/u,this.#L();const d=this.translationX,w=this.translationY;this.translationX=-c[0],this.translationY=-c[1],this.#b(),this.#f(),this.#u=n,this.#o=u,this.setDims(n,u);const D=t?f/this.scaleFactor/2:0;this.translate(d-this.translationX-D,w-this.translationY-D)}#L(){const{style:t}=this.div;this.#t>=1?(t.minHeight=`${j}px`,t.minWidth=`${Math.round(this.#t*j)}px`):(t.minWidth=`${j}px`,t.minHeight=`${Math.round(j/this.#t)}px`)}static deserialize(t,c,f){const n=super.deserialize(t,c,f);n.thickness=t.thickness,n.color=a.Util.makeHexColor(...t.color),n.opacity=t.opacity;const[u,_]=n.pageDimensions,g=n.width*u,d=n.height*_,w=n.parentScale,D=t.thickness/2;n.#t=g/d,n.#n=!0,n.#u=Math.round(g),n.#o=Math.round(d);for(const{bezier:r}of t.paths){const p=[];n.paths.push(p);let P=w*(r[0]-D),B=w*(d-r[1]-D);for(let H=2,q=r.length;H<q;H+=6){const K=w*(r[H]-D),it=w*(d-r[H+1]-D),J=w*(r[H+2]-D),Z=w*(d-r[H+3]-D),V=w*(r[H+4]-D),I=w*(d-r[H+5]-D);p.push([[P,B],[K,it],[J,Z],[V,I]]),P=V,B=I}const O=this.#M(p);n.bezierPath2D.push(O)}const S=n.#S();return n.#i=Math.max(j,S[2]-S[0]),n.#e=Math.max(j,S[3]-S[1]),n.#p(g,d),n}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),c=this.rotation%180===0?t[3]-t[1]:t[2]-t[0],f=b.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:f,thickness:this.thickness,opacity:this.opacity,paths:this.#O(this.scaleFactor/this.parentScale,this.translationX,this.translationY,c),pageIndex:this.pageIndex,rect:t,rotation:this.rotation}}}s.InkEditor=v},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.fitCurve=void 0;const a=x(31);s.fitCurve=a},L=>{function s(u,_,g){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(S=>{if(!Array.isArray(S)||S.some(r=>typeof r!="number")||S.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter((S,r)=>r===0||!S.every((p,P)=>p===u[r-1][P])),u.length<2)return[];const d=u.length,w=c(u[1],u[0]),D=c(u[d-2],u[d-1]);return x(u,w,D,_,g)}function x(u,_,g,d,w){var S,r,p,P,B,O,H,q,K,it,J,Z,V;if(u.length===2)return Z=f.vectorLen(f.subtract(u[0],u[1]))/3,S=[u[0],f.addArrays(u[0],f.mulItems(_,Z)),f.addArrays(u[1],f.mulItems(g,Z)),u[1]],[S];if(r=j(u),[S,P,O]=a(u,r,r,_,g,w),P===0||P<d)return[S];if(P<d*d)for(p=r,B=P,H=O,V=0;V<20;V++){if(p=M(S,u,p),[S,P,O]=a(u,r,p,_,g,w),P<d)return[S];if(O===H){let I=P/B;if(I>.9999&&I<1.0001)break}B=P,H=O}return J=[],q=f.subtract(u[O-1],u[O+1]),q.every(I=>I===0)&&(q=f.subtract(u[O-1],u[O]),[q[0],q[1]]=[-q[1],q[0]]),K=f.normalize(q),it=f.mulItems(K,-1),J=J.concat(x(u.slice(0,O+1),_,K,d,w)),J=J.concat(x(u.slice(O),it,g,d,w)),J}function a(u,_,g,d,w,D){var S,r,p;return S=b(u,g,d,w),[r,p]=v(u,S,_),D&&D({bez:S,points:u,params:_,maxErr:r,maxPoint:p}),[S,r,p]}function b(u,_,g,d){var w,D,S,r,p,P,B,O,H,q,K,it,J,Z,V,I,N,E=u[0],l=u[u.length-1];for(w=[E,null,null,l],D=f.zeros_Xx2x2(_.length),J=0,Z=_.length;J<Z;J++)I=_[J],N=1-I,S=D[J],S[0]=f.mulItems(g,3*I*(N*N)),S[1]=f.mulItems(d,3*N*(I*I));for(r=[[0,0],[0,0]],p=[0,0],J=0,Z=u.length;J<Z;J++)I=_[J],S=D[J],r[0][0]+=f.dot(S[0],S[0]),r[0][1]+=f.dot(S[0],S[1]),r[1][0]+=f.dot(S[0],S[1]),r[1][1]+=f.dot(S[1],S[1]),V=f.subtract(u[J],n.q([E,E,l,l],I)),p[0]+=f.dot(S[0],V),p[1]+=f.dot(S[1],V);return P=r[0][0]*r[1][1]-r[1][0]*r[0][1],B=r[0][0]*p[1]-r[1][0]*p[0],O=p[0]*r[1][1]-p[1]*r[0][1],H=P===0?0:O/P,q=P===0?0:B/P,it=f.vectorLen(f.subtract(E,l)),K=1e-6*it,H<K||q<K?(w[1]=f.addArrays(E,f.mulItems(g,it/3)),w[2]=f.addArrays(l,f.mulItems(d,it/3))):(w[1]=f.addArrays(E,f.mulItems(g,H)),w[2]=f.addArrays(l,f.mulItems(d,q))),w}function M(u,_,g){return g.map((d,w)=>F(u,_[w],d))}function F(u,_,g){var d=f.subtract(n.q(u,g),_),w=n.qprime(u,g),D=f.mulMatrix(d,w),S=f.sum(f.squareItems(w))+2*f.mulMatrix(d,n.qprimeprime(u,g));return S===0?g:g-D/S}function j(u){var _=[],g,d,w;return u.forEach((D,S)=>{g=S?d+f.vectorLen(f.subtract(D,w)):0,_.push(g),d=g,w=D}),_=_.map(D=>D/d),_}function v(u,_,g){var d,w,D,S,r,p,P,B;w=0,D=Math.floor(u.length/2);const O=m(_,10);for(r=0,p=u.length;r<p;r++)P=u[r],B=t(_,g[r],O,10),S=f.subtract(n.q(_,B),P),d=S[0]*S[0]+S[1]*S[1],d>w&&(w=d,D=r);return[w,D]}var m=function(u,_){for(var g,d=[0],w=u[0],D=0,S=1;S<=_;S++)g=n.q(u,S/_),D+=f.vectorLen(f.subtract(g,w)),d.push(D),w=g;return d=d.map(r=>r/D),d};function t(u,_,g,d){if(_<0)return 0;if(_>1)return 1;for(var w,D,S,r,p,P=1;P<=d;P++)if(_<=g[P]){r=(P-1)/d,S=P/d,D=g[P-1],w=g[P],p=(_-D)/(w-D)*(S-r)+r;break}return p}function c(u,_){return f.normalize(f.subtract(u,_))}class f{static zeros_Xx2x2(_){for(var g=[];_--;)g.push([0,0]);return g}static mulItems(_,g){return _.map(d=>d*g)}static mulMatrix(_,g){return _.reduce((d,w,D)=>d+w*g[D],0)}static subtract(_,g){return _.map((d,w)=>d-g[w])}static addArrays(_,g){return _.map((d,w)=>d+g[w])}static addItems(_,g){return _.map(d=>d+g)}static sum(_){return _.reduce((g,d)=>g+d)}static dot(_,g){return f.mulMatrix(_,g)}static vectorLen(_){return Math.hypot(..._)}static divItems(_,g){return _.map(d=>d/g)}static squareItems(_){return _.map(g=>g*g)}static normalize(_){return this.divItems(_,this.vectorLen(_))}}class n{static q(_,g){var d=1-g,w=f.mulItems(_[0],d*d*d),D=f.mulItems(_[1],3*d*d*g),S=f.mulItems(_[2],3*d*g*g),r=f.mulItems(_[3],g*g*g);return f.addArrays(f.addArrays(w,D),f.addArrays(S,r))}static qprime(_,g){var d=1-g,w=f.mulItems(f.subtract(_[1],_[0]),3*d*d),D=f.mulItems(f.subtract(_[2],_[1]),6*d*g),S=f.mulItems(f.subtract(_[3],_[2]),3*g*g);return f.addArrays(f.addArrays(w,D),S)}static qprimeprime(_,g){return f.addArrays(f.mulItems(f.addArrays(f.subtract(_[2],f.mulItems(_[1],2)),_[0]),6*(1-g)),f.mulItems(f.addArrays(f.subtract(_[3],f.mulItems(_[2],2)),_[1]),6*g))}}L.exports=s,L.exports.fitCubic=x,L.exports.createTangent=c},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationLayer=void 0;var a=x(1),b=x(6),M=x(3),F=x(33),j=x(34);const v=1e3,m=9,t=new WeakSet;function c(T){return{width:T[2]-T[0],height:T[3]-T[1]}}class f{static create(e){switch(e.data.annotationType){case a.AnnotationType.LINK:return new u(e);case a.AnnotationType.TEXT:return new _(e);case a.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new d(e);case"Btn":return e.data.radioButton?new D(e):e.data.checkBox?new w(e):new S(e);case"Ch":return new r(e)}return new g(e);case a.AnnotationType.POPUP:return new p(e);case a.AnnotationType.FREETEXT:return new B(e);case a.AnnotationType.LINE:return new O(e);case a.AnnotationType.SQUARE:return new H(e);case a.AnnotationType.CIRCLE:return new q(e);case a.AnnotationType.POLYLINE:return new K(e);case a.AnnotationType.CARET:return new J(e);case a.AnnotationType.INK:return new Z(e);case a.AnnotationType.POLYGON:return new it(e);case a.AnnotationType.HIGHLIGHT:return new V(e);case a.AnnotationType.UNDERLINE:return new I(e);case a.AnnotationType.SQUIGGLY:return new N(e);case a.AnnotationType.STRIKEOUT:return new E(e);case a.AnnotationType.STAMP:return new l(e);case a.AnnotationType.FILEATTACHMENT:return new o(e);default:return new n(e)}}}class n{constructor(e,{isRenderable:i=!1,ignoreBorder:h=!1,createQuadrilaterals:y=!1}={}){this.isRenderable=i,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,i&&(this.container=this._createContainer(h)),y&&(this.quadrilaterals=this._createQuadrilaterals(h))}_createContainer(e=!1){const{data:i,page:h,viewport:y}=this,C=document.createElement("section");C.setAttribute("data-annotation-id",i.id),i.noRotate&&C.classList.add("norotate");const{pageWidth:k,pageHeight:R,pageX:W,pageY:z}=y.rawDims,{width:U,height:$}=c(i.rect),tt=a.Util.normalizeRect([i.rect[0],h.view[3]-i.rect[1]+h.view[1],i.rect[2],h.view[3]-i.rect[3]+h.view[1]]);if(!e&&i.borderStyle.width>0){C.style.borderWidth=`${i.borderStyle.width}px`;const et=i.borderStyle.horizontalCornerRadius,st=i.borderStyle.verticalCornerRadius;if(et>0||st>0){const at=`calc(${et}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;C.style.borderRadius=at}else if(this instanceof D){const at=`calc(${U}px * var(--scale-factor)) / calc(${$}px * var(--scale-factor))`;C.style.borderRadius=at}switch(i.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:C.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:C.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:C.style.borderBottomStyle="solid";break}const nt=i.borderColor||null;nt?C.style.borderColor=a.Util.makeHexColor(nt[0]|0,nt[1]|0,nt[2]|0):C.style.borderWidth=0}C.style.left=`${100*(tt[0]-W)/k}%`,C.style.top=`${100*(tt[1]-z)/R}%`;const{rotation:Y}=i;return i.hasOwnCanvas||Y===0?(C.style.width=`${100*U/k}%`,C.style.height=`${100*$/R}%`):this.setRotation(Y,C),C}setRotation(e,i=this.container){const{pageWidth:h,pageHeight:y}=this.viewport.rawDims,{width:C,height:k}=c(this.data.rect);let R,W;e%180===0?(R=100*C/h,W=100*k/y):(R=100*k/h,W=100*C/y),i.style.width=`${R}%`,i.style.height=`${W}%`,i.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(i,h,y)=>{const C=y.detail[i];y.target.style[h]=F.ColorConverters[`${C[0]}_HTML`](C.slice(1))};return(0,a.shadow)(this,"_commonActions",{display:i=>{const h=i.detail.display%2===1;this.container.style.visibility=h?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:h,print:i.detail.display===0||i.detail.display===3})},print:i=>{this.annotationStorage.setValue(this.data.id,{print:i.detail.print})},hidden:i=>{this.container.style.visibility=i.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:i.detail.hidden})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.detail.readonly?i.target.setAttribute("readonly",""):i.target.removeAttribute("readonly")},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{e("bgColor","backgroundColor",i)},fillColor:i=>{e("fillColor","backgroundColor",i)},fgColor:i=>{e("fgColor","color",i)},textColor:i=>{e("textColor","color",i)},borderColor:i=>{e("borderColor","borderColor",i)},strokeColor:i=>{e("strokeColor","borderColor",i)},rotation:i=>{const h=i.detail.rotation;this.setRotation(h),this.annotationStorage.setValue(this.data.id,{rotation:h})}})}_dispatchEventFromSandbox(e,i){const h=this._commonActions;for(const y of Object.keys(i.detail))(e[y]||h[y])?.(i)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const h=this._commonActions;for(const[y,C]of Object.entries(i)){const k=h[y];if(k){const R={detail:{[y]:C},target:e};k(R),delete i[y]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const i=[],h=this.data.rect;for(const y of this.data.quadPoints)this.data.rect=[y[2].x,y[2].y,y[1].x,y[1].y],i.push(this._createContainer(e));return this.data.rect=h,i}_createPopup(e,i){let h=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,h=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),h.append(e));const C=new P({container:h,trigger:e,color:i.color,titleObj:i.titleObj,modificationDate:i.modificationDate,contentsObj:i.contentsObj,richText:i.richText,hideWrapper:!0}).render();C.style.left="100%",h.append(C)}_renderQuadrilaterals(e){for(const i of this.quadrilaterals)i.classList.add(e);return this.quadrilaterals}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,i=null){const h=[];if(this._fieldObjects){const y=this._fieldObjects[e];if(y)for(const{page:C,id:k,exportValues:R}of y){if(C===-1||k===i)continue;const W=typeof R=="string"?R:null,z=document.querySelector(`[data-element-id="${k}"]`);if(z&&!t.has(z)){(0,a.warn)(`_getElementsByName - element not allowed: ${k}`);continue}h.push({id:k,exportValue:W,domElement:z})}return h}for(const y of document.getElementsByName(e)){const{exportValue:C}=y,k=y.getAttribute("data-element-id");k!==i&&t.has(y)&&h.push({id:k,exportValue:C,domElement:y})}return h}}class u extends n{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,h=document.createElement("a");h.setAttribute("data-element-id",e.id);let y=!1;return e.url?(i.addLinkAttributes(h,e.url,e.newWindow),y=!0):e.action?(this._bindNamedAction(h,e.action),y=!0):e.attachment?(this._bindAttachment(h,e.attachment),y=!0):e.setOCGState?(this.#e(h,e.setOCGState),y=!0):e.dest?(this._bindLink(h,e.dest),y=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(h,e),y=!0),e.resetForm?(this._bindResetFormAction(h,e.resetForm),y=!0):this.isTooltipOnly&&!y&&(this._bindLink(h,""),y=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((C,k)=>{const R=k===0?h:h.cloneNode();return C.append(R),C}):(this.container.classList.add("linkAnnotation"),y&&this.container.append(h),this.container)}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t()}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),this.#t()}_bindAttachment(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,i.content,i.filename),!1),this.#t()}#e(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),this.#t()}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const h=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const y of Object.keys(i.actions)){const C=h.get(y);C&&(e[C]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:y}}),!1))}e.onclick||(e.onclick=()=>!1),this.#t()}_bindResetFormAction(e,i){const h=e.onclick;if(h||(e.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),h||(e.onclick=()=>!1);return}e.onclick=()=>{h?.();const{fields:y,refs:C,include:k}=i,R=[];if(y.length!==0||C.length!==0){const U=new Set(C);for(const $ of y){const tt=this._fieldObjects[$]||[];for(const{id:Y}of tt)U.add(Y)}for(const $ of Object.values(this._fieldObjects))for(const tt of $)U.has(tt.id)===k&&R.push(tt)}else for(const U of Object.values(this._fieldObjects))R.push(...U);const W=this.annotationStorage,z=[];for(const U of R){const{id:$}=U;switch(z.push($),U.type){case"text":{const Y=U.defaultValue||"";W.setValue($,{value:Y});break}case"checkbox":case"radiobutton":{const Y=U.defaultValue===U.exportValues;W.setValue($,{value:Y});break}case"combobox":case"listbox":{const Y=U.defaultValue||"";W.setValue($,{value:Y});break}default:continue}const tt=document.querySelector(`[data-element-id="${$}"]`);if(tt){if(!t.has(tt)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${$}`);continue}}else continue;tt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:z,name:"ResetForm"}}),!1}}}class _ extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class g extends n{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:i,isMac:h}=a.FeatureTest.platform;return i&&e.ctrlKey||h&&e.metaKey}_setEventListener(e,i,h,y){i.includes("mouse")?e.addEventListener(i,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:h,value:y(C),shift:C.shiftKey,modifier:this._getKeyModifier(C)}})}):e.addEventListener(i,C=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:h,value:y(C)}})})}_setEventListeners(e,i,h){for(const[y,C]of i)(C==="Action"||this.data.actions?.[C])&&this._setEventListener(e,y,C,h)}_setBackgroundColor(e){const i=this.data.backgroundColor||null;e.style.backgroundColor=i===null?"transparent":a.Util.makeHexColor(i[0],i[1],i[2])}_setTextStyle(e){const i=["left","center","right"],{fontColor:h}=this.data.defaultAppearanceData,y=this.data.defaultAppearanceData.fontSize||m,C=e.style;let k;const R=2,W=z=>Math.round(10*z)/10;if(this.data.multiLine){const z=Math.abs(this.data.rect[3]-this.data.rect[1]-R),U=Math.round(z/(a.LINE_FACTOR*y))||1,$=z/U;k=Math.min(y,W($/a.LINE_FACTOR))}else{const z=Math.abs(this.data.rect[3]-this.data.rect[1]-R);k=Math.min(y,W(z/a.LINE_FACTOR))}C.fontSize=`calc(${k}px * var(--scale-factor))`,C.color=a.Util.makeHexColor(h[0],h[1],h[2]),this.data.textAlignment!==null&&(C.textAlign=i[this.data.textAlignment])}_setRequired(e,i){i?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",i)}}class d extends g{constructor(e){const i=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:i})}setPropertyOnSiblings(e,i,h,y){const C=this.annotationStorage;for(const k of this._getElementsByName(e.name,e.id))k.domElement&&(k.domElement[i]=h),C.setValue(k.id,{[y]:h})}render(){const e=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let h=null;if(this.renderForms){const y=e.getValue(i,{value:this.data.fieldValue});let C=y.formattedValue||y.value||"";const k=e.getValue(i,{charLimit:this.data.maxLen}).charLimit;k&&C.length>k&&(C=C.slice(0,k));const R={userValue:C,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(h=document.createElement("textarea"),h.textContent=C,this.data.doNotScroll&&(h.style.overflowY="hidden")):(h=document.createElement("input"),h.type="text",h.setAttribute("value",C),this.data.doNotScroll&&(h.style.overflowX="hidden")),t.add(h),h.setAttribute("data-element-id",i),h.disabled=this.data.readOnly,h.name=this.data.fieldName,h.tabIndex=v,this._setRequired(h,this.data.required),k&&(h.maxLength=k),h.addEventListener("input",z=>{e.setValue(i,{value:z.target.value}),this.setPropertyOnSiblings(h,"value",z.target.value,"value")}),h.addEventListener("resetform",z=>{const U=this.data.defaultFieldValue??"";h.value=R.userValue=U,R.formattedValue=null});let W=z=>{const{formattedValue:U}=R;U!=null&&(z.target.value=U),z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){h.addEventListener("focus",U=>{const{target:$}=U;R.userValue&&($.value=R.userValue),R.lastCommittedValue=$.value,R.commitKey=1}),h.addEventListener("updatefromsandbox",U=>{const $={value(tt){R.userValue=tt.detail.value??"",e.setValue(i,{value:R.userValue.toString()}),tt.target.value=R.userValue},formattedValue(tt){const{formattedValue:Y}=tt.detail;R.formattedValue=Y,Y!=null&&tt.target!==document.activeElement&&(tt.target.value=Y),e.setValue(i,{formattedValue:Y})},selRange(tt){tt.target.setSelectionRange(...tt.detail.selRange)},charLimit:tt=>{const{charLimit:Y}=tt.detail,{target:et}=tt;if(Y===0){et.removeAttribute("maxLength");return}et.setAttribute("maxLength",Y);let st=R.userValue;!st||st.length<=Y||(st=st.slice(0,Y),et.value=R.userValue=st,e.setValue(i,{value:st}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:st,willCommit:!0,commitKey:1,selStart:et.selectionStart,selEnd:et.selectionEnd}}))}};this._dispatchEventFromSandbox($,U)}),h.addEventListener("keydown",U=>{R.commitKey=1;let $=-1;if(U.key==="Escape"?$=0:U.key==="Enter"&&!this.data.multiLine?$=2:U.key==="Tab"&&(R.commitKey=3),$===-1)return;const{value:tt}=U.target;R.lastCommittedValue!==tt&&(R.lastCommittedValue=tt,R.userValue=tt,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:tt,willCommit:!0,commitKey:$,selStart:U.target.selectionStart,selEnd:U.target.selectionEnd}}))});const z=W;W=null,h.addEventListener("blur",U=>{if(!U.relatedTarget)return;const{value:$}=U.target;R.userValue=$,R.lastCommittedValue!==$&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:$,willCommit:!0,commitKey:R.commitKey,selStart:U.target.selectionStart,selEnd:U.target.selectionEnd}}),z(U)}),this.data.actions?.Keystroke&&h.addEventListener("beforeinput",U=>{R.lastCommittedValue=null;const{data:$,target:tt}=U,{value:Y,selectionStart:et,selectionEnd:st}=tt;let nt=et,at=st;switch(U.inputType){case"deleteWordBackward":{const ot=Y.substring(0,et).match(/\w*[^\w]*$/);ot&&(nt-=ot[0].length);break}case"deleteWordForward":{const ot=Y.substring(et).match(/^[^\w]*\w*/);ot&&(at+=ot[0].length);break}case"deleteContentBackward":et===st&&(nt-=1);break;case"deleteContentForward":et===st&&(at+=1);break}U.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:Y,change:$||"",willCommit:!1,selStart:nt,selEnd:at}})}),this._setEventListeners(h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.value)}if(W&&h.addEventListener("blur",W),this.data.comb){const U=(this.data.rect[2]-this.data.rect[0])/k;h.classList.add("comb"),h.style.letterSpacing=`calc(${U}px * var(--scale-factor) - 1ch)`}}else h=document.createElement("div"),h.textContent=this.data.fieldValue,h.style.verticalAlign="middle",h.style.display="table-cell";return this._setTextStyle(h),this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.append(h),this.container}}class w extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,i=this.data,h=i.id;let y=e.getValue(h,{value:i.exportValue===i.fieldValue}).value;typeof y=="string"&&(y=y!=="Off",e.setValue(h,{value:y})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const C=document.createElement("input");return t.add(C),C.setAttribute("data-element-id",h),C.disabled=i.readOnly,this._setRequired(C,this.data.required),C.type="checkbox",C.name=i.fieldName,y&&C.setAttribute("checked",!0),C.setAttribute("exportValue",i.exportValue),C.tabIndex=v,C.addEventListener("change",k=>{const{name:R,checked:W}=k.target;for(const z of this._getElementsByName(R,h)){const U=W&&z.exportValue===i.exportValue;z.domElement&&(z.domElement.checked=U),e.setValue(z.id,{value:U})}e.setValue(h,{value:W})}),C.addEventListener("resetform",k=>{const R=i.defaultFieldValue||"Off";k.target.checked=R===i.exportValue}),this.enableScripting&&this.hasJSActions&&(C.addEventListener("updatefromsandbox",k=>{const R={value(W){W.target.checked=W.detail.value!=="Off",e.setValue(h,{value:W.target.checked})}};this._dispatchEventFromSandbox(R,k)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],k=>k.target.checked)),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class D extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,i=this.data,h=i.id;let y=e.getValue(h,{value:i.fieldValue===i.buttonValue}).value;typeof y=="string"&&(y=y!==i.buttonValue,e.setValue(h,{value:y}));const C=document.createElement("input");if(t.add(C),C.setAttribute("data-element-id",h),C.disabled=i.readOnly,this._setRequired(C,this.data.required),C.type="radio",C.name=i.fieldName,y&&C.setAttribute("checked",!0),C.tabIndex=v,C.addEventListener("change",k=>{const{name:R,checked:W}=k.target;for(const z of this._getElementsByName(R,h))e.setValue(z.id,{value:!1});e.setValue(h,{value:W})}),C.addEventListener("resetform",k=>{const R=i.defaultFieldValue;k.target.checked=R!=null&&R===i.buttonValue}),this.enableScripting&&this.hasJSActions){const k=i.buttonValue;C.addEventListener("updatefromsandbox",R=>{const W={value:z=>{const U=k===z.detail.value;for(const $ of this._getElementsByName(z.target.name)){const tt=U&&$.id===h;$.domElement&&($.domElement.checked=tt),e.setValue($.id,{value:tt})}}};this._dispatchEventFromSandbox(W,R)}),this._setEventListeners(C,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],R=>R.target.checked)}return this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class S extends u{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const i=e.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",h=>{this._dispatchEventFromSandbox({},h)})),e}}class r extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,i=this.data.id,h=e.getValue(i,{value:this.data.fieldValue}),y=document.createElement("select");t.add(y),y.setAttribute("data-element-id",i),y.disabled=this.data.readOnly,this._setRequired(y,this.data.required),y.name=this.data.fieldName,y.tabIndex=v;let C=this.data.combo&&this.data.options.length>0;this.data.combo||(y.size=this.data.options.length,this.data.multiSelect&&(y.multiple=!0)),y.addEventListener("resetform",U=>{const $=this.data.defaultFieldValue;for(const tt of y.options)tt.selected=tt.value===$});for(const U of this.data.options){const $=document.createElement("option");$.textContent=U.displayValue,$.value=U.exportValue,h.value.includes(U.exportValue)&&($.setAttribute("selected",!0),C=!1),y.append($)}let k=null;if(C){const U=document.createElement("option");U.value=" ",U.setAttribute("hidden",!0),U.setAttribute("selected",!0),y.prepend(U),k=()=>{U.remove(),y.removeEventListener("input",k),k=null},y.addEventListener("input",k)}const R=U=>{const $=U?"value":"textContent",{options:tt,multiple:Y}=y;return Y?Array.prototype.filter.call(tt,et=>et.selected).map(et=>et[$]):tt.selectedIndex===-1?null:tt[tt.selectedIndex][$]};let W=R(!1);const z=U=>{const $=U.target.options;return Array.prototype.map.call($,tt=>({displayValue:tt.textContent,exportValue:tt.value}))};return this.enableScripting&&this.hasJSActions?(y.addEventListener("updatefromsandbox",U=>{const $={value(tt){k?.();const Y=tt.detail.value,et=new Set(Array.isArray(Y)?Y:[Y]);for(const st of y.options)st.selected=et.has(st.value);e.setValue(i,{value:R(!0)}),W=R(!1)},multipleSelection(tt){y.multiple=!0},remove(tt){const Y=y.options,et=tt.detail.remove;Y[et].selected=!1,y.remove(et),Y.length>0&&Array.prototype.findIndex.call(Y,nt=>nt.selected)===-1&&(Y[0].selected=!0),e.setValue(i,{value:R(!0),items:z(tt)}),W=R(!1)},clear(tt){for(;y.length!==0;)y.remove(0);e.setValue(i,{value:null,items:[]}),W=R(!1)},insert(tt){const{index:Y,displayValue:et,exportValue:st}=tt.detail.insert,nt=y.children[Y],at=document.createElement("option");at.textContent=et,at.value=st,nt?nt.before(at):y.append(at),e.setValue(i,{value:R(!0),items:z(tt)}),W=R(!1)},items(tt){const{items:Y}=tt.detail;for(;y.length!==0;)y.remove(0);for(const et of Y){const{displayValue:st,exportValue:nt}=et,at=document.createElement("option");at.textContent=st,at.value=nt,y.append(at)}y.options.length>0&&(y.options[0].selected=!0),e.setValue(i,{value:R(!0),items:z(tt)}),W=R(!1)},indices(tt){const Y=new Set(tt.detail.indices);for(const et of tt.target.options)et.selected=Y.has(et.index);e.setValue(i,{value:R(!0)}),W=R(!1)},editable(tt){tt.target.disabled=!tt.detail.editable}};this._dispatchEventFromSandbox($,U)}),y.addEventListener("input",U=>{const $=R(!0);e.setValue(i,{value:$}),U.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:W,changeEx:$,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(y,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],U=>U.target.value)):y.addEventListener("input",function(U){e.setValue(i,{value:R(!0)})}),this.data.combo&&this._setTextStyle(y),this._setBackgroundColor(y),this._setDefaultPropertiesFromJS(y),this.container.append(y),this.container}}class p extends n{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(e){const{data:i}=e,h=!p.IGNORE_TYPES.has(i.parentType)&&!!(i.titleObj?.str||i.contentsObj?.str||i.richText?.str);super(e,{isRenderable:h})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const i=new P({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),h=this.page,y=a.Util.normalizeRect([this.data.parentRect[0],h.view[3]-this.data.parentRect[1]+h.view[1],this.data.parentRect[2],h.view[3]-this.data.parentRect[3]+h.view[1]]),C=y[0]+this.data.parentRect[2]-this.data.parentRect[0],k=y[1],{pageWidth:R,pageHeight:W,pageX:z,pageY:U}=this.viewport.rawDims;return this.container.style.left=`${100*(C-z)/R}%`,this.container.style.top=`${100*(k-U)/W}%`,this.container.append(i.render()),this.container}}class P{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const i=document.createElement("div");i.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?i:this.container,this.hideElement.hidden=!0;const h=document.createElement("div");h.classList.add("popup");const y=this.color;if(y){const R=.7*(255-y[0])+y[0],W=.7*(255-y[1])+y[1],z=.7*(255-y[2])+y[2];h.style.backgroundColor=a.Util.makeHexColor(R|0,W|0,z|0)}const C=document.createElement("h1");C.dir=this.titleObj.dir,C.textContent=this.titleObj.str,h.append(C);const k=b.PDFDateString.toDateObject(this.modificationDate);if(k){const R=document.createElement("span");R.classList.add("popupDate"),R.textContent="{{date}}, {{time}}",R.dataset.l10nId="annotation_date_string",R.dataset.l10nArgs=JSON.stringify({date:k.toLocaleDateString(),time:k.toLocaleTimeString()}),h.append(R)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))j.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:h}),h.lastChild.classList.add("richText","popupContent");else{const R=this._formatContents(this.contentsObj);h.append(R)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const R of this.trigger)R.addEventListener("click",this._toggle.bind(this)),R.addEventListener("mouseover",this._show.bind(this,!1)),R.addEventListener("mouseout",this._hide.bind(this,!1));return h.addEventListener("click",this._hide.bind(this,!0)),i.append(h),i}_formatContents({str:e,dir:i}){const h=document.createElement("p");h.classList.add("popupContent"),h.dir=i;const y=e.split(/(?:\r\n?|\n)/);for(let C=0,k=y.length;C<k;++C){const R=y[C];h.append(document.createTextNode(R)),C<k-1&&h.append(document.createElement("br"))}return h}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class B extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const i of this.textContent){const h=document.createElement("span");h.textContent=i,e.append(h)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class O extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:h}=c(e.rect),y=this.svgFactory.create(i,h,!0),C=this.svgFactory.createElement("svg:line");return C.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),C.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),C.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),C.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),C.setAttribute("stroke-width",e.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","transparent"),y.append(C),this.container.append(y),this._createPopup(C,e),this.container}}class H extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:h}=c(e.rect),y=this.svgFactory.create(i,h,!0),C=e.borderStyle.width,k=this.svgFactory.createElement("svg:rect");return k.setAttribute("x",C/2),k.setAttribute("y",C/2),k.setAttribute("width",i-C),k.setAttribute("height",h-C),k.setAttribute("stroke-width",C||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),y.append(k),this.container.append(y),this._createPopup(k,e),this.container}}class q extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:h}=c(e.rect),y=this.svgFactory.create(i,h,!0),C=e.borderStyle.width,k=this.svgFactory.createElement("svg:ellipse");return k.setAttribute("cx",i/2),k.setAttribute("cy",h/2),k.setAttribute("rx",i/2-C/2),k.setAttribute("ry",h/2-C/2),k.setAttribute("stroke-width",C||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),y.append(k),this.container.append(y),this._createPopup(k,e),this.container}}class K extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:i,height:h}=c(e.rect),y=this.svgFactory.create(i,h,!0);let C=[];for(const R of e.vertices){const W=R.x-e.rect[0],z=e.rect[3]-R.y;C.push(W+","+z)}C=C.join(" ");const k=this.svgFactory.createElement(this.svgElementName);return k.setAttribute("points",C),k.setAttribute("stroke-width",e.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),y.append(k),this.container.append(y),this._createPopup(k,e),this.container}}class it extends K{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class J extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Z extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:i,height:h}=c(e.rect),y=this.svgFactory.create(i,h,!0);for(const C of e.inkLists){let k=[];for(const W of C){const z=W.x-e.rect[0],U=e.rect[3]-W.y;k.push(`${z},${U}`)}k=k.join(" ");const R=this.svgFactory.createElement(this.svgElementName);R.setAttribute("points",k),R.setAttribute("stroke-width",e.borderStyle.width||1),R.setAttribute("stroke","transparent"),R.setAttribute("fill","transparent"),this._createPopup(R,e),y.append(R)}return this.container.append(y),this.container}}class V extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class I extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class N extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class E extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class l extends n{constructor(e){const i=!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class o extends n{constructor(e){super(e,{isRenderable:!0});const{filename:i,content:h}=this.data.file;this.filename=(0,b.getFilenameFromUrl)(i,!0),this.content=h,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:i,content:h})}render(){this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class A{static#t(e,i,h,y){const C=e.firstChild||e;C.id=`${b.AnnotationPrefix}${i}`,h.append(e),y?.moveElementInDOM(h,e,C,!1)}static render(e){const{annotations:i,div:h,viewport:y,accessibilityManager:C}=e;(0,b.setLayerDimensions)(h,y);const k={data:null,layer:h,page:e.page,viewport:y,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new b.DOMSVGFactory,annotationStorage:e.annotationStorage||new M.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let R=0;for(const W of i){if(W.noHTML)continue;if(W.annotationType!==a.AnnotationType.POPUP){const{width:$,height:tt}=c(W.rect);if($<=0||tt<=0)continue}k.data=W;const z=f.create(k);if(!z.isRenderable)continue;const U=z.render();if(W.hidden&&(U.style.visibility="hidden"),Array.isArray(U))for(const $ of U)$.style.zIndex=R++,A.#t($,W.id,h,C);else U.style.zIndex=R++,z instanceof p?h.prepend(U):A.#t(U,W.id,h,C)}this.#e(h,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:i,div:h,viewport:y}=e;(0,b.setLayerDimensions)(h,{rotation:y.rotation}),this.#e(h,i),h.hidden=!1}static#e(e,i){if(i){for(const[h,y]of i){const C=e.querySelector(`[data-annotation-id="${h}"]`);if(!C)continue;const{firstChild:k}=C;k?k.nodeName==="CANVAS"?k.replaceWith(y):k.before(y):C.append(y)}i.clear()}}}s.AnnotationLayer=A},(L,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorConverters=void 0;function x(b){return Math.floor(Math.max(0,Math.min(1,b))*255).toString(16).padStart(2,"0")}class a{static CMYK_G([M,F,j,v]){return["G",1-Math.min(1,.3*M+.59*j+.11*F+v)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_HTML([M]){const F=x(M);return`#${F}${F}${F}`}static RGB_G([M,F,j]){return["G",.3*M+.59*F+.11*j]}static RGB_HTML([M,F,j]){const v=x(M),m=x(F),t=x(j);return`#${v}${m}${t}`}static T_HTML(){return"#00000000"}static CMYK_RGB([M,F,j,v]){return["RGB",1-Math.min(1,M+v),1-Math.min(1,j+v),1-Math.min(1,F+v)]}static CMYK_HTML(M){const F=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(F)}static RGB_CMYK([M,F,j]){const v=1-M,m=1-F,t=1-j,c=Math.min(v,m,t);return["CMYK",v,m,t,c]}}s.ColorConverters=a},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaLayer=void 0;var a=x(19);class b{static setupStorage(F,j,v,m,t){const c=m.getValue(j,{value:null});switch(v.name){case"textarea":if(c.value!==null&&(F.textContent=c.value),t==="print")break;F.addEventListener("input",f=>{m.setValue(j,{value:f.target.value})});break;case"input":if(v.attributes.type==="radio"||v.attributes.type==="checkbox"){if(c.value===v.attributes.xfaOn?F.setAttribute("checked",!0):c.value===v.attributes.xfaOff&&F.removeAttribute("checked"),t==="print")break;F.addEventListener("change",f=>{m.setValue(j,{value:f.target.checked?f.target.getAttribute("xfaOn"):f.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&F.setAttribute("value",c.value),t==="print")break;F.addEventListener("input",f=>{m.setValue(j,{value:f.target.value})})}break;case"select":if(c.value!==null)for(const f of v.children)f.attributes.value===c.value&&(f.attributes.selected=!0);F.addEventListener("input",f=>{const n=f.target.options,u=n.selectedIndex===-1?"":n[n.selectedIndex].value;m.setValue(j,{value:u})});break}}static setAttributes({html:F,element:j,storage:v=null,intent:m,linkService:t}){const{attributes:c}=j,f=F instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${m}`);for(const[n,u]of Object.entries(c))if(u!=null)switch(n){case"class":u.length&&F.setAttribute(n,u.join(" "));break;case"dataId":break;case"id":F.setAttribute("data-element-id",u);break;case"style":Object.assign(F.style,u);break;case"textContent":F.textContent=u;break;default:(!f||n!=="href"&&n!=="newWindow")&&F.setAttribute(n,u)}f&&t.addLinkAttributes(F,c.href,c.newWindow),v&&c.dataId&&this.setupStorage(F,c.dataId,j,v)}static render(F){const j=F.annotationStorage,v=F.linkService,m=F.xfaHtml,t=F.intent||"display",c=document.createElement(m.name);m.attributes&&this.setAttributes({html:c,element:m,intent:t,linkService:v});const f=[[m,-1,c]],n=F.div;if(n.append(c),F.viewport){const _=`matrix(${F.viewport.transform.join(",")})`;n.style.transform=_}t!=="richText"&&n.setAttribute("class","xfaLayer xfaFont");const u=[];for(;f.length>0;){const[_,g,d]=f.at(-1);if(g+1===_.children.length){f.pop();continue}const w=_.children[++f.at(-1)[1]];if(w===null)continue;const{name:D}=w;if(D==="#text"){const r=document.createTextNode(w.value);u.push(r),d.append(r);continue}let S;if(w?.attributes?.xmlns?S=document.createElementNS(w.attributes.xmlns,D):S=document.createElement(D),d.append(S),w.attributes&&this.setAttributes({html:S,element:w,storage:j,intent:t,linkService:v}),w.children&&w.children.length>0)f.push([w,-1,S]);else if(w.value){const r=document.createTextNode(w.value);a.XfaText.shouldBuildText(D)&&u.push(r),S.append(r)}}for(const _ of n.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:u}}static update(F){const j=`matrix(${F.viewport.transform.join(",")})`;F.div.style.transform=j,F.div.hidden=!1}}s.XfaLayer=b},(L,s,x)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SVGGraphics=void 0;var a=x(6),b=x(1),M=x(10);let F=class{constructor(){(0,b.unreachable)("Not implemented: SVGGraphics")}};s.SVGGraphics=F;{let _=function(r){let p=[];const P=[];for(const B of r){if(B.fn==="save"){p.push({fnId:92,fn:"group",items:[]}),P.push(p),p=p.at(-1).items;continue}B.fn==="restore"?p=P.pop():p.push(B)}return p},g=function(r){if(Number.isInteger(r))return r.toString();const p=r.toFixed(10);let P=p.length-1;if(p[P]!=="0")return p;do P--;while(p[P]==="0");return p.substring(0,p[P]==="."?P:P+1)},d=function(r){if(r[4]===0&&r[5]===0){if(r[1]===0&&r[2]===0)return r[0]===1&&r[3]===1?"":`scale(${g(r[0])} ${g(r[3])})`;if(r[0]===r[3]&&r[1]===-r[2]){const p=Math.acos(r[0])*180/Math.PI;return`rotate(${g(p)})`}}else if(r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1)return`translate(${g(r[4])} ${g(r[5])})`;return`matrix(${g(r[0])} ${g(r[1])} ${g(r[2])} ${g(r[3])} ${g(r[4])} ${g(r[5])})`};const j={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},v="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/1999/xlink",t=["butt","round","square"],c=["miter","round","bevel"],f=function(r,p="",P=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!P)return URL.createObjectURL(new Blob([r],{type:p}));const B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let O=`data:${p};base64,`;for(let H=0,q=r.length;H<q;H+=3){const K=r[H]&255,it=r[H+1]&255,J=r[H+2]&255,Z=K>>2,V=(K&3)<<4|it>>4,I=H+1<q?(it&15)<<2|J>>6:64,N=H+2<q?J&63:64;O+=B[Z]+B[V]+B[I]+B[N]}return O},n=function(){const r=new Uint8Array([137,80,78,71,13,10,26,10]),p=12,P=new Int32Array(256);for(let J=0;J<256;J++){let Z=J;for(let V=0;V<8;V++)Z&1?Z=3988292384^Z>>1&2147483647:Z=Z>>1&2147483647;P[J]=Z}function B(J,Z,V){let I=-1;for(let N=Z;N<V;N++){const E=(I^J[N])&255,l=P[E];I=I>>>8^l}return I^-1}function O(J,Z,V,I){let N=I;const E=Z.length;V[N]=E>>24&255,V[N+1]=E>>16&255,V[N+2]=E>>8&255,V[N+3]=E&255,N+=4,V[N]=J.charCodeAt(0)&255,V[N+1]=J.charCodeAt(1)&255,V[N+2]=J.charCodeAt(2)&255,V[N+3]=J.charCodeAt(3)&255,N+=4,V.set(Z,N),N+=Z.length;const l=B(V,I+4,N);V[N]=l>>24&255,V[N+1]=l>>16&255,V[N+2]=l>>8&255,V[N+3]=l&255}function H(J,Z,V){let I=1,N=0;for(let E=Z;E<V;++E)I=(I+(J[E]&255))%65521,N=(N+I)%65521;return N<<16|I}function q(J){if(!M.isNodeJS)return K(J);try{let Z;parseInt(process.versions.node)>=8?Z=J:Z=Buffer.from(J);const V=require$$5.deflateSync(Z,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(Z){(0,b.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Z)}return K(J)}function K(J){let Z=J.length;const V=65535,I=Math.ceil(Z/V),N=new Uint8Array(2+Z+I*5+4);let E=0;N[E++]=120,N[E++]=156;let l=0;for(;Z>V;)N[E++]=0,N[E++]=255,N[E++]=255,N[E++]=0,N[E++]=0,N.set(J.subarray(l,l+V),E),E+=V,l+=V,Z-=V;N[E++]=1,N[E++]=Z&255,N[E++]=Z>>8&255,N[E++]=~Z&65535&255,N[E++]=(~Z&65535)>>8&255,N.set(J.subarray(l),E),E+=J.length-l;const o=H(J,0,J.length);return N[E++]=o>>24&255,N[E++]=o>>16&255,N[E++]=o>>8&255,N[E++]=o&255,N}function it(J,Z,V,I){const N=J.width,E=J.height;let l,o,A;const T=J.data;switch(Z){case b.ImageKind.GRAYSCALE_1BPP:o=0,l=1,A=N+7>>3;break;case b.ImageKind.RGB_24BPP:o=2,l=8,A=N*3;break;case b.ImageKind.RGBA_32BPP:o=6,l=8,A=N*4;break;default:throw new Error("invalid format")}const e=new Uint8Array((1+A)*E);let i=0,h=0;for(let z=0;z<E;++z)e[i++]=0,e.set(T.subarray(h,h+A),i),h+=A,i+=A;if(Z===b.ImageKind.GRAYSCALE_1BPP&&I){i=0;for(let z=0;z<E;z++){i++;for(let U=0;U<A;U++)e[i++]^=255}}const y=new Uint8Array([N>>24&255,N>>16&255,N>>8&255,N&255,E>>24&255,E>>16&255,E>>8&255,E&255,l,o,0,0,0]),C=q(e),k=r.length+p*3+y.length+C.length,R=new Uint8Array(k);let W=0;return R.set(r,W),W+=r.length,O("IHDR",y,R,W),W+=p+y.length,O("IDATA",C,R,W),W+=p+C.length,O("IEND",new Uint8Array(0),R,W),f(R,"image/png",V)}return function(Z,V,I){const N=Z.kind===void 0?b.ImageKind.GRAYSCALE_1BPP:Z.kind;return it(Z,N,V,I)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=j.fontWeight,this.fontSize=0,this.textMatrix=b.IDENTITY_MATRIX,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=b.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=j.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(p,P){this.x=p,this.y=P}}let w=0,D=0,S=0;s.SVGGraphics=F=class{constructor(r,p,P=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new u,this.transformMatrix=b.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=r,this.objs=p,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!P,this._operatorIdMapping=[];for(const B in b.OPS)this._operatorIdMapping[b.OPS[B]]=B}getObject(r,p=null){return typeof r=="string"?r.startsWith("g_")?this.commonObjs.get(r):this.objs.get(r):p}save(){this.transformStack.push(this.transformMatrix);const r=this.current;this.extraStack.push(r),this.current=r.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(r){this.save(),this.executeOpTree(r),this.restore()}loadDependencies(r){const p=r.fnArray,P=r.argsArray;for(let B=0,O=p.length;B<O;B++)if(p[B]===b.OPS.dependency)for(const H of P[B]){const q=H.startsWith("g_")?this.commonObjs:this.objs,K=new Promise(it=>{q.get(H,it)});this.current.dependencies.push(K)}return Promise.all(this.current.dependencies)}transform(r,p,P,B,O,H){const q=[r,p,P,B,O,H];this.transformMatrix=b.Util.transform(this.transformMatrix,q),this.tgrp=null}getSVG(r,p){this.viewport=p;const P=this._initialize(p);return this.loadDependencies(r).then(()=>(this.transformMatrix=b.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(r)),P))}convertOpList(r){const p=this._operatorIdMapping,P=r.argsArray,B=r.fnArray,O=[];for(let H=0,q=B.length;H<q;H++){const K=B[H];O.push({fnId:K,fn:p[K],args:P[H]})}return _(O)}executeOpTree(r){for(const p of r){const P=p.fn,B=p.fnId,O=p.args;switch(B|0){case b.OPS.beginText:this.beginText();break;case b.OPS.dependency:break;case b.OPS.setLeading:this.setLeading(O);break;case b.OPS.setLeadingMoveText:this.setLeadingMoveText(O[0],O[1]);break;case b.OPS.setFont:this.setFont(O);break;case b.OPS.showText:this.showText(O[0]);break;case b.OPS.showSpacedText:this.showText(O[0]);break;case b.OPS.endText:this.endText();break;case b.OPS.moveText:this.moveText(O[0],O[1]);break;case b.OPS.setCharSpacing:this.setCharSpacing(O[0]);break;case b.OPS.setWordSpacing:this.setWordSpacing(O[0]);break;case b.OPS.setHScale:this.setHScale(O[0]);break;case b.OPS.setTextMatrix:this.setTextMatrix(O[0],O[1],O[2],O[3],O[4],O[5]);break;case b.OPS.setTextRise:this.setTextRise(O[0]);break;case b.OPS.setTextRenderingMode:this.setTextRenderingMode(O[0]);break;case b.OPS.setLineWidth:this.setLineWidth(O[0]);break;case b.OPS.setLineJoin:this.setLineJoin(O[0]);break;case b.OPS.setLineCap:this.setLineCap(O[0]);break;case b.OPS.setMiterLimit:this.setMiterLimit(O[0]);break;case b.OPS.setFillRGBColor:this.setFillRGBColor(O[0],O[1],O[2]);break;case b.OPS.setStrokeRGBColor:this.setStrokeRGBColor(O[0],O[1],O[2]);break;case b.OPS.setStrokeColorN:this.setStrokeColorN(O);break;case b.OPS.setFillColorN:this.setFillColorN(O);break;case b.OPS.shadingFill:this.shadingFill(O[0]);break;case b.OPS.setDash:this.setDash(O[0],O[1]);break;case b.OPS.setRenderingIntent:this.setRenderingIntent(O[0]);break;case b.OPS.setFlatness:this.setFlatness(O[0]);break;case b.OPS.setGState:this.setGState(O[0]);break;case b.OPS.fill:this.fill();break;case b.OPS.eoFill:this.eoFill();break;case b.OPS.stroke:this.stroke();break;case b.OPS.fillStroke:this.fillStroke();break;case b.OPS.eoFillStroke:this.eoFillStroke();break;case b.OPS.clip:this.clip("nonzero");break;case b.OPS.eoClip:this.clip("evenodd");break;case b.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case b.OPS.paintImageXObject:this.paintImageXObject(O[0]);break;case b.OPS.paintInlineImageXObject:this.paintInlineImageXObject(O[0]);break;case b.OPS.paintImageMaskXObject:this.paintImageMaskXObject(O[0]);break;case b.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(O[0],O[1]);break;case b.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case b.OPS.closePath:this.closePath();break;case b.OPS.closeStroke:this.closeStroke();break;case b.OPS.closeFillStroke:this.closeFillStroke();break;case b.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case b.OPS.nextLine:this.nextLine();break;case b.OPS.transform:this.transform(O[0],O[1],O[2],O[3],O[4],O[5]);break;case b.OPS.constructPath:this.constructPath(O[0],O[1]);break;case b.OPS.endPath:this.endPath();break;case 92:this.group(p.items);break;default:(0,b.warn)(`Unimplemented operator ${P}`);break}}}setWordSpacing(r){this.current.wordSpacing=r}setCharSpacing(r){this.current.charSpacing=r}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(r,p,P,B,O,H){const q=this.current;q.textMatrix=q.lineMatrix=[r,p,P,B,O,H],q.textMatrixScale=Math.hypot(r,p),q.x=q.lineX=0,q.y=q.lineY=0,q.xcoords=[],q.ycoords=[],q.tspan=this.svgFactory.createElement("svg:tspan"),q.tspan.setAttributeNS(null,"font-family",q.fontFamily),q.tspan.setAttributeNS(null,"font-size",`${g(q.fontSize)}px`),q.tspan.setAttributeNS(null,"y",g(-q.y)),q.txtElement=this.svgFactory.createElement("svg:text"),q.txtElement.append(q.tspan)}beginText(){const r=this.current;r.x=r.lineX=0,r.y=r.lineY=0,r.textMatrix=b.IDENTITY_MATRIX,r.lineMatrix=b.IDENTITY_MATRIX,r.textMatrixScale=1,r.tspan=this.svgFactory.createElement("svg:tspan"),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtgrp=this.svgFactory.createElement("svg:g"),r.xcoords=[],r.ycoords=[]}moveText(r,p){const P=this.current;P.x=P.lineX+=r,P.y=P.lineY+=p,P.xcoords=[],P.ycoords=[],P.tspan=this.svgFactory.createElement("svg:tspan"),P.tspan.setAttributeNS(null,"font-family",P.fontFamily),P.tspan.setAttributeNS(null,"font-size",`${g(P.fontSize)}px`),P.tspan.setAttributeNS(null,"y",g(-P.y))}showText(r){const p=this.current,P=p.font,B=p.fontSize;if(B===0)return;const O=p.fontSizeScale,H=p.charSpacing,q=p.wordSpacing,K=p.fontDirection,it=p.textHScale*K,J=P.vertical,Z=J?1:-1,V=P.defaultVMetrics,I=B*p.fontMatrix[0];let N=0;for(const o of r){if(o===null){N+=K*q;continue}else if(typeof o=="number"){N+=Z*o*B/1e3;continue}const A=(o.isSpace?q:0)+H,T=o.fontChar;let e,i,h=o.width;if(J){let C;const k=o.vmetric||V;C=o.vmetric?k[1]:h*.5,C=-C*I;const R=k[2]*I;h=k?-k[0]:h,e=C/O,i=(N+R)/O}else e=N/O,i=0;(o.isInFont||P.missingFile)&&(p.xcoords.push(p.x+e),J&&p.ycoords.push(-p.y+i),p.tspan.textContent+=T);let y;J?y=h*I-A*K:y=h*I+A*K,N+=y}p.tspan.setAttributeNS(null,"x",p.xcoords.map(g).join(" ")),J?p.tspan.setAttributeNS(null,"y",p.ycoords.map(g).join(" ")):p.tspan.setAttributeNS(null,"y",g(-p.y)),J?p.y-=N:p.x+=N*it,p.tspan.setAttributeNS(null,"font-family",p.fontFamily),p.tspan.setAttributeNS(null,"font-size",`${g(p.fontSize)}px`),p.fontStyle!==j.fontStyle&&p.tspan.setAttributeNS(null,"font-style",p.fontStyle),p.fontWeight!==j.fontWeight&&p.tspan.setAttributeNS(null,"font-weight",p.fontWeight);const E=p.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;if(E===b.TextRenderingMode.FILL||E===b.TextRenderingMode.FILL_STROKE?(p.fillColor!==j.fillColor&&p.tspan.setAttributeNS(null,"fill",p.fillColor),p.fillAlpha<1&&p.tspan.setAttributeNS(null,"fill-opacity",p.fillAlpha)):p.textRenderingMode===b.TextRenderingMode.ADD_TO_PATH?p.tspan.setAttributeNS(null,"fill","transparent"):p.tspan.setAttributeNS(null,"fill","none"),E===b.TextRenderingMode.STROKE||E===b.TextRenderingMode.FILL_STROKE){const o=1/(p.textMatrixScale||1);this._setStrokeAttributes(p.tspan,o)}let l=p.textMatrix;p.textRise!==0&&(l=l.slice(),l[5]+=p.textRise),p.txtElement.setAttributeNS(null,"transform",`${d(l)} scale(${g(it)}, -1)`),p.txtElement.setAttributeNS(v,"xml:space","preserve"),p.txtElement.append(p.tspan),p.txtgrp.append(p.txtElement),this._ensureTransformGroup().append(p.txtElement)}setLeadingMoveText(r,p){this.setLeading(-p),this.moveText(r,p)}addFontStyle(r){if(!r.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const p=f(r.data,r.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${r.loadedName}"; src: url(${p}); }
`}setFont(r){const p=this.current,P=this.commonObjs.get(r[0]);let B=r[1];p.font=P,this.embedFonts&&!P.missingFile&&!this.embeddedFonts[P.loadedName]&&(this.addFontStyle(P),this.embeddedFonts[P.loadedName]=P),p.fontMatrix=P.fontMatrix||b.FONT_IDENTITY_MATRIX;let O="normal";P.black?O="900":P.bold&&(O="bold");const H=P.italic?"italic":"normal";B<0?(B=-B,p.fontDirection=-1):p.fontDirection=1,p.fontSize=B,p.fontFamily=P.loadedName,p.fontWeight=O,p.fontStyle=H,p.tspan=this.svgFactory.createElement("svg:tspan"),p.tspan.setAttributeNS(null,"y",g(-p.y)),p.xcoords=[],p.ycoords=[]}endText(){const r=this.current;r.textRenderingMode&b.TextRenderingMode.ADD_TO_PATH_FLAG&&r.txtElement?.hasChildNodes()&&(r.element=r.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(r){r>0&&(this.current.lineWidth=r)}setLineCap(r){this.current.lineCap=t[r]}setLineJoin(r){this.current.lineJoin=c[r]}setMiterLimit(r){this.current.miterLimit=r}setStrokeAlpha(r){this.current.strokeAlpha=r}setStrokeRGBColor(r,p,P){this.current.strokeColor=b.Util.makeHexColor(r,p,P)}setFillAlpha(r){this.current.fillAlpha=r}setFillRGBColor(r,p,P){this.current.fillColor=b.Util.makeHexColor(r,p,P),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(r){this.current.strokeColor=this._makeColorN_Pattern(r)}setFillColorN(r){this.current.fillColor=this._makeColorN_Pattern(r)}shadingFill(r){const p=this.viewport.width,P=this.viewport.height,B=b.Util.inverseTransform(this.transformMatrix),O=b.Util.applyTransform([0,0],B),H=b.Util.applyTransform([0,P],B),q=b.Util.applyTransform([p,0],B),K=b.Util.applyTransform([p,P],B),it=Math.min(O[0],H[0],q[0],K[0]),J=Math.min(O[1],H[1],q[1],K[1]),Z=Math.max(O[0],H[0],q[0],K[0]),V=Math.max(O[1],H[1],q[1],K[1]),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",it),I.setAttributeNS(null,"y",J),I.setAttributeNS(null,"width",Z-it),I.setAttributeNS(null,"height",V-J),I.setAttributeNS(null,"fill",this._makeShadingPattern(r)),this.current.fillAlpha<1&&I.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(I)}_makeColorN_Pattern(r){return r[0]==="TilingPattern"?this._makeTilingPattern(r):this._makeShadingPattern(r)}_makeTilingPattern(r){const p=r[1],P=r[2],B=r[3]||b.IDENTITY_MATRIX,[O,H,q,K]=r[4],it=r[5],J=r[6],Z=r[7],V=`shading${S++}`,[I,N,E,l]=b.Util.normalizeRect([...b.Util.applyTransform([O,H],B),...b.Util.applyTransform([q,K],B)]),[o,A]=b.Util.singularValueDecompose2dScale(B),T=it*o,e=J*A,i=this.svgFactory.createElement("svg:pattern");i.setAttributeNS(null,"id",V),i.setAttributeNS(null,"patternUnits","userSpaceOnUse"),i.setAttributeNS(null,"width",T),i.setAttributeNS(null,"height",e),i.setAttributeNS(null,"x",`${I}`),i.setAttributeNS(null,"y",`${N}`);const h=this.svg,y=this.transformMatrix,C=this.current.fillColor,k=this.current.strokeColor,R=this.svgFactory.create(E-I,l-N);if(this.svg=R,this.transformMatrix=B,Z===2){const W=b.Util.makeHexColor(...p);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(P)),this.svg=h,this.transformMatrix=y,this.current.fillColor=C,this.current.strokeColor=k,i.append(R.childNodes[0]),this.defs.append(i),`url(#${V})`}_makeShadingPattern(r){switch(typeof r=="string"&&(r=this.objs.get(r)),r[0]){case"RadialAxial":const p=`shading${S++}`,P=r[3];let B;switch(r[1]){case"axial":const O=r[4],H=r[5];B=this.svgFactory.createElement("svg:linearGradient"),B.setAttributeNS(null,"id",p),B.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),B.setAttributeNS(null,"x1",O[0]),B.setAttributeNS(null,"y1",O[1]),B.setAttributeNS(null,"x2",H[0]),B.setAttributeNS(null,"y2",H[1]);break;case"radial":const q=r[4],K=r[5],it=r[6],J=r[7];B=this.svgFactory.createElement("svg:radialGradient"),B.setAttributeNS(null,"id",p),B.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),B.setAttributeNS(null,"cx",K[0]),B.setAttributeNS(null,"cy",K[1]),B.setAttributeNS(null,"r",J),B.setAttributeNS(null,"fx",q[0]),B.setAttributeNS(null,"fy",q[1]),B.setAttributeNS(null,"fr",it);break;default:throw new Error(`Unknown RadialAxial type: ${r[1]}`)}for(const O of P){const H=this.svgFactory.createElement("svg:stop");H.setAttributeNS(null,"offset",O[0]),H.setAttributeNS(null,"stop-color",O[1]),B.append(H)}return this.defs.append(B),`url(#${p})`;case"Mesh":return(0,b.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${r[0]}`)}}setDash(r,p){this.current.dashArray=r,this.current.dashPhase=p}constructPath(r,p){const P=this.current;let B=P.x,O=P.y,H=[],q=0;for(const K of r)switch(K|0){case b.OPS.rectangle:B=p[q++],O=p[q++];const it=p[q++],J=p[q++],Z=B+it,V=O+J;H.push("M",g(B),g(O),"L",g(Z),g(O),"L",g(Z),g(V),"L",g(B),g(V),"Z");break;case b.OPS.moveTo:B=p[q++],O=p[q++],H.push("M",g(B),g(O));break;case b.OPS.lineTo:B=p[q++],O=p[q++],H.push("L",g(B),g(O));break;case b.OPS.curveTo:B=p[q+4],O=p[q+5],H.push("C",g(p[q]),g(p[q+1]),g(p[q+2]),g(p[q+3]),g(B),g(O)),q+=6;break;case b.OPS.curveTo2:H.push("C",g(B),g(O),g(p[q]),g(p[q+1]),g(p[q+2]),g(p[q+3])),B=p[q+2],O=p[q+3],q+=4;break;case b.OPS.curveTo3:B=p[q+2],O=p[q+3],H.push("C",g(p[q]),g(p[q+1]),g(B),g(O),g(B),g(O)),q+=4;break;case b.OPS.closePath:H.push("Z");break}H=H.join(" "),P.path&&r.length>0&&r[0]!==b.OPS.rectangle&&r[0]!==b.OPS.moveTo?H=P.path.getAttributeNS(null,"d")+H:(P.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(P.path)),P.path.setAttributeNS(null,"d",H),P.path.setAttributeNS(null,"fill","none"),P.element=P.path,P.setCurrentPoint(B,O)}endPath(){const r=this.current;if(r.path=null,!this.pendingClip)return;if(!r.element){this.pendingClip=null;return}const p=`clippath${w++}`,P=this.svgFactory.createElement("svg:clipPath");P.setAttributeNS(null,"id",p),P.setAttributeNS(null,"transform",d(this.transformMatrix));const B=r.element.cloneNode(!0);if(this.pendingClip==="evenodd"?B.setAttributeNS(null,"clip-rule","evenodd"):B.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,P.append(B),this.defs.append(P),r.activeClipUrl){r.clipGroup=null;for(const O of this.extraStack)O.clipGroup=null;P.setAttributeNS(null,"clip-path",r.activeClipUrl)}r.activeClipUrl=`url(#${p})`,this.tgrp=null}clip(r){this.pendingClip=r}closePath(){const r=this.current;if(r.path){const p=`${r.path.getAttributeNS(null,"d")}Z`;r.path.setAttributeNS(null,"d",p)}}setLeading(r){this.current.leading=-r}setTextRise(r){this.current.textRise=r}setTextRenderingMode(r){this.current.textRenderingMode=r}setHScale(r){this.current.textHScale=r/100}setRenderingIntent(r){}setFlatness(r){}setGState(r){for(const[p,P]of r)switch(p){case"LW":this.setLineWidth(P);break;case"LC":this.setLineCap(P);break;case"LJ":this.setLineJoin(P);break;case"ML":this.setMiterLimit(P);break;case"D":this.setDash(P[0],P[1]);break;case"RI":this.setRenderingIntent(P);break;case"FL":this.setFlatness(P);break;case"Font":this.setFont(P);break;case"CA":this.setStrokeAlpha(P);break;case"ca":this.setFillAlpha(P);break;default:(0,b.warn)(`Unimplemented graphic state operator ${p}`);break}}fill(){const r=this.current;r.element&&(r.element.setAttributeNS(null,"fill",r.fillColor),r.element.setAttributeNS(null,"fill-opacity",r.fillAlpha),this.endPath())}stroke(){const r=this.current;r.element&&(this._setStrokeAttributes(r.element),r.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(r,p=1){const P=this.current;let B=P.dashArray;p!==1&&B.length>0&&(B=B.map(function(O){return p*O})),r.setAttributeNS(null,"stroke",P.strokeColor),r.setAttributeNS(null,"stroke-opacity",P.strokeAlpha),r.setAttributeNS(null,"stroke-miterlimit",g(P.miterLimit)),r.setAttributeNS(null,"stroke-linecap",P.lineCap),r.setAttributeNS(null,"stroke-linejoin",P.lineJoin),r.setAttributeNS(null,"stroke-width",g(p*P.lineWidth)+"px"),r.setAttributeNS(null,"stroke-dasharray",B.map(g).join(" ")),r.setAttributeNS(null,"stroke-dashoffset",g(p*P.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","1px"),r.setAttributeNS(null,"height","1px"),r.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(r)}paintImageXObject(r){const p=this.getObject(r);if(!p){(0,b.warn)(`Dependent image with object ID ${r} is not ready yet`);return}this.paintInlineImageXObject(p)}paintInlineImageXObject(r,p){const P=r.width,B=r.height,O=n(r,this.forceDataSchema,!!p),H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y","0"),H.setAttributeNS(null,"width",g(P)),H.setAttributeNS(null,"height",g(B)),this.current.element=H,this.clip("nonzero");const q=this.svgFactory.createElement("svg:image");q.setAttributeNS(m,"xlink:href",O),q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y",g(-B)),q.setAttributeNS(null,"width",g(P)+"px"),q.setAttributeNS(null,"height",g(B)+"px"),q.setAttributeNS(null,"transform",`scale(${g(1/P)} ${g(-1/B)})`),p?p.append(q):this._ensureTransformGroup().append(q)}paintImageMaskXObject(r){const p=this.getObject(r.data,r);if(p.bitmap){(0,b.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const P=this.current,B=p.width,O=p.height,H=P.fillColor;P.maskId=`mask${D++}`;const q=this.svgFactory.createElement("svg:mask");q.setAttributeNS(null,"id",P.maskId);const K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y","0"),K.setAttributeNS(null,"width",g(B)),K.setAttributeNS(null,"height",g(O)),K.setAttributeNS(null,"fill",H),K.setAttributeNS(null,"mask",`url(#${P.maskId})`),this.defs.append(q),this._ensureTransformGroup().append(K),this.paintInlineImageXObject(p,q)}paintFormXObjectBegin(r,p){if(Array.isArray(r)&&r.length===6&&this.transform(r[0],r[1],r[2],r[3],r[4],r[5]),p){const P=p[2]-p[0],B=p[3]-p[1],O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x",p[0]),O.setAttributeNS(null,"y",p[1]),O.setAttributeNS(null,"width",g(P)),O.setAttributeNS(null,"height",g(B)),this.current.element=O,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(r){const p=this.svgFactory.create(r.width,r.height),P=this.svgFactory.createElement("svg:defs");p.append(P),this.defs=P;const B=this.svgFactory.createElement("svg:g");return B.setAttributeNS(null,"transform",d(r.transform)),p.append(B),this.svg=B,p}_ensureClipGroup(){if(!this.current.clipGroup){const r=this.svgFactory.createElement("svg:g");r.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(r),this.current.clipGroup=r}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",d(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(L){var s=__webpack_module_cache__[L];if(s!==void 0)return s.exports;var x=__webpack_module_cache__[L]={exports:{}};return __webpack_modules__[L](x,x.exports,__w_pdfjs_require__),x.exports}var __webpack_exports__={};return(()=>{var L=__webpack_exports__;Object.defineProperty(L,"__esModule",{value:!0}),Object.defineProperty(L,"AbortException",{enumerable:!0,get:function(){return s.AbortException}}),Object.defineProperty(L,"AnnotationEditorLayer",{enumerable:!0,get:function(){return M.AnnotationEditorLayer}}),Object.defineProperty(L,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return s.AnnotationEditorParamsType}}),Object.defineProperty(L,"AnnotationEditorType",{enumerable:!0,get:function(){return s.AnnotationEditorType}}),Object.defineProperty(L,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return F.AnnotationEditorUIManager}}),Object.defineProperty(L,"AnnotationLayer",{enumerable:!0,get:function(){return j.AnnotationLayer}}),Object.defineProperty(L,"AnnotationMode",{enumerable:!0,get:function(){return s.AnnotationMode}}),Object.defineProperty(L,"CMapCompressionType",{enumerable:!0,get:function(){return s.CMapCompressionType}}),Object.defineProperty(L,"FeatureTest",{enumerable:!0,get:function(){return s.FeatureTest}}),Object.defineProperty(L,"GlobalWorkerOptions",{enumerable:!0,get:function(){return v.GlobalWorkerOptions}}),Object.defineProperty(L,"InvalidPDFException",{enumerable:!0,get:function(){return s.InvalidPDFException}}),Object.defineProperty(L,"MissingPDFException",{enumerable:!0,get:function(){return s.MissingPDFException}}),Object.defineProperty(L,"OPS",{enumerable:!0,get:function(){return s.OPS}}),Object.defineProperty(L,"PDFDataRangeTransport",{enumerable:!0,get:function(){return x.PDFDataRangeTransport}}),Object.defineProperty(L,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(L,"PDFWorker",{enumerable:!0,get:function(){return x.PDFWorker}}),Object.defineProperty(L,"PasswordResponses",{enumerable:!0,get:function(){return s.PasswordResponses}}),Object.defineProperty(L,"PermissionFlag",{enumerable:!0,get:function(){return s.PermissionFlag}}),Object.defineProperty(L,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(L,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(L,"SVGGraphics",{enumerable:!0,get:function(){return m.SVGGraphics}}),Object.defineProperty(L,"UnexpectedResponseException",{enumerable:!0,get:function(){return s.UnexpectedResponseException}}),Object.defineProperty(L,"Util",{enumerable:!0,get:function(){return s.Util}}),Object.defineProperty(L,"VerbosityLevel",{enumerable:!0,get:function(){return s.VerbosityLevel}}),Object.defineProperty(L,"XfaLayer",{enumerable:!0,get:function(){return t.XfaLayer}}),Object.defineProperty(L,"build",{enumerable:!0,get:function(){return x.build}}),Object.defineProperty(L,"createPromiseCapability",{enumerable:!0,get:function(){return s.createPromiseCapability}}),Object.defineProperty(L,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return s.createValidAbsoluteUrl}}),Object.defineProperty(L,"getDocument",{enumerable:!0,get:function(){return x.getDocument}}),Object.defineProperty(L,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(L,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(L,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(L,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(L,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(L,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(L,"renderTextLayer",{enumerable:!0,get:function(){return b.renderTextLayer}}),Object.defineProperty(L,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(L,"shadow",{enumerable:!0,get:function(){return s.shadow}}),Object.defineProperty(L,"updateTextLayer",{enumerable:!0,get:function(){return b.updateTextLayer}}),Object.defineProperty(L,"version",{enumerable:!0,get:function(){return x.version}});var s=__w_pdfjs_require__(1),x=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),b=__w_pdfjs_require__(26),M=__w_pdfjs_require__(27),F=__w_pdfjs_require__(5),j=__w_pdfjs_require__(32),v=__w_pdfjs_require__(14),m=__w_pdfjs_require__(35),t=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$2);const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
